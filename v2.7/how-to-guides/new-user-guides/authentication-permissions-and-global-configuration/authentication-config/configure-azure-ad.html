<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-2.7 plugin-docs plugin-id-default docs-doc-id-how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Configure Azure AD | Rancher</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ranchermanager.docs.rancher.com/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="2.7"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.7"><meta data-rh="true" name="docsearch:version" content="2.7"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.7"><meta data-rh="true" property="og:title" content="Configure Azure AD | Rancher"><meta data-rh="true" name="description" content="Microsoft Graph API"><meta data-rh="true" property="og:description" content="Microsoft Graph API"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="alternate" href="https://ranchermanager.docs.rancher.com/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad" hreflang="en"><link data-rh="true" rel="alternate" href="https://ranchermanager.docs.rancher.com/zh/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad" hreflang="zh"><link data-rh="true" rel="alternate" href="https://ranchermanager.docs.rancher.com/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://30NEY6C9UY-dsn.algolia.net" crossorigin="anonymous"><link data-rh="true" rel="canonical" href="https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad"><link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-57KS2MW",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>



<link rel="search" type="application/opensearchdescription+xml" title="Rancher" href="/opensearch.xml">



<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="0f98beb0-fc4c-417d-a42e-564e2cae42d2" async></script>
<script src="/scripts/optanonwrapper.js" async></script><link rel="stylesheet" href="/assets/css/styles.b83e5a9c.css">
<link rel="preload" href="/assets/js/runtime~main.b411b5e3.js" as="script">
<link rel="preload" href="/assets/js/main.2e08db9b.js" as="script">
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-57KS2MW" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/v2.7">v2.7</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad">Latest</a></li><li><a class="dropdown__link" href="/v2.8/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad">v2.8</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad">v2.7</a></li><li><a class="dropdown__link" href="/v2.6/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad">v2.6</a></li><li><a class="dropdown__link" href="/v2.5">v2.5</a></li><li><a class="dropdown__link" href="/v2.0-v2.4">v2.0-v2.4</a></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Quick Links</a><ul class="dropdown__menu"><li><a href="https://github.com/rancher/rancher" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/rancher/rancher-docs" target="_blank" rel="noopener noreferrer" class="dropdown__link">Docs GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">More from SUSE</a><ul class="dropdown__menu"><li><a href="https://www.rancher.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rancher">Rancher<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://elemental.docs.rancher.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__elemental">Elemental<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://fleet.rancher.io/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__fleet">Fleet<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://harvesterhci.io" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__harvester">Harvester<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://rancherdesktop.io/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rancher__desktop">Rancher Desktop<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://opensource.suse.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__suse">More Projects...<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v2.7">What is Rancher?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/v2.7/getting-started/overview">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/v2.7/how-to-guides/new-user-guides/new-user-guides">How-to Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/new-user-guides">New User Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;New User Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration">Authentication, Permissions, and Global Configuration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Authentication, Permissions, and Global Configuration&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config">Configuring Authentication</a><button aria-label="Toggle the collapsible sidebar category &#x27;Configuring Authentication&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/manage-users-and-groups">Users and Groups</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/create-local-users">Local Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-google-oauth">Configure Google OAuth</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-active-directory">Configure Active Directory (AD)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-freeipa">Configure FreeIPA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad">Configure Azure AD</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-github">Configure GitHub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-keycloak-oidc">Configure Keycloak (OIDC)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-keycloak-saml">Configure Keycloak (SAML)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-pingidentity">Configure PingIdentity (SAML)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-okta-saml">Configure Okta (SAML)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/configure-openldap">Configuring OpenLDAP</a><button aria-label="Toggle the collapsible sidebar category &#x27;Configuring OpenLDAP&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/configure-microsoft-ad-federation-service-saml">Configuring Microsoft AD Federation Service (SAML)</a><button aria-label="Toggle the collapsible sidebar category &#x27;Configuring Microsoft AD Federation Service (SAML)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/configure-shibboleth-saml">Configuring Shibboleth (SAML)</a><button aria-label="Toggle the collapsible sidebar category &#x27;Configuring Shibboleth (SAML)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/manage-role-based-access-control-rbac">Managing Role-Based Access Control (RBAC)</a><button aria-label="Toggle the collapsible sidebar category &#x27;Managing Role-Based Access Control (RBAC)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/about-provisioning-drivers">About Provisioning Drivers</a><button aria-label="Toggle the collapsible sidebar category &#x27;About Provisioning Drivers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/about-rke1-templates">About RKE1 Templates</a><button aria-label="Toggle the collapsible sidebar category &#x27;About RKE1 Templates&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/create-pod-security-policies">Creating Pod Security Policies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/pod-security-standards">Pod Security Standards (PSS) &amp; Pod Security Admission (PSA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/psa-config-templates">Pod Security Admission (PSA) Configuration Templates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/global-default-private-registry">Configuring a Global Default Private Registry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/custom-branding">Custom Branding</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/manage-clusters">Cluster Administration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cluster Administration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/kubernetes-cluster-setup">Setting up a Kubernetes Cluster for Rancher Server</a><button aria-label="Toggle the collapsible sidebar category &#x27;Setting up a Kubernetes Cluster for Rancher Server&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/infrastructure-setup">Infrastructure Setup</a><button aria-label="Toggle the collapsible sidebar category &#x27;Infrastructure Setup&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup">Kubernetes Clusters in Rancher Setup</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes Clusters in Rancher Setup&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/launch-kubernetes-with-rancher">Launching Kubernetes with Rancher</a><button aria-label="Toggle the collapsible sidebar category &#x27;Launching Kubernetes with Rancher&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/kubernetes-resources-setup">Kubernetes Resources Setup</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes Resources Setup&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/helm-charts-in-rancher">Helm Charts and Apps</a><button aria-label="Toggle the collapsible sidebar category &#x27;Helm Charts and Apps&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/backup-restore-and-disaster-recovery">Backup, Restore, and Disaster Recovery</a><button aria-label="Toggle the collapsible sidebar category &#x27;Backup, Restore, and Disaster Recovery&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/add-users-to-projects">Adding Users to Projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.7/how-to-guides/new-user-guides/manage-namespaces">Namespaces</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.7/how-to-guides/advanced-user-guides">Advanced User Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Advanced User Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/v2.7/reference-guides/best-practices">Reference Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/v2.7/integrations-in-rancher/cloud-marketplace">Integrations in Rancher</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/v2.7/faq/general-faq">FAQ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/v2.7/troubleshooting/general-troubleshooting">Troubleshooting</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v2.7/contribute-to-rancher">Contributing to Rancher</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">How-to Guides</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.7/how-to-guides/new-user-guides/new-user-guides"><span itemprop="name">New User Guides</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration"><span itemprop="name">Authentication, Permissions, and Global Configuration</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config"><span itemprop="name">Configuring Authentication</span></a><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Configure Azure AD</span><meta itemprop="position" content="5"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v2.7</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Configure Azure AD</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="microsoft-graph-api">Microsoft Graph API<a href="#microsoft-graph-api" class="hash-link" aria-label="Direct link to Microsoft Graph API" title="Direct link to Microsoft Graph API">​</a></h2><p>Microsoft Graph API is now the flow through which you will set up Azure AD. The below sections will assist <a href="#new-user-setup">new users</a> in configuring Azure AD with a new instance as well as assist existing Azure app owners in <a href="#migrating-from-azure-ad-graph-api-to-microsoft-graph-api">migrating to the new flow</a>.</p><p>The Microsoft Graph API flow in Rancher is constantly evolving. We recommend that you use the latest patched version of 2.7, as it is still in active development and will continue to receive new features and improvements.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="new-user-setup">New User Setup<a href="#new-user-setup" class="hash-link" aria-label="Direct link to New User Setup" title="Direct link to New User Setup">​</a></h3><p>If you have an instance of Active Directory (AD) hosted in Azure, you can configure Rancher to allow your users to log in using their AD accounts. Configuration of Azure AD external authentication requires you to make configurations in both Azure and Rancher.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Notes</div><div class="admonitionContent_S0QG"><ul><li>Azure AD integration only supports Service Provider initiated logins.</li><li>Most of this procedure takes place from the <a href="https://portal.azure.com/" target="_blank" rel="noopener noreferrer">Microsoft Azure Portal</a>.</li></ul></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="azure-active-directory-configuration-outline">Azure Active Directory Configuration Outline<a href="#azure-active-directory-configuration-outline" class="hash-link" aria-label="Direct link to Azure Active Directory Configuration Outline" title="Direct link to Azure Active Directory Configuration Outline">​</a></h4><p>Configuring Rancher to allow your users to authenticate with their Azure AD accounts involves multiple procedures. Review the outline below before getting started.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>Before you start, open two browser tabs: one for Rancher, and one for the Azure portal. This will help with copying and pasting configuration values from the portal to Rancher.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-register-rancher-with-azure">1. Register Rancher with Azure<a href="#1-register-rancher-with-azure" class="hash-link" aria-label="Direct link to 1. Register Rancher with Azure" title="Direct link to 1. Register Rancher with Azure">​</a></h4><p>Before enabling Azure AD within Rancher, you must register Rancher with Azure.</p><ol><li><p>Log in to <a href="https://portal.azure.com/" target="_blank" rel="noopener noreferrer">Microsoft Azure</a> as an administrative user. Configuration in future steps requires administrative access rights.</p></li><li><p>Use search to open the <strong>App registrations</strong> service.</p></li><li><p>Click <strong>New registration</strong> and complete the form.</p><p><img loading="lazy" alt="New App Registration" src="/assets/images/new-app-registration-59bd7ed40c2a28a68136c698fa6ead86.png" width="1966" height="1690" class="img_ev3q"></p><ol><li><p>Enter a <strong>Name</strong> (something like <code>Rancher</code>).</p></li><li><p>From <strong>Supported account types</strong>, select &quot;Accounts in this organizational directory only (AzureADTest only - Single tenant)&quot; This corresponds to the legacy app registration options.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>In the updated Azure portal, Redirect URIs are synonymous with Reply URLs. In order to use Azure AD with Rancher, you must whitelist Rancher with Azure (previously done through Reply URLs). Therefore, you must ensure to fill in the Redirect URI with your Rancher server URL, to include the verification path as listed below.</p></div></div></li><li><p>In the <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/reply-url" target="_blank" rel="noopener noreferrer"><strong>Redirect URI</strong></a> section, make sure <strong>Web</strong> is selected from the dropdown and enter the URL of your Rancher Server in the text box next to the dropdown. This Rancher server URL should be appended with the verification path: <code>&lt;MY_RANCHER_URL&gt;/verify-auth-azure</code>.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>You can find your personalized Azure Redirect URI (reply URL) in Rancher on the Azure AD Authentication page (Global View &gt; Authentication &gt; Web).</p></div></div></li><li><p>Click <strong>Register</strong>.</p></li></ol></li></ol><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>It can take up to five minutes for this change to take affect, so don&#x27;t be alarmed if you can&#x27;t authenticate immediately after Azure AD configuration.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-create-a-new-client-secret">2. Create a new client secret<a href="#2-create-a-new-client-secret" class="hash-link" aria-label="Direct link to 2. Create a new client secret" title="Direct link to 2. Create a new client secret">​</a></h4><p>From the Azure portal, create a client secret. Rancher will use this key to authenticate with Azure AD.</p><ol><li><p>Use search to open <strong>App registrations</strong> services. Then open the entry for Rancher that you created in the last procedure.</p><p> <img loading="lazy" alt="Open Rancher Registration" src="/assets/images/open-rancher-app-reg-5b20da33433cbef42e010c94d1fcf334.png" width="827" height="544" class="img_ev3q"></p></li><li><p>From the navigation pane, click <strong>Certificates &amp; secrets</strong>.</p></li><li><p>Click <strong>New client secret</strong>.
<img loading="lazy" alt="Create new client secret" src="/assets/images/new-client-secret-0b15bf6a6882b115021ee92df3b63adc.png" width="2878" height="1100" class="img_ev3q"></p></li><li><p>Enter a <strong>Description</strong> (something like <code>Rancher</code>).</p></li><li><p>Select the duration from the options under <strong>Expires</strong>. This drop-down menu sets the expiration date for the key. Shorter durations are more secure, but require you to create a new key more frequently.
Note that users won&#x27;t be able to log in to Rancher if it detects that the application secret has expired. To avoid this problem, rotate the secret in Azure and update it in Rancher before it expires.</p></li><li><p>Click <strong>Add</strong> (you don&#x27;t need to enter a value—it will automatically populate after you save).</p><a id="secret"></a></li><li><p>You&#x27;ll enter this key into the Rancher UI later as your <strong>Application Secret</strong>. Since you won&#x27;t be able to access the key value again within the Azure UI, keep this window open for the rest of the setup process.</p></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-set-required-permissions-for-rancher">3. Set Required Permissions for Rancher<a href="#3-set-required-permissions-for-rancher" class="hash-link" aria-label="Direct link to 3. Set Required Permissions for Rancher" title="Direct link to 3. Set Required Permissions for Rancher">​</a></h4><p>Next, set API permissions for Rancher within Azure.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>Ensure that you set Application permissions, and <em>not</em> Delegated permissions. Otherwise, you won&#x27;t be able to login to Azure AD.</p></div></div><ol><li><p>From the navigation pane on, select <strong>API permissions</strong>.</p></li><li><p>Click <strong>Add a permission</strong>.</p></li><li><p>From the Microsoft Graph API, select the following <strong>Application Permissions</strong>: <code>Directory.Read.All</code></p><p><img loading="lazy" alt="Select API Permissions" src="/assets/images/api-permissions-bbec1fbc67990a297b9401f5892d30b8.png" width="1848" height="1524" class="img_ev3q"></p></li><li><p>Return to <strong>API permissions</strong> in the nav bar. From there, click <strong>Grant admin consent</strong>. Then click <strong>Yes</strong>. The app&#x27;s permissions should look like the following:</p></li></ol><p><img loading="lazy" alt="Open Required Permissions" src="/assets/images/select-req-permissions-575ef9d493f6f5414b65b0ff7eb14c03.png" width="2242" height="1012" class="img_ev3q"></p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Rancher doesn&#x27;t validate the permissions you grant to the app in Azure. You&#x27;re free to try any permissions you want, as long as they allow Rancher to work with AD users and groups.</p><p>Specifically, Rancher needs permissions that allow the following actions:</p><ul><li>Get a user.</li><li>List all users.</li><li>List groups of which a given user is a member.</li><li>Get a group.</li><li>List all groups.</li></ul><p>Rancher performs these actions either to log in a user or to run a user/group search. Keep in mind that the permissions must be of type <code>Application</code>.</p><p>Here are a few examples of permission combinations that satisfy Rancher&#x27;s needs:</p><ul><li><code>Directory.Read.All</code></li><li><code>User.Read.All</code> and <code>GroupMember.Read.All</code></li><li><code>User.Read.All</code> and <code>Group.Read.All</code></li></ul></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-copy-azure-application-data">4. Copy Azure Application Data<a href="#4-copy-azure-application-data" class="hash-link" aria-label="Direct link to 4. Copy Azure Application Data" title="Direct link to 4. Copy Azure Application Data">​</a></h4><p><img loading="lazy" alt="Application ID" src="/assets/images/app-configuration-287289a3380340c46b6c413c202b96af.png" width="1600" height="590" class="img_ev3q"></p><ol><li><p>Obtain your Rancher <strong>Tenant ID</strong>.</p><ol><li><p>Use search to open <strong>App registrations</strong>.</p></li><li><p>Find the entry you created for Rancher.</p></li><li><p>Copy the <strong>Directory ID</strong> and paste it into Rancher as your <strong>Tenant ID</strong>.</p></li></ol></li><li><p>Obtain your Rancher <strong>Application (Client) ID</strong>.</p><ol><li><p>If you aren&#x27;t already there, use search to open <strong>App registrations</strong>.</p></li><li><p>In <strong>Overview</strong>, find the entry you created for Rancher.</p></li><li><p>Copy the <strong>Application (Client) ID</strong> and paste it into Rancher as your <strong>Application ID</strong>.</p></li></ol></li><li><p>In most cases, your endpoint options will either be <a href="#global">Standard</a> or <a href="#china">China</a>. For either of these options, you only need to enter the <strong>Tenant ID</strong>, <strong>Application ID</strong>, and <strong>Application Secret</strong>.</p></li></ol><p><img loading="lazy" alt="Standard Endpoint Options" src="/assets/images/tenant-application-id-secret-94a4ceccec0454d98ae6543f732857cb.png" width="3574" height="1866" class="img_ev3q"></p><p><strong>For Custom Endpoints:</strong></p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>Custom Endpoints are not tested or fully supported by Rancher.</p></div></div><p>You&#x27;ll also need to manually enter the Graph, Token, and Auth Endpoints.</p><ul><li>From <b>App registrations</b>, click <b>Endpoints</b>:</li></ul><p><img loading="lazy" alt="Click Endpoints" src="/assets/images/endpoints-a84e7e422cf92a96a602bf189985508f.png" width="1296" height="272" class="img_ev3q"></p><ul><li>The following endpoints will be your Rancher endpoint values. Make sure to use the v1 version of these endpoints:<ul><li><strong>Microsoft Graph API endpoint</strong> (Graph Endpoint)</li><li><strong>OAuth 2.0 token endpoint (v1)</strong> (Token Endpoint)</li><li><strong>OAuth 2.0 authorization endpoint (v1)</strong> (Auth Endpoint)</li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-configure-azure-ad-in-rancher">5. Configure Azure AD in Rancher<a href="#5-configure-azure-ad-in-rancher" class="hash-link" aria-label="Direct link to 5. Configure Azure AD in Rancher" title="Direct link to 5. Configure Azure AD in Rancher">​</a></h4><p>To complete configuration, enter information about your AD instance in the Rancher UI.</p><ol><li><p>Log into Rancher.</p></li><li><p>In the top left corner, click <strong>☰ &gt; Users &amp; Authentication</strong>.</p></li><li><p>In the left navigation menu, click <strong>Auth Provider</strong>.</p></li><li><p>Click <strong>AzureAD</strong>.</p></li><li><p>Complete the <strong>Configure Azure AD Account</strong> form using the information you copied while completing <a href="#4-copy-azure-application-data">Copy Azure Application Data</a>.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>The Azure AD account will be granted administrator privileges, since its details will be mapped to the Rancher local principal account. Make sure that this level of privilege is appropriate before you continue.</p></div></div><p><strong>For Standard or China Endpoints:</strong></p><p>The following table maps the values you copied in the Azure portal to the fields in Rancher:</p><table><thead><tr><th>Rancher Field</th><th>Azure Value</th></tr></thead><tbody><tr><td>Tenant ID</td><td>Directory ID</td></tr><tr><td>Application ID</td><td>Application ID</td></tr><tr><td>Application Secret</td><td>Key Value</td></tr><tr><td>Endpoint</td><td><a href="https://login.microsoftonline.com/" target="_blank" rel="noopener noreferrer">https://login.microsoftonline.com/</a></td></tr></tbody></table><p><strong>For Custom Endpoints:</strong></p><p>The following table maps your custom config values to Rancher fields:</p><table><thead><tr><th>Rancher Field</th><th>Azure Value</th></tr></thead><tbody><tr><td>Graph Endpoint</td><td>Microsoft Graph API Endpoint</td></tr><tr><td>Token Endpoint</td><td>OAuth 2.0 Token Endpoint</td></tr><tr><td>Auth Endpoint</td><td>OAuth 2.0 Authorization Endpoint</td></tr></tbody></table><p><strong>Important:</strong> When entering the Graph Endpoint in a custom config, remove the tenant ID from the URL:</p><code>http<span>s://g</span>raph.microsoft.com<del>/abb5adde-bee8-4821-8b03-e63efdc7701c</del></code></li><li><p>Click <strong>Enable</strong>.</p></li></ol><p><strong>Result:</strong> Azure Active Directory authentication is configured.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="migrating-from-azure-ad-graph-api-to-microsoft-graph-api">Migrating from Azure AD Graph API to Microsoft Graph API<a href="#migrating-from-azure-ad-graph-api-to-microsoft-graph-api" class="hash-link" aria-label="Direct link to Migrating from Azure AD Graph API to Microsoft Graph API" title="Direct link to Migrating from Azure AD Graph API to Microsoft Graph API">​</a></h3><p>Since the <a href="https://docs.microsoft.com/en-us/graph/migrate-azure-ad-graph-overview" target="_blank" rel="noopener noreferrer">Azure AD Graph API</a> is deprecated and slated to retire in June 2023, admins should update their Azure AD App to use the <a href="https://docs.microsoft.com/en-us/graph/use-the-api" target="_blank" rel="noopener noreferrer">Microsoft Graph API</a> in Rancher.
This needs to be done well in advance of the endpoint being retired.
If Rancher is still configured to use the Azure AD Graph API when it is retired, users may not be able to log into Rancher using Azure AD.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="updating-endpoints-in-the-rancher-ui">Updating Endpoints in the Rancher UI<a href="#updating-endpoints-in-the-rancher-ui" class="hash-link" aria-label="Direct link to Updating Endpoints in the Rancher UI" title="Direct link to Updating Endpoints in the Rancher UI">​</a></h4><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>Admins should create a <a href="/v2.7/how-to-guides/new-user-guides/backup-restore-and-disaster-recovery/back-up-rancher">Rancher backup</a> before they commit to the endpoint migration described below.</p></div></div><ol><li><p><a href="#3-set-required-permissions-for-rancher">Update</a> the permissions of your Azure AD app registration. This is critical.</p></li><li><p>Log into Rancher.</p></li><li><p>In the Rancher UI homepage, make note of the banner at the top of screen that advises users to update their Azure AD authentication. Click on the link provided to do so.</p><p><img loading="lazy" alt="Rancher UI Banner" src="/assets/images/rancher-ui-azure-update-ff6ad0b948cef1983d8327e56300fabf.png" width="2532" height="616" class="img_ev3q"></p></li><li><p>To complete the move to the new Microsoft Graph API, click <strong>Update Endpoint</strong>.</p><p><strong>Note:</strong> Ensure that your Azure app has a <a href="#3-set-required-permissions-for-rancher">new set of permissions</a> before starting the update.</p><p><img loading="lazy" alt="Update Endpoint" src="/assets/images/rancher-button-to-update-192a6ebc55a50b8fcfd5acc5d17c7f9b.png" width="2558" height="1126" class="img_ev3q"></p></li><li><p>When you receive the pop-up warning message, click <strong>Update</strong>.</p><p><img loading="lazy" alt="Azure Update Pop-up" src="/assets/images/azure-update-popup-b45a735aebc6c2768e602f4028867c72.png" width="2720" height="1276" class="img_ev3q"></p></li><li><p>Refer to the <a href="#global">tables</a> below for the full list of endpoint changes that Rancher performs. Admins do not need to do this manually.</p></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="air-gapped-environments">Air-Gapped Environments<a href="#air-gapped-environments" class="hash-link" aria-label="Direct link to Air-Gapped Environments" title="Direct link to Air-Gapped Environments">​</a></h4><p>In air-gapped environments, admins should ensure that their endpoints are whitelisted (see note on <a href="#1-register-rancher-with-azure">Step 3.2 of Register Rancher with Azure</a>) since the Graph Endpoint URL is changing.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="rolling-back-the-migration">Rolling Back the Migration<a href="#rolling-back-the-migration" class="hash-link" aria-label="Direct link to Rolling Back the Migration" title="Direct link to Rolling Back the Migration">​</a></h4><p>If you need to roll back your migration, please note the following:</p><ol><li><p>Admins are encouraged to use the proper restore process if they want to go back. Please see <a href="/v2.7/how-to-guides/new-user-guides/backup-restore-and-disaster-recovery/back-up-rancher">backup docs</a>, <a href="/v2.7/how-to-guides/new-user-guides/backup-restore-and-disaster-recovery/restore-rancher">restore docs</a>, and <a href="/v2.7/reference-guides/backup-restore-configuration/examples">examples</a> for reference.</p></li><li><p>Azure app owners who want to rotate the Application Secret will need to also rotate it in Rancher as Rancher does not automatically update the Application Secret when it is changed in Azure. In Rancher, note that it is stored in a Kubernetes secret called <code>azureadconfig-applicationsecret</code> which is in the <code>cattle-global-data</code> namespace.</p></li></ol><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>If you upgrade to Rancher v2.7.0+ with an existing Azure AD setup, and choose to disable the auth provider, you won&#x27;t be able to restore the previous setup. You also won&#x27;t be able to set up Azure AD using the old flow. You&#x27;ll need to re-register with the new auth flow. Since Rancher now uses the Graph API, users need set up the <a href="#3-set-required-permissions-for-rancher">proper permissions in the Azure portal</a>.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="global">Global:<a href="#global" class="hash-link" aria-label="Direct link to Global:" title="Direct link to Global:">​</a></h4><table><thead><tr><th>Rancher Field</th><th>Deprecated Endpoints</th></tr></thead><tbody><tr><td>Auth Endpoint</td><td><a href="https://login.microsoftonline.com/%7BtenantID%7D/oauth2/authorize" target="_blank" rel="noopener noreferrer">https://login.microsoftonline.com/{tenantID}/oauth2/authorize</a></td></tr><tr><td>Endpoint</td><td><a href="https://login.microsoftonline.com/" target="_blank" rel="noopener noreferrer">https://login.microsoftonline.com/</a></td></tr><tr><td>Graph Endpoint</td><td><a href="https://graph.windows.net/" target="_blank" rel="noopener noreferrer">https://graph.windows.net/</a></td></tr><tr><td>Token Endpoint</td><td><a href="https://login.microsoftonline.com/%7BtenantID%7D/oauth2/token" target="_blank" rel="noopener noreferrer">https://login.microsoftonline.com/{tenantID}/oauth2/token</a></td></tr></tbody></table><table><thead><tr><th>Rancher Field</th><th>New Endpoints</th></tr></thead><tbody><tr><td>Auth Endpoint</td><td><a href="https://login.microsoftonline.com/%7BtenantID%7D/oauth2/v2.0/authorize" target="_blank" rel="noopener noreferrer">https://login.microsoftonline.com/{tenantID}/oauth2/v2.0/authorize</a></td></tr><tr><td>Endpoint</td><td><a href="https://login.microsoftonline.com/" target="_blank" rel="noopener noreferrer">https://login.microsoftonline.com/</a></td></tr><tr><td>Graph Endpoint</td><td><a href="https://graph.microsoft.com" target="_blank" rel="noopener noreferrer">https://graph.microsoft.com</a></td></tr><tr><td>Token Endpoint</td><td><a href="https://login.microsoftonline.com/%7BtenantID%7D/oauth2/v2.0/token" target="_blank" rel="noopener noreferrer">https://login.microsoftonline.com/{tenantID}/oauth2/v2.0/token</a></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="china">China:<a href="#china" class="hash-link" aria-label="Direct link to China:" title="Direct link to China:">​</a></h4><table><thead><tr><th>Rancher Field</th><th>Deprecated Endpoints</th></tr></thead><tbody><tr><td>Auth Endpoint</td><td><a href="https://login.chinacloudapi.cn/%7BtenantID%7D/oauth2/authorize" target="_blank" rel="noopener noreferrer">https://login.chinacloudapi.cn/{tenantID}/oauth2/authorize</a></td></tr><tr><td>Endpoint</td><td><a href="https://login.chinacloudapi.cn/" target="_blank" rel="noopener noreferrer">https://login.chinacloudapi.cn/</a></td></tr><tr><td>Graph Endpoint</td><td><a href="https://graph.chinacloudapi.cn/" target="_blank" rel="noopener noreferrer">https://graph.chinacloudapi.cn/</a></td></tr><tr><td>Token Endpoint</td><td><a href="https://login.chinacloudapi.cn/%7BtenantID%7D/oauth2/token" target="_blank" rel="noopener noreferrer">https://login.chinacloudapi.cn/{tenantID}/oauth2/token</a></td></tr></tbody></table><table><thead><tr><th>Rancher Field</th><th>New Endpoints</th></tr></thead><tbody><tr><td>Auth Endpoint</td><td><a href="https://login.partner.microsoftonline.cn/%7BtenantID%7D/oauth2/v2.0/authorize" target="_blank" rel="noopener noreferrer">https://login.partner.microsoftonline.cn/{tenantID}/oauth2/v2.0/authorize</a></td></tr><tr><td>Endpoint</td><td><a href="https://login.partner.microsoftonline.cn/" target="_blank" rel="noopener noreferrer">https://login.partner.microsoftonline.cn/</a></td></tr><tr><td>Graph Endpoint</td><td><a href="https://microsoftgraph.chinacloudapi.cn" target="_blank" rel="noopener noreferrer">https://microsoftgraph.chinacloudapi.cn</a></td></tr><tr><td>Token Endpoint</td><td><a href="https://login.partner.microsoftonline.cn/%7BtenantID%7D/oauth2/v2.0/token" target="_blank" rel="noopener noreferrer">https://login.partner.microsoftonline.cn/{tenantID}/oauth2/v2.0/token</a></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deprecated-azure-ad-graph-api">Deprecated Azure AD Graph API<a href="#deprecated-azure-ad-graph-api" class="hash-link" aria-label="Direct link to Deprecated Azure AD Graph API" title="Direct link to Deprecated Azure AD Graph API">​</a></h2><blockquote><p><strong>Important:</strong></p><ul><li>The <a href="https://docs.microsoft.com/en-us/graph/migrate-azure-ad-graph-overview" target="_blank" rel="noopener noreferrer">Azure AD Graph API</a> is deprecated and will be retired by Microsoft at any time after June 30, 2023, without advance notice. We will update our docs to advise the community when it is retired. Rancher now uses the <a href="https://docs.microsoft.com/en-us/graph/use-the-api" target="_blank" rel="noopener noreferrer">Microsoft Graph API</a> as the new flow to set up Azure AD as the external auth provider.</li></ul><ul><li>If you&#x27;re a new user, or wish to migrate, refer to the new flow instructions for <a href="#microsoft-graph-api/" target="_blank">Rancher v2.7.0+</a>.</li></ul><ul><li>If you don&#x27;t wish to upgrade to v2.7.0+ after the Azure AD Graph API is retired, you&#x27;ll need to either:<ul><li>Use the built-in Rancher auth or</li><li>Use another third-party auth system and set that up in Rancher. Please see the <a href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config">authentication docs</a> to learn how to configure other open authentication providers.</li></ul></li></ul></blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-azure-ad.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-01-11T22:22:42.000Z">Jan 11, 2024</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-freeipa"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Configure FreeIPA</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/v2.7/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config/configure-github"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configure GitHub</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#microsoft-graph-api" class="table-of-contents__link toc-highlight">Microsoft Graph API</a><ul><li><a href="#new-user-setup" class="table-of-contents__link toc-highlight">New User Setup</a></li><li><a href="#migrating-from-azure-ad-graph-api-to-microsoft-graph-api" class="table-of-contents__link toc-highlight">Migrating from Azure AD Graph API to Microsoft Graph API</a></li></ul></li><li><a href="#deprecated-azure-ad-graph-api" class="table-of-contents__link toc-highlight">Deprecated Azure AD Graph API</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b411b5e3.js"></script>
<script src="/assets/js/main.2e08db9b.js"></script>
</body>
</html>