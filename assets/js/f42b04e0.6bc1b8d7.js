"use strict";(self.webpackChunkrancher_docs=self.webpackChunkrancher_docs||[]).push([[62524],{3905:function(t,e,n){n.d(e,{Zo:function(){return p},kt:function(){return m}});var r=n(67294);function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e){if(null==t)return{};var n,r,a=function(t,e){if(null==t)return{};var n,r,a={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}var s=r.createContext({}),d=function(t){var e=r.useContext(s),n=e;return t&&(n="function"==typeof t?t(e):l(l({},e),t)),n},p=function(t){var e=d(t.components);return r.createElement(s.Provider,{value:e},t.children)},u={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},c=r.forwardRef((function(t,e){var n=t.components,a=t.mdxType,i=t.originalType,s=t.parentName,p=o(t,["components","mdxType","originalType","parentName"]),c=d(n),m=a,g=c["".concat(s,".").concat(m)]||c[m]||u[m]||i;return n?r.createElement(g,l(l({ref:e},p),{},{components:n})):r.createElement(g,l({ref:e},p))}));function m(t,e){var n=arguments,a=e&&e.mdxType;if("string"==typeof t||a){var i=n.length,l=new Array(i);l[0]=c;var o={};for(var s in e)hasOwnProperty.call(e,s)&&(o[s]=e[s]);o.originalType=t,o.mdxType="string"==typeof t?t:a,l[1]=o;for(var d=2;d<i;d++)l[d]=n[d];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},78464:function(t,e,n){n.r(e),n.d(e,{assets:function(){return p},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return o},metadata:function(){return d},toc:function(){return u}});var r=n(87462),a=n(63366),i=(n(67294),n(3905)),l=["components"],o={title:"Skipped and Not Applicable Tests",weight:1,aliases:["/rancher/v2.0-v2.4/en/cis-scans/legacy/skipped-tests","/rancher/v2.0-v2.4/en/cis-scans/v2.4/skipped-tests","/rancher/v2.0-v2.4/en/cis-scans/skipped-tests","/rancher/v2.x/en/cis-scans/v2.4/skipped-tests/"]},s=void 0,d={unversionedId:"explanations/integrations-in-rancher/cis-scans/skipped-and-not-applicable-tests",id:"version-2.0-2.4/explanations/integrations-in-rancher/cis-scans/skipped-and-not-applicable-tests",title:"Skipped and Not Applicable Tests",description:"This section lists the tests that are skipped in the permissive test profile for RKE.",source:"@site/versioned_docs/version-2.0-2.4/explanations/integrations-in-rancher/cis-scans/skipped-and-not-applicable-tests.md",sourceDirName:"explanations/integrations-in-rancher/cis-scans",slug:"/explanations/integrations-in-rancher/cis-scans/skipped-and-not-applicable-tests",permalink:"/v2.0-v2.4/explanations/integrations-in-rancher/cis-scans/skipped-and-not-applicable-tests",draft:!1,editUrl:"https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.0-2.4/explanations/integrations-in-rancher/cis-scans/skipped-and-not-applicable-tests.md",tags:[],version:"2.0-2.4",lastUpdatedAt:1663710212,formattedLastUpdatedAt:"9/20/2022",frontMatter:{title:"Skipped and Not Applicable Tests",weight:1,aliases:["/rancher/v2.0-v2.4/en/cis-scans/legacy/skipped-tests","/rancher/v2.0-v2.4/en/cis-scans/v2.4/skipped-tests","/rancher/v2.0-v2.4/en/cis-scans/skipped-tests","/rancher/v2.x/en/cis-scans/v2.4/skipped-tests/"]},sidebar:"tutorialSidebar",previous:{title:"CIS Scans",permalink:"/v2.0-v2.4/pages-for-subheaders/cis-scans"},next:{title:"Istio",permalink:"/v2.0-v2.4/pages-for-subheaders/istio"}},p={},u=[{value:"CIS Benchmark v1.5",id:"cis-benchmark-v15",level:2},{value:"CIS Benchmark v1.5 Skipped Tests",id:"cis-benchmark-v15-skipped-tests",level:3},{value:"CIS Benchmark v1.5 Not Applicable Tests",id:"cis-benchmark-v15-not-applicable-tests",level:3},{value:"CIS Benchmark v1.4",id:"cis-benchmark-v14",level:2},{value:"CIS Benchmark v1.4 Skipped Tests",id:"cis-benchmark-v14-skipped-tests",level:3},{value:"CIS Benchmark v1.4 Not Applicable Tests",id:"cis-benchmark-v14-not-applicable-tests",level:3}],c={toc:u};function m(t){var e=t.components,n=(0,a.Z)(t,l);return(0,i.kt)("wrapper",(0,r.Z)({},c,n,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"This section lists the tests that are skipped in the permissive test profile for RKE."),(0,i.kt)("p",null,"All the tests that are skipped and not applicable on this page will be counted as Not Applicable in the generated report. The skipped test count will only mention the user-defined skipped tests. This allows user-skipped tests to be distinguished from the tests that are skipped by default in the RKE permissive test profile."),(0,i.kt)("h2",{id:"cis-benchmark-v15"},"CIS Benchmark v1.5"),(0,i.kt)("h3",{id:"cis-benchmark-v15-skipped-tests"},"CIS Benchmark v1.5 Skipped Tests"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Number"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Reason for Skipping"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.12"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the etcd data directory ownership is set to etcd:etcd (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"A system service account is required for etcd data directory ownership. Refer to Rancher's hardening guide for more details on how to configure this ownership.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.2.6"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the --kubelet-certificate-authority argument is set as appropriate (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"When generating serving certificates, functionality could break in conjunction with hostname overrides which are required for certain cloud providers.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.2.16"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the admission control plugin PodSecurityPolicy is set (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling Pod Security Policy can cause applications to unexpectedly fail.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.2.33"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the --encryption-provider-config argument is set as appropriate (Not Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling encryption changes how data can be recovered as data is encrypted.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.2.34"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that encryption providers are appropriately configured (Not Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling encryption changes how data can be recovered as data is encrypted.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"4.2.6"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the --protect-kernel-defaults argument is set to true (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"System level configurations are required before provisioning the cluster in order for this argument to be set to true.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"4.2.10"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the--tls-cert-file and --tls-private-key-file arguments are set as appropriate (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"When generating serving certificates, functionality could break in conjunction with hostname overrides which are required for certain cloud providers.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"5.1.5"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that default service accounts are not actively used. (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Kubernetes provides default service accounts to be used.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"5.2.2"),(0,i.kt)("td",{parentName:"tr",align:null},"Minimize the admission of containers wishing to share the host process ID namespace (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling Pod Security Policy can cause applications to unexpectedly fail.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"5.2.3"),(0,i.kt)("td",{parentName:"tr",align:null},"Minimize the admission of containers wishing to share the host IPC namespace (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling Pod Security Policy can cause applications to unexpectedly fail.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"5.2.4"),(0,i.kt)("td",{parentName:"tr",align:null},"Minimize the admission of containers wishing to share the host network namespace (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling Pod Security Policy can cause applications to unexpectedly fail.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"5.2.5"),(0,i.kt)("td",{parentName:"tr",align:null},"Minimize the admission of containers with allowPrivilegeEscalation (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling Pod Security Policy can cause applications to unexpectedly fail.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"5.3.2"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that all Namespaces have Network Policies defined (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling Network Policies can prevent certain applications from communicating with each other.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"5.6.4"),(0,i.kt)("td",{parentName:"tr",align:null},"The default namespace should not be used (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Kubernetes provides a default namespace.")))),(0,i.kt)("h3",{id:"cis-benchmark-v15-not-applicable-tests"},"CIS Benchmark v1.5 Not Applicable Tests"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Number"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Reason for being not applicable"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.1"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the API server pod specification file permissions are set to 644 or more restrictive (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn't require or maintain a configuration file for kube-apiserver. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.2"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the API server pod specification file ownership is set to root:root (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn't require or maintain a configuration file for kube-apiserver. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.3"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the controller manager pod specification file permissions are set to 644 or more restrictive (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn't require or maintain a configuration file for controller-manager. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.4"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the controller manager pod specification file ownership is set to root:root (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn't require or maintain a configuration file for controller-manager. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.5"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the scheduler pod specification file permissions are set to 644 or more restrictive (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn't require or maintain a configuration file for scheduler. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.6"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the scheduler pod specification file ownership is set to root:root (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn't require or maintain a configuration file for scheduler. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.7"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the etcd pod specification file permissions are set to 644 or more restrictive (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn't require or maintain a configuration file for etcd. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.8"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the etcd pod specification file ownership is set to root:root (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn't require or maintain a configuration file for etcd. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.13"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the admin.conf file permissions are set to 644 or more restrictive (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE does not store the kubernetes default kubeconfig credentials file on the nodes.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.14"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the admin.conf file ownership is set to root:root (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE does not store the kubernetes default kubeconfig credentials file on the nodes.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.15"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the scheduler.conf file permissions are set to 644 or more restrictive (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn't require or maintain a configuration file for scheduler. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.16"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the scheduler.conf file ownership is set to root:root (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn't require or maintain a configuration file for scheduler. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.17"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the controller-manager.conf file permissions are set to 644 or more restrictive (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn't require or maintain a configuration file for controller-manager. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.18"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the controller-manager.conf file ownership is set to root:root (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn't require or maintain a configuration file for controller-manager. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.3.6"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the RotateKubeletServerCertificate argument is set to true (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE handles certificate rotation directly through RKE.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"4.1.1"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the kubelet service file permissions are set to 644 or more restrictive (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn\u2019t require or maintain a configuration file for the kubelet service. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"4.1.2"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the kubelet service file ownership is set to root:root (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn\u2019t require or maintain a configuration file for the kubelet service. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"4.1.9"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the kubelet configuration file has permissions set to 644 or more restrictive (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn\u2019t require or maintain a configuration file for the kubelet. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"4.1.10"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the kubelet configuration file ownership is set to root:root (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE doesn\u2019t require or maintain a configuration file for the kubelet. All configuration is passed in as arguments at container run time.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"4.2.12"),(0,i.kt)("td",{parentName:"tr",align:null},"Ensure that the RotateKubeletServerCertificate argument is set to true (Scored)"),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE handles certificate rotation directly through RKE.")))),(0,i.kt)("h2",{id:"cis-benchmark-v14"},"CIS Benchmark v1.4"),(0,i.kt)("p",null,"The skipped and not applicable tests for CIS Benchmark v1.4 are as follows:"),(0,i.kt)("h3",{id:"cis-benchmark-v14-skipped-tests"},"CIS Benchmark v1.4 Skipped Tests"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Number"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Reason for Skipping"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.11"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the admission control plugin AlwaysPullImages is set (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling AlwaysPullImages can use significant bandwidth.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.21"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the --kubelet-certificate-authority argument is set as appropriate (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"When generating serving certificates, functionality could break in conjunction with hostname overrides which are required for certain cloud providers.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.24"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the admission control plugin PodSecurityPolicy is set (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling Pod Security Policy can cause applications to unexpectedly fail.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.34"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the --encryption-provider-config argument is set as appropriate (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling encryption changes how data can be recovered as data is encrypted.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.35"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the encryption provider is set to aescbc (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling encryption changes how data can be recovered as data is encrypted.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.36"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the admission control plugin EventRateLimit is set (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"EventRateLimit needs to be tuned depending on the cluster.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.2.2"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the --address argument is set to 127.0.0.1 (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Adding this argument prevents Rancher's monitoring tool to collect metrics on the scheduler.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.3.7"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the --address argument is set to 127.0.0.1 (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Adding this argument prevents Rancher's monitoring tool to collect metrics on the controller manager.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.4.12"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the etcd data directory ownership is set to etcd:etcd (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"A system service account is required for etcd data directory ownership. Refer to Rancher's hardening guide for more details on how to configure this ownership.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.7.2"),(0,i.kt)("td",{parentName:"tr",align:null},'"Do not admit containers wishing to share the host process ID namespace (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling Pod Security Policy can cause applications to unexpectedly fail.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.7.3"),(0,i.kt)("td",{parentName:"tr",align:null},'"Do not admit containers wishing to share the host IPC namespace (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling Pod Security Policy can cause applications to unexpectedly fail.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.7.4"),(0,i.kt)("td",{parentName:"tr",align:null},'"Do not admit containers wishing to share the host network namespace (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling Pod Security Policy can cause applications to unexpectedly fail.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.7.5"),(0,i.kt)("td",{parentName:"tr",align:null},'" Do not admit containers with allowPrivilegeEscalation (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Enabling Pod Security Policy can cause applications to unexpectedly fail.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"2.1.6"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the --protect-kernel-defaults argument is set to true (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"System level configurations are required before provisioning the cluster in order for this argument to be set to true.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"2.1.10"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"When generating serving certificates, functionality could break in conjunction with hostname overrides which are required for certain cloud providers.")))),(0,i.kt)("h3",{id:"cis-benchmark-v14-not-applicable-tests"},"CIS Benchmark v1.4 Not Applicable Tests"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Number"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Reason for being not applicable"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.1.9"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the --repair-malformed-updates argument is set to false (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"The argument --repair-malformed-updates has been removed as of Kubernetes version 1.14")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.3.6"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the RotateKubeletServerCertificate argument is set to true"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE handles certificate rotation directly through RKE.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.4.1"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the API server pod specification file permissions are set to 644 or more restrictive (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE doesn't require or maintain a configuration file for kube-apiserver.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.4.2"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the API server pod specification file ownership is set to root:root (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE doesn't require or maintain a configuration file for kube-apiserver.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.4.3"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the controller manager pod specification file permissions are set to 644 or more restrictive (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE doesn't require or maintain a configuration file for controller-manager.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.4.4"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the controller manager pod specification file ownership is set to root:root (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE doesn't require or maintain a configuration file for controller-manager.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.4.5"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the scheduler pod specification file permissions are set to 644 or more restrictive (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE doesn't require or maintain a configuration file for scheduler.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.4.6"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the scheduler pod specification file ownership is set to root:root (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE doesn't require or maintain a configuration file for scheduler.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.4.7"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the etcd pod specification file permissions are set to 644 or more restrictive (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE doesn't require or maintain a configuration file for etcd.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.4.8"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the etcd pod specification file ownership is set to root:root (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE doesn't require or maintain a configuration file for etcd.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.4.13"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the admin.conf file permissions are set to 644 or more restrictive (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE does not store the kubernetes default kubeconfig credentials file on the nodes.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1.4.14"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the admin.conf file ownership is set to root:root (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE does not store the kubernetes default kubeconfig credentials file on the nodes.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"2.1.8"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the --hostname-override argument is not set (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Clusters provisioned by RKE clusters and most cloud providers require hostnames.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"2.1.12"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the --rotate-certificates argument is not set to false (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE handles certificate rotation directly through RKE.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"2.1.13"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the RotateKubeletServerCertificate argument is set to true (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE handles certificate rotation directly through RKE.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"2.2.3"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the kubelet service file permissions are set to 644 or more restrictive (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE doesn\u2019t require or maintain a configuration file for the kubelet service.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"2.2.4"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the kubelet service file ownership is set to root:root (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"Cluster provisioned by RKE doesn\u2019t require or maintain a configuration file for the kubelet service.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"2.2.9"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the kubelet configuration file ownership is set to root:root (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"RKE doesn\u2019t require or maintain a configuration file for the kubelet.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"2.2.10"),(0,i.kt)("td",{parentName:"tr",align:null},'"Ensure that the kubelet configuration file has permissions set to 644 or more restrictive (Scored)"'),(0,i.kt)("td",{parentName:"tr",align:null},"RKE doesn\u2019t require or maintain a configuration file for the kubelet.")))))}m.isMDXComponent=!0}}]);