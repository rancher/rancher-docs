<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-2.0-2.4 plugin-docs plugin-id-default docs-doc-id-reference-guides/rancher-security/rancher-v2.1-hardening-guides/self-assessment-guide-with-cis-v1.3-benchmark" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">CIS Benchmark Rancher Self-Assessment Guide v2.1 | Rancher</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ranchermanager.docs.rancher.com/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides/self-assessment-guide-with-cis-v1.3-benchmark"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="2.0-2.4"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.0-2.4"><meta data-rh="true" name="docsearch:version" content="2.0-2.4"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.0-2.4"><meta data-rh="true" property="og:title" content="CIS Benchmark Rancher Self-Assessment Guide v2.1 | Rancher"><meta data-rh="true" name="description" content="This document is a companion to the Rancher v2.1 security hardening guide. The hardening guide provides prescriptive guidance for hardening a production installation of Rancher, and this benchmark guide is meant to help you evaluate the level of security of the hardened cluster against each control in the benchmark."><meta data-rh="true" property="og:description" content="This document is a companion to the Rancher v2.1 security hardening guide. The hardening guide provides prescriptive guidance for hardening a production installation of Rancher, and this benchmark guide is meant to help you evaluate the level of security of the hardened cluster against each control in the benchmark."><link data-rh="true" rel="icon" href="/zh/img/favicon.png"><link data-rh="true" rel="canonical" href="https://ranchermanager.docs.rancher.com/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides/self-assessment-guide-with-cis-v1.3-benchmark"><link data-rh="true" rel="alternate" href="https://ranchermanager.docs.rancher.com/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides/self-assessment-guide-with-cis-v1.3-benchmark" hreflang="en"><link data-rh="true" rel="alternate" href="https://ranchermanager.docs.rancher.com/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides/self-assessment-guide-with-cis-v1.3-benchmark" hreflang="zh"><link data-rh="true" rel="alternate" href="https://ranchermanager.docs.rancher.com/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides/self-assessment-guide-with-cis-v1.3-benchmark" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://30NEY6C9UY-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-57KS2MW",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>



<link rel="search" type="application/opensearchdescription+xml" title="Rancher" href="/zh/opensearch.xml">



<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="0f98beb0-fc4c-417d-a42e-564e2cae42d2" async></script>
<script src="/scripts/optanonwrapper.js" async></script><link rel="stylesheet" href="/zh/assets/css/styles.539b57ae.css">
<link rel="preload" href="/zh/assets/js/runtime~main.f9ac86ca.js" as="script">
<link rel="preload" href="/zh/assets/js/main.d6cf12b1.js" as="script">
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-57KS2MW" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh/"><div class="navbar__logo"><img src="/zh/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/zh/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/zh/v2.0-v2.4">v2.0-v2.4</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/">Latest</a></li><li><a class="dropdown__link" href="/zh/v2.8">v2.8</a></li><li><a class="dropdown__link" href="/zh/v2.7">v2.7</a></li><li><a class="dropdown__link" href="/zh/v2.6">v2.6</a></li><li><a class="dropdown__link" href="/zh/v2.5">v2.5</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides/self-assessment-guide-with-cis-v1.3-benchmark">v2.0-v2.4</a></li><li><a class="dropdown__link" href="/zh/versions">All versions</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides/self-assessment-guide-with-cis-v1.3-benchmark" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides/self-assessment-guide-with-cis-v1.3-benchmark" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">简体中文</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Quick Links</a><ul class="dropdown__menu"><li><a href="https://github.com/rancher/rancher" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/rancher/rancher-docs" target="_blank" rel="noopener noreferrer" class="dropdown__link">Docs GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">More from SUSE</a><ul class="dropdown__menu"><li><a href="https://www.rancher.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rancher">Rancher<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://elemental.docs.rancher.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__elemental">Elemental<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://fleet.rancher.io/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__fleet">Fleet<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://harvesterhci.io" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__harvester">Harvester<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://rancherdesktop.io/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rancher__desktop">Rancher Desktop<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://opensource.suse.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__suse">More Projects...<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh/v2.0-v2.4">Rancher 2.0-2.4</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/v2.0-v2.4/getting-started">Getting Started</a><button aria-label="打开/收起侧边栏菜单「Getting Started」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/v2.0-v2.4/how-to-guides">How-to Guides</a><button aria-label="打开/收起侧边栏菜单「How-to Guides」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/zh/v2.0-v2.4/reference-guides">Reference Guides</a><button aria-label="打开/收起侧边栏菜单「Reference Guides」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/best-practices">Best Practice Guides</a><button aria-label="打开/收起侧边栏菜单「Best Practice Guides」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/rancher-manager-architecture">Rancher Architecture</a><button aria-label="打开/收起侧边栏菜单「Rancher Architecture」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/cluster-configuration">Cluster Configuration</a><button aria-label="打开/收起侧边栏菜单「Cluster Configuration」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/single-node-rancher-in-docker">Single-Node Rancher in Docker</a><button aria-label="打开/收起侧边栏菜单「Single-Node Rancher in Docker」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/installation-references">Installation References</a><button aria-label="打开/收起侧边栏菜单「Installation References」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/installation-references/amazon-eks-permissions">Creating an EKS Cluster</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/configure-openldap">Configuring OpenLDAP</a><button aria-label="打开/收起侧边栏菜单「Configuring OpenLDAP」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/kubernetes-concepts">Kubernetes Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/user-settings">User Settings</a><button aria-label="打开/收起侧边栏菜单「User Settings」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/cli-with-rancher">CLI with Rancher</a><button aria-label="打开/收起侧边栏菜单「CLI with Rancher」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/about-the-api">About the API</a><button aria-label="打开/收起侧边栏菜单「About the API」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/rancher-cluster-tools">Tools for Logging, Monitoring, and More</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/rancher-project-tools">Project Tools</a><button aria-label="打开/收起侧边栏菜单「Project Tools」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/system-tools">System Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/rke1-template-example-yaml">RKE1 Example YAML</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/pipelines">Pipelines</a><button aria-label="打开/收起侧边栏菜单「Pipelines」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/rancher-security">Rancher Security Guides</a><button aria-label="打开/收起侧边栏菜单「Rancher Security Guides」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides">Rancher v2.1 Hardening Guides</a><button aria-label="打开/收起侧边栏菜单「Rancher v2.1 Hardening Guides」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides/self-assessment-guide-with-cis-v1.3-benchmark">CIS Benchmark Rancher Self-Assessment Guide v2.1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides/hardening-guide-with-cis-v1.3-benchmark">Hardening Guide v2.1</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.2-hardening-guides">Rancher v2.2 Hardening Guides</a><button aria-label="打开/收起侧边栏菜单「Rancher v2.2 Hardening Guides」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.3-hardening-guides">Rancher v2.3 Hardening Guides</a><button aria-label="打开/收起侧边栏菜单「Rancher v2.3 Hardening Guides」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.4-hardening-guides">Rancher v2.4 Hardening Guides</a><button aria-label="打开/收起侧边栏菜单「Rancher v2.4 Hardening Guides」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/rancher-security/security-advisories-and-cves">Rancher CVEs and Resolutions</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.0-v2.4/reference-guides/v1.6-migration/migration-tools-cli-reference">Migration Tools CLI Reference</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/v2.0-v2.4/explanations">Explanations</a><button aria-label="打开/收起侧边栏菜单「Explanations」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/v2.0-v2.4/faq">FAQ</a><button aria-label="打开/收起侧边栏菜单「FAQ」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/v2.0-v2.4/troubleshooting">Troubleshooting</a><button aria-label="打开/收起侧边栏菜单「Troubleshooting」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh/v2.0-v2.4/contribute-to-rancher">Contributing to Rancher</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>此为 <!-- -->Rancher<!-- --> <b>v2.0-v2.4</b> 版的文档，现已不再积极维护。</div><div class="margin-top--md">最新的文档请参阅<b><a href="/zh/">最新版本</a></b> (<!-- -->Latest<!-- -->)。</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/zh/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/v2.0-v2.4/reference-guides"><span itemprop="name">Reference Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/v2.0-v2.4/reference-guides/rancher-security"><span itemprop="name">Rancher Security Guides</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides"><span itemprop="name">Rancher v2.1 Hardening Guides</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">CIS Benchmark Rancher Self-Assessment Guide v2.1</span><meta itemprop="position" content="4"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">版本：v2.0-v2.4</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>CIS Benchmark Rancher Self-Assessment Guide v2.1</h1></header><p>This document is a companion to the Rancher v2.1 security hardening guide. The hardening guide provides prescriptive guidance for hardening a production installation of Rancher, and this benchmark guide is meant to help you evaluate the level of security of the hardened cluster against each control in the benchmark.</p><p>This guide corresponds to specific versions of the hardening guide, Rancher, Kubernetes, and the CIS Benchmark:</p><table><thead><tr><th>Self Assessment Guide Version</th><th>Rancher Version</th><th>Hardening Guide Version</th><th>Kubernetes Version</th><th>CIS Benchmark Version</th></tr></thead><tbody><tr><td>Self Assessment Guide v2.1</td><td>Rancher v2.1.x</td><td>Hardening Guide v2.1</td><td>Kubernetes 1.11</td><td>Benchmark 1.3.0</td></tr></tbody></table><p>Because Rancher and RKE install Kubernetes services as Docker containers, many of the control verification checks in the CIS Kubernetes Benchmark don&#x27;t apply. This guide will walk through the various controls and provide updated example commands to audit compliance in Rancher-created clusters.</p><p>This document is to be used by Rancher operators, security teams, auditors and decision makers.</p><p>For more detail about each audit, including rationales and remediations for failing tests, you can refer to the corresponding section of the CIS Kubernetes Benchmark v1.3.0. You can download the benchmark after logging in to <a href="https://www.cisecurity.org/benchmark/kubernetes/" target="_blank" rel="noopener noreferrer">CISecurity.org</a>.</p><p><a href="https://releases.rancher.com/documents/security/2.1.x/Rancher_Benchmark_Assessment.pdf" target="_blank" rel="noopener noreferrer">Click here to download a PDF version of this document</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="testing-controls-methodology">Testing controls methodology<a href="#testing-controls-methodology" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p>Rancher and RKE install Kubernetes services via Docker containers. Configuration is defined by arguments passed to the container at the time of initialization, not via configuration files.</p><p>Scoring the commands is different in Rancher Labs than in the CIS Benchmark. Where the commands differ from the original CIS benchmark, the commands specific to Rancher Labs are provided for testing.</p><p>When performing the tests, you will need access to the Docker command line on the hosts of all three RKE roles. The commands also make use of the the <code>jq</code> command to provide human-readable formatting.</p><p>Tests will have an exit code of zero on success and non-zero on failure.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="known-scored-control-failures">Known Scored Control Failures<a href="#known-scored-control-failures" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p>The following scored controls do not currently pass, and Rancher Labs is working towards addressing these through future enhancements to the product.</p><ul><li>1.1.21 - Ensure that the <code>--kubelet-certificate-authority</code> argument is set as appropriate (Scored)</li><li>1.3.6 - Ensure that the <code>RotateKubeletServerCertificate</code> argument is set to <code>true</code> (Scored)</li><li>1.4.11 - Ensure that the etcd data directory permissions are set to <code>700</code> or more-restrictive (Scored)</li><li>1.4.12 - Ensure that the etcd data directory ownership is set to <code>etcd:etcd</code> (Scored)</li><li>2.1.3 - Ensure that the <code>--authorization-mode</code> argument is not set to <code>AlwaysAllow</code> (Scored)</li><li>2.1.9 - Ensure that the <code>--hostname-override</code> argument is not set (Scored)</li><li>2.1.13 - Ensure that the <code>--rotate-certificates</code> argument is not set to <code>false</code> (Scored)</li><li>2.1.14 - Ensure that the <code>RotateKubeletServerCertificate</code> argument is set to <code>true</code> (Scored)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="controls">Controls<a href="#controls" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1---master-node-security-configuration">1 - Master Node Security Configuration<a href="#1---master-node-security-configuration" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="11---api-server">1.1 - API Server<a href="#11---api-server" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="111---ensure-that-the---anonymous-auth-argument-is-set-to-false-scored">1.1.1 - Ensure that the <code>--anonymous-auth</code> argument is set to <code>false</code> (Scored)<a href="#111---ensure-that-the---anonymous-auth-argument-is-set-to-false-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--anonymous-auth=false&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--anonymous-auth=false</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="112---ensure-that-the---basic-auth-file-argument-is-not-set-scored">1.1.2 - Ensure that the <code>--basic-auth-file</code> argument is not set (Scored)<a href="#112---ensure-that-the---basic-auth-file-argument-is-not-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--basic-auth-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong>  <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="113---ensure-that-the---insecure-allow-any-token-argument-is-not-set-scored">1.1.3 - Ensure that the <code>--insecure-allow-any-token</code> argument is not set (Scored)<a href="#113---ensure-that-the---insecure-allow-any-token-argument-is-not-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--insecure-allow-any-token&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong>  <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="114---ensure-that-the---kubelet-https-argument-is-set-to-true-scored">1.1.4 - Ensure that the <code>--kubelet-https</code> argument is set to <code>true</code> (Scored)<a href="#114---ensure-that-the---kubelet-https-argument-is-set-to-true-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--kubelet-https=false&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="115---ensure-that-the---insecure-bind-address-argument-is-not-set-scored">1.1.5 - Ensure that the <code>--insecure-bind-address</code> argument is not set (Scored)<a href="#115---ensure-that-the---insecure-bind-address-argument-is-not-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>Flag not set or <code>--insecure-bind-address=127.0.0.1</code>. RKE sets this flag to <code>--insecure-bind-address=127.0.0.1</code></p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--insecure-bind-address=(?:(?!127\\.0\\.0\\.1).)+&quot;)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="116---ensure-that-the---insecure-port-argument-is-set-to-0-scored">1.1.6 - Ensure that the <code>--insecure-port argument</code> is set to <code>0</code> (Scored)<a href="#116---ensure-that-the---insecure-port-argument-is-set-to-0-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--insecure-port=0&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--insecure-port=0</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="117---ensure-that-the---secure-port-argument-is-not-set-to-0-scored">1.1.7 - Ensure that the <code>--secure-port</code> argument is not set to <code>0</code> (Scored)<a href="#117---ensure-that-the---secure-port-argument-is-not-set-to-0-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--secure-port=6443&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--secure-port=6443</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="118---ensure-that-the---profiling-argument-is-set-to-false-scored">1.1.8 - Ensure that the <code>--profiling</code> argument is set to <code>false</code> (Scored)<a href="#118---ensure-that-the---profiling-argument-is-set-to-false-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--profiling=false&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--profiling=false</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="119---ensure-that-the---repair-malformed-updates-argument-is-set-to-false-scored">1.1.9 - Ensure that the <code>--repair-malformed-updates</code> argument is set to <code>false</code> (Scored)<a href="#119---ensure-that-the---repair-malformed-updates-argument-is-set-to-false-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--repair-malformed-updates=false&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--repair-malformed-updates=false</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1110---ensure-that-the-admission-control-plugin-alwaysadmit-is-not-set-scored">1.1.10 - Ensure that the admission control plugin <code>AlwaysAdmit</code> is not set (Scored)<a href="#1110---ensure-that-the-admission-control-plugin-alwaysadmit-is-not-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--enable-admission-plugins=.*(AlwaysAdmit).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1111---ensure-that-the-admission-control-plugin-alwayspullimages-is-set-scored">1.1.11 - Ensure that the admission control plugin <code>AlwaysPullImages</code> is set (Scored)<a href="#1111---ensure-that-the-admission-control-plugin-alwayspullimages-is-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--enable-admission-plugins=.*(AlwaysPullImages).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>AlwaysPullImages</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1112---ensure-that-the-admission-control-plugin-denyescalatingexec-is-set-scored">1.1.12 - Ensure that the admission control plugin <code>DenyEscalatingExec</code> is set (Scored)<a href="#1112---ensure-that-the-admission-control-plugin-denyescalatingexec-is-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--enable-admission-plugins=.*(DenyEscalatingExec).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>DenyEscalatingExec</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1113---ensure-that-the-admission-control-plugin-securitycontextdeny-is-set-scored">1.1.13 - Ensure that the admission control plugin <code>SecurityContextDeny</code> is set (Scored)<a href="#1113---ensure-that-the-admission-control-plugin-securitycontextdeny-is-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>This control may be out of date. This <strong>SHOULD NOT</strong> be set if you are using a <code>PodSecurityPolicy</code> (PSP). From the Kubernetes 1.11 documentation:</p><blockquote><p>This should be enabled if a cluster doesn’t utilize pod security policies to restrict the set of values a security context can take.</p></blockquote><p>Several system services (such as <code>nginx-ingress</code>) utilize <code>SecurityContext</code> to switch users and assign capabilities. These exceptions to the general principle of not allowing privilege or capabilities can be managed with PSP.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--enable-admission-plugins=.*(SecurityContextDeny).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Document</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1114---ensure-that-the-admission-control-plugin-namespacelifecycle-is-set-scored">1.1.14 - Ensure that the admission control plugin <code>NamespaceLifecycle</code> is set (Scored)<a href="#1114---ensure-that-the-admission-control-plugin-namespacelifecycle-is-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--enable-admission-plugins=.*(NamespaceLifecycle).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>NamespaceLifecycle</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1115---ensure-that-the---audit-log-path-argument-is-set-as-appropriate-scored">1.1.15 - Ensure that the <code>--audit-log-path</code> argument is set as appropriate (Scored)<a href="#1115---ensure-that-the---audit-log-path-argument-is-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>This path is the path inside of the container.  It&#x27;s combined with the RKE <code>cluster.yml</code> <code>extra-binds:</code> option to map the audit log to the host filesystem.</p><p>Audit logs should be collected and shipped off-system to guarantee their integrity.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--audit-log-path=/var/log/kube-audit/audit-log.json&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--audit-log-log=/var/log/kube-audit/audit-log.json</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1116---ensure-that-the---audit-log-maxage-argument-is-set-to-30-or-as-appropriate-scored">1.1.16 - Ensure that the <code>--audit-log-maxage</code> argument is set to <code>30</code> or as appropriate (Scored)<a href="#1116---ensure-that-the---audit-log-maxage-argument-is-set-to-30-or-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>Audit logs should be collected and shipped off-system to guarantee their integrity. Rancher Labs recommends setting this argument to a low value to prevent audit logs from filling the local disk.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--audit-log-maxage=\\d+&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--audit-log-maxage=5</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1117---ensure-that-the---audit-log-maxbackup-argument-is-set-to-10-or-as-appropriate-scored">1.1.17 - Ensure that the <code>--audit-log-maxbackup</code> argument is set to <code>10</code> or as appropriate (Scored)<a href="#1117---ensure-that-the---audit-log-maxbackup-argument-is-set-to-10-or-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>Audit logs should be collected and shipped off-system to guarantee their integrity. Rancher Labs recommends setting this argument to a low value to prevent audit logs from filling the local disk.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--audit-log-maxbackup=\\d+&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--audit-log-maxbackup=5</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1118---ensure-that-the---audit-log-maxsize-argument-is-set-to-100-or-as-appropriate-scored">1.1.18 - Ensure that the <code>--audit-log-maxsize</code> argument is set to <code>100</code> or as appropriate (Scored)<a href="#1118---ensure-that-the---audit-log-maxsize-argument-is-set-to-100-or-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>Audit logs should be collected and shipped off-system to guarantee their integrity.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--audit-log-maxsize=\\d+&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--audit-log-maxsize=100</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1119---ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-scored">1.1.19 - Ensure that the <code>--authorization-mode</code> argument is not set to <code>AlwaysAllow</code> (Scored)<a href="#1119---ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker inspect kube-apiserver | jq -e &#x27;.[0].Args[] | match(&quot;--authorization-mode=(Node|RBAC|,)+&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--authorization-mode=Node,RBAC</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1120---ensure-that-the---token-auth-file-parameter-is-not-set-scored">1.1.20 - Ensure that the <code>--token-auth-file</code> parameter is not set (Scored)<a href="#1120---ensure-that-the---token-auth-file-parameter-is-not-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--token-auth-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1121---ensure-that-the---kubelet-certificate-authority-argument-is-set-as-appropriate-scored">1.1.21 - Ensure that the <code>--kubelet-certificate-authority</code> argument is set as appropriate (Scored)<a href="#1121---ensure-that-the---kubelet-certificate-authority-argument-is-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE is using the kubelet&#x27;s ability to automatically create self-signed certs. No CA cert is saved to verify the communication between <code>kube-apiserver</code> and <code>kubelet</code>.</p><p><strong>Mitigation</strong></p><p>Make sure nodes with <code>role:controlplane</code> are on the same local network as your nodes with <code>role:worker</code>.  Use network ACLs to restrict connections to the kubelet port (10250/tcp) on worker nodes, only permitting it from controlplane nodes.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--kubelet-certificate-authority=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> none</p><p><strong>Result:</strong> Fail (See Mitigation)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1122---ensure-that-the---kubelet-client-certificate-and---kubelet-client-key-arguments-are-set-as-appropriate-scored">1.1.22 - Ensure that the <code>--kubelet-client-certificate</code> and <code>--kubelet-client-key</code> arguments are set as appropriate (Scored)<a href="#1122---ensure-that-the---kubelet-client-certificate-and---kubelet-client-key-arguments-are-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong> (<code>--kubelet-client-certificate</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--kubelet-client-certificate=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--kubelet-client-certificate=/etc/kubernetes/ssl/kube-apiserver.pem</code></p><p><strong>Audit</strong> (<code>--kubelet-client-key</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--kubelet-client-key=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--kubelet-client-key=/etc/kubernetes/ssl/kube-apiserver-key.pem</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1123-ensure-that-the---service-account-lookup-argument-is-set-to-true-scored">1.1.23 Ensure that the <code>--service-account-lookup</code> argument is set to <code>true</code> (Scored)<a href="#1123-ensure-that-the---service-account-lookup-argument-is-set-to-true-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--service-account-lookup=true&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--service-account-lookup=true</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1124---ensure-that-the-admission-control-plugin-podsecuritypolicy-is-set-scored">1.1.24 - Ensure that the admission control plugin <code>PodSecurityPolicy</code> is set (Scored)<a href="#1124---ensure-that-the-admission-control-plugin-podsecuritypolicy-is-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--enable-admission-plugins=.*(PodSecurityPolicy).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>PodSecurityPolicy</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1125---ensure-that-the---service-account-key-file-argument-is-set-as-appropriate-scored">1.1.25 - Ensure that the <code>--service-account-key-file</code> argument is set as appropriate (Scored)<a href="#1125---ensure-that-the---service-account-key-file-argument-is-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--service-account-key-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--service-account-key-file=/etc/kubernetes/ssl/kube-apiserver-key.pem</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1126---ensure-that-the---etcd-certfile-and---etcd-keyfile-arguments-are-set-as-appropriate-scored">1.1.26 - Ensure that the <code>--etcd-certfile</code> and <code>--etcd-keyfile</code> arguments are set as appropriate (Scored)<a href="#1126---ensure-that-the---etcd-certfile-and---etcd-keyfile-arguments-are-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong> (<code>--etcd-certfile</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--etcd-certfile=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--etcd-certfile=/etc/kubernetes/ssl/kube-node.pem</code></p><p><strong>Audit</strong> (<code>--etcd-keyfile</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--etcd-keyfile=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--etcd-keyfile=/etc/kubernetes/ssl/kube-node-key.pem</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1127---ensure-that-the-admission-control-plugin-serviceaccount-is-set-scored">1.1.27 - Ensure that the admission control plugin <code>ServiceAccount</code> is set (Scored)<a href="#1127---ensure-that-the-admission-control-plugin-serviceaccount-is-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--enable-admission-plugins=.*(ServiceAccount).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>ServiceAccount</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1128---ensure-that-the---tls-cert-file-and---tls-private-key-file-arguments-are-set-as-appropriate-scored">1.1.28 - Ensure that the <code>--tls-cert-file</code> and <code>--tls-private-key-file</code> arguments are set as appropriate (Scored)<a href="#1128---ensure-that-the---tls-cert-file-and---tls-private-key-file-arguments-are-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong> (<code>--tls-cert-file</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cert-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--tls-cert-file=/etc/kubernetes/ssl/kube-apiserver.pem</code></p><p><strong>Audit</strong> (<code>--tls-key-file</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-private-key-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--tls-private-key-file=/etc/kubernetes/ssl/kube-apiserver-key.pem</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1129---ensure-that-the---client-ca-file-argument-is-set-as-appropriate-scored">1.1.29 - Ensure that the <code>--client-ca-file</code> argument is set as appropriate (Scored)<a href="#1129---ensure-that-the---client-ca-file-argument-is-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--client-ca-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--client-ca-file=/etc/kubernetes/ssl/kube-ca.pem</code>
<strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1130---ensure-that-the-api-server-only-makes-use-of-strong-cryptographic-ciphers-not-scored">1.1.30 - Ensure that the API Server only makes use of strong cryptographic ciphers (Not Scored)<a href="#1130---ensure-that-the-api-server-only-makes-use-of-strong-cryptographic-ciphers-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong> (Allowed Ciphers)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> The return should be blank.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> The return should be blank.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> The return should be blank.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_RSA_WITH_AES_128_GCM_SHA256).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_RSA_WITH_AES_256_GCM_SHA384).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_RSA_WITH_AES_256_GCM_SHA384</code></p><p><strong>Audit</strong> (Disallowed Ciphers)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(CBC).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(RC4).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1131---ensure-that-the---etcd-cafile-argument-is-set-as-appropriate-scored">1.1.31 - Ensure that the <code>--etcd-cafile</code> argument is set as appropriate (Scored)<a href="#1131---ensure-that-the---etcd-cafile-argument-is-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--etcd-cafile=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--etcd-cafile=/etc/kubernetes/ssl/kube-ca.pem</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1132---ensure-that-the---authorization-mode-argument-is-set-to-node-scored">1.1.32 - Ensure that the <code>--authorization-mode</code> argument is set to Node (Scored)<a href="#1132---ensure-that-the---authorization-mode-argument-is-set-to-node-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--authorization-mode=(Node|RBAC|,)+&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--authorization-mode=Node,RBA</code>
<strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1133---ensure-that-the-admission-control-plugin-noderestriction-is-set-scored">1.1.33 - Ensure that the admission control plugin <code>NodeRestriction</code> is set (Scored)<a href="#1133---ensure-that-the-admission-control-plugin-noderestriction-is-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--enable-admission-plugins=.*(NodeRestriction).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>NodeRestriction</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1134---ensure-that-the---experimental-encryption-provider-config-argument-is-set-as-appropriate-scored">1.1.34 - Ensure that the <code>--experimental-encryption-provider-config</code> argument is set as appropriate (Scored)<a href="#1134---ensure-that-the---experimental-encryption-provider-config-argument-is-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--experimental-encryption-provider-config=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--experimental-encryption-provider-config=/etc/kubernetes/encryption.yaml</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1135---ensure-that-the-encryption-provider-is-set-to-aescbc-scored">1.1.35 - Ensure that the encryption provider is set to aescbc (Scored)<a href="#1135---ensure-that-the-encryption-provider-is-set-to-aescbc-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>Only the first provider in the list is active.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> -A </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> providers: /etc/kubernetes/encryption.yaml </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> aescbc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong>  <code>- aescbc:</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1136---ensure-that-the-admission-control-plugin-eventratelimit-is-set-scored">1.1.36 - Ensure that the admission control plugin <code>EventRateLimit</code> is set (Scored)<a href="#1136---ensure-that-the-admission-control-plugin-eventratelimit-is-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>The <code>EventRateLimit</code> plugin requires setting the <code>--admission-control-config-file</code> option and configuring details in the following files:</p><ul><li><code>/etc/kubernetes/admission.yaml</code></li><li><code>/etc/kubernetes/event.yaml</code></li></ul><p>See Host Configuration for details.</p><p><strong>Audit</strong> (Admissions plugin)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--enable-admission-plugins=.*(EventRateLimit).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>EventRateLimit</code></p><p><strong>Audit</strong> (<code>--admission-control-config-file</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--admission-control-config-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--admission-control-config-file=/etc/kubernetes/admission.yaml</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1137-ensure-that-the-advancedauditing-argument-is-not-set-to-false-scored">1.1.37 Ensure that the AdvancedAuditing argument is not set to false (Scored)<a href="#1137-ensure-that-the-advancedauditing-argument-is-not-set-to-false-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p><code>AdvancedAuditing=false</code> should not be set, but <code>--audit-policy-file</code> should be set and configured.  See Host Configuration for a sample audit policy file.</p><p><strong>Audit</strong> (Feature Gate)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--feature-gates=.*(AdvancedAuditing=false).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Audit</strong> (Audit Policy File)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--audit-policy-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--audit-policy-file=/etc/kubernetes/audit.yaml</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1138-ensure-that-the---request-timeout-argument-is-set-as-appropriate-scored">1.1.38 Ensure that the <code>--request-timeout</code> argument is set as appropriate (Scored)<a href="#1138-ensure-that-the---request-timeout-argument-is-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE uses the default value of 60s and doesn&#x27;t set this option.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--request-timeout=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1139---ensure-that-the-api-server-only-makes-use-of-strong-cryptographic-ciphers-not-scored">1.1.39 - Ensure that the API Server only makes use of strong cryptographic ciphers (Not Scored)<a href="#1139---ensure-that-the-api-server-only-makes-use-of-strong-cryptographic-ciphers-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>This appears to be a repeat of 1.1.30.</p><p><strong>Audit</strong> (Allowed Ciphers)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_RSA_WITH_AES_128_GCM_SHA256).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_RSA_WITH_AES_256_GCM_SHA384).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_RSA_WITH_AES_256_GCM_SHA384</code></p><p><strong>Audit</strong> (Disallowed Ciphers)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(CBC).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(RC4).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="12---scheduler">1.2 - Scheduler<a href="#12---scheduler" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="121---ensure-that-the---profiling-argument-is-set-to-false-scored">1.2.1 - Ensure that the <code>--profiling</code> argument is set to false (Scored)<a href="#121---ensure-that-the---profiling-argument-is-set-to-false-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-scheduler </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--profiling=false&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--profiling=false</code>
<strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="122---ensure-that-the---address-argument-is-set-to-127001-scored">1.2.2 - Ensure that the <code>--address</code> argument is set to 127.0.0.1 (Scored)<a href="#122---ensure-that-the---address-argument-is-set-to-127001-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-scheduler </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--address=127\\.0\\.0\\.1&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--address=127.0.0.1</code>
<strong>Result:</strong> Pass</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="13---controller-manager">1.3 - Controller Manager<a href="#13---controller-manager" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="131---ensure-that-the---terminated-pod-gc-threshold-argument-is-set-as-appropriate-scored">1.3.1 - Ensure that the <code>--terminated-pod-gc-threshold</code> argument is set as appropriate (Scored)<a href="#131---ensure-that-the---terminated-pod-gc-threshold-argument-is-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-controller-manager </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--terminated-pod-gc-threshold=\\d+&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--terminated-pod-gc-threshold=1000</code>
<strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="132---ensure-that-the---profiling-argument-is-set-to-false-scored">1.3.2 - Ensure that the <code>--profiling</code> argument is set to false (Scored)<a href="#132---ensure-that-the---profiling-argument-is-set-to-false-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-controller-manager </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--profiling=false&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--profiling=false</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="133---ensure-that-the---use-service-account-credentials-argument-is-set-to-true-scored">1.3.3 - Ensure that the <code>--use-service-account-credentials</code> argument is set to true (Scored)<a href="#133---ensure-that-the---use-service-account-credentials-argument-is-set-to-true-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-controller-manager </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--use-service-account-credentials=true&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--use-service-account-credentials=true</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="134---ensure-that-the---service-account-private-key-file-argument-is-set-as-appropriate-scored">1.3.4 - Ensure that the <code>--service-account-private-key-file</code> argument is set as appropriate (Scored)<a href="#134---ensure-that-the---service-account-private-key-file-argument-is-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-controller-manager </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--service-account-private-key-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--service-account-private-key-file=/etc/kubernetes/ssl/kube-apiserver-key.pem</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="135---ensure-that-the---root-ca-file-argument-is-set-as-appropriate-scored">1.3.5 - Ensure that the <code>--root-ca-file</code> argument is set as appropriate (Scored)<a href="#135---ensure-that-the---root-ca-file-argument-is-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-controller-manager </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--root-ca-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--root-ca-file=/etc/kubernetes/ssl/kube-ca.pem</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="136---ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-scored">1.3.6 - Ensure that the RotateKubeletServerCertificate argument is set to true (Scored)<a href="#136---ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE does not yet support certificate rotation. This feature is due for the 0.1.12 release of RKE.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-apiserver </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--feature-gates=.*(RotateKubeletServerCertificate=true).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Fail</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="137---ensure-that-the---address-argument-is-set-to-127001-scored">1.3.7 - Ensure that the <code>--address</code> argument is set to 127.0.0.1 (Scored)<a href="#137---ensure-that-the---address-argument-is-set-to-127001-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kube-controller-manager </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--address=127\\.0\\.0\\.1&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--address=127.0.0.1</code></p><p><strong>Result:</strong> Pass</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="14---configuration-files">1.4 - Configuration Files<a href="#14---configuration-files" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="141---ensure-that-the-api-server-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored">1.4.1 - Ensure that the API server pod specification file permissions are set to 644 or more restrictive (Scored)<a href="#141---ensure-that-the-api-server-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE doesn&#x27;t require or maintain a configuration file for kube-apiserver. All configuration is passed in as arguments at container run time.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="142---ensure-that-the-api-server-pod-specification-file-ownership-is-set-to-rootroot-scored">1.4.2 - Ensure that the API server pod specification file ownership is set to <code>root:root</code> (Scored)<a href="#142---ensure-that-the-api-server-pod-specification-file-ownership-is-set-to-rootroot-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE doesn&#x27;t require or maintain a configuration file for kube-apiserver. All configuration is passed in as arguments at container run time.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="143---ensure-that-the-controller-manager-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored">1.4.3 - Ensure that the controller manager pod specification file permissions are set to <code>644</code> or more restrictive (Scored)<a href="#143---ensure-that-the-controller-manager-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE doesn&#x27;t require or maintain a configuration file for <code>kube-controller-manager</code>. All configuration is passed in as arguments at container run time.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="144---ensure-that-the-controller-manager-pod-specification-file-ownership-is-set-to-rootroot-scored">1.4.4 - Ensure that the controller manager pod specification file ownership is set to <code>root:root</code> (Scored)<a href="#144---ensure-that-the-controller-manager-pod-specification-file-ownership-is-set-to-rootroot-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE doesn&#x27;t require or maintain a configuration file for <code>kube-controller-manager</code>. All configuration is passed in as arguments at container run time.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="145---ensure-that-the-scheduler-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored">1.4.5 - Ensure that the scheduler pod specification file permissions are set to <code>644</code> or more restrictive (Scored)<a href="#145---ensure-that-the-scheduler-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE doesn&#x27;t require or maintain a configuration file for <code>kube-scheduler</code>. All configuration is passed in as arguments at container run time.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="146---ensure-that-the-scheduler-pod-specification-file-ownership-is-set-to-rootroot-scored">1.4.6 - Ensure that the scheduler pod specification file ownership is set to <code>root:root</code> (Scored)<a href="#146---ensure-that-the-scheduler-pod-specification-file-ownership-is-set-to-rootroot-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE doesn&#x27;t require or maintain a configuration file for kube-scheduler. All configuration is passed in as arguments at container run time.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="147---ensure-that-the-etcd-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored">1.4.7 - Ensure that the <code>etcd</code> pod specification file permissions are set to <code>644</code> or more restrictive (Scored)<a href="#147---ensure-that-the-etcd-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE doesn&#x27;t require or maintain a configuration file for etcd. All configuration is passed in as arguments at container run time.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="148---ensure-that-the-etcd-pod-specification-file-ownership-is-set-to-rootroot-scored">1.4.8 - Ensure that the <code>etcd</code> pod specification file ownership is set to <code>root:root</code> (Scored)<a href="#148---ensure-that-the-etcd-pod-specification-file-ownership-is-set-to-rootroot-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE doesn&#x27;t require or maintain a configuration file for etcd. All configuration is passed in as arguments at container run time.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="149---ensure-that-the-container-network-interface-file-permissions-are-set-to-644-or-more-restrictive-not-scored">1.4.9 - Ensure that the Container Network Interface file permissions are set to <code>644</code> or more restrictive (Not Scored)<a href="#149---ensure-that-the-container-network-interface-file-permissions-are-set-to-644-or-more-restrictive-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>This is a manual check.</p><p><strong>Audit</strong> (<code>/var/lib/cni/networks/k8s-pod-network</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">ls</span><span class="token plain"> -l /var/lib/cni/networks/k8s-pod-network/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r-- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root   </span><span class="token number" style="color:rgb(247, 140, 108)">64</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain">:05 </span><span class="token number" style="color:rgb(247, 140, 108)">10.42</span><span class="token plain">.0.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r-- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root   </span><span class="token number" style="color:rgb(247, 140, 108)">64</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain">:05 </span><span class="token number" style="color:rgb(247, 140, 108)">10.42</span><span class="token plain">.0.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r-- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root   </span><span class="token number" style="color:rgb(247, 140, 108)">64</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain">:05 </span><span class="token number" style="color:rgb(247, 140, 108)">10.42</span><span class="token plain">.0.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r-- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root   </span><span class="token number" style="color:rgb(247, 140, 108)">64</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain">:05 </span><span class="token number" style="color:rgb(247, 140, 108)">10.42</span><span class="token plain">.0.5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r-- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root   </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">16</span><span class="token plain">:25 last_reserved_ip.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Audit</strong> (<code>/etc/cni/net.d</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">ls</span><span class="token plain"> -l /etc/cni/net.d/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r-- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root </span><span class="token number" style="color:rgb(247, 140, 108)">1474</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain">:05 </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">-calico.conflist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw------- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root </span><span class="token number" style="color:rgb(247, 140, 108)">2529</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain">:05 calico-kubeconfig</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1410---ensure-that-the-container-network-interface-file-ownership-is-set-to-rootroot-not-scored">1.4.10 - Ensure that the Container Network Interface file ownership is set to <code>root:root</code> (Not Scored)<a href="#1410---ensure-that-the-container-network-interface-file-ownership-is-set-to-rootroot-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>This is a manual check.</p><p><strong>Audit</strong> (<code>/var/lib/cni/networks/k8s-pod-network</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">ls</span><span class="token plain"> -l /var/lib/cni/networks/k8s-pod-network/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r-- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root   </span><span class="token number" style="color:rgb(247, 140, 108)">64</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain">:05 </span><span class="token number" style="color:rgb(247, 140, 108)">10.42</span><span class="token plain">.0.2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r-- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root   </span><span class="token number" style="color:rgb(247, 140, 108)">64</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain">:05 </span><span class="token number" style="color:rgb(247, 140, 108)">10.42</span><span class="token plain">.0.3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r-- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root   </span><span class="token number" style="color:rgb(247, 140, 108)">64</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain">:05 </span><span class="token number" style="color:rgb(247, 140, 108)">10.42</span><span class="token plain">.0.4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r-- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root   </span><span class="token number" style="color:rgb(247, 140, 108)">64</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain">:05 </span><span class="token number" style="color:rgb(247, 140, 108)">10.42</span><span class="token plain">.0.5</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r-- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root   </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">7</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">16</span><span class="token plain">:25 last_reserved_ip.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Audit</strong> (<code>/etc/cni/net.d</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">ls</span><span class="token plain"> -l /etc/cni/net.d/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw-r--r-- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root </span><span class="token number" style="color:rgb(247, 140, 108)">1474</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain">:05 </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">-calico.conflist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">-rw------- </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> root root </span><span class="token number" style="color:rgb(247, 140, 108)">2529</span><span class="token plain"> Nov  </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain">:05 calico-kubeconfig</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1411---ensure-that-the-etcd-data-directory-permissions-are-set-to-700-or-more-restrictive-scored">1.4.11 - Ensure that the etcd data directory permissions are set to 700 or more restrictive (Scored)<a href="#1411---ensure-that-the-etcd-data-directory-permissions-are-set-to-700-or-more-restrictive-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>Files underneath the data dir are permissioned <code>700</code></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">ls</span><span class="token plain"> -al /var/lib/etcd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">total </span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">drwxr-xr-x  </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token plain"> root root </span><span class="token number" style="color:rgb(247, 140, 108)">4096</span><span class="token plain"> Nov </span><span class="token number" style="color:rgb(247, 140, 108)">14</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">17</span><span class="token plain">:06 </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">drwxr-xr-x </span><span class="token number" style="color:rgb(247, 140, 108)">47</span><span class="token plain"> root root </span><span class="token number" style="color:rgb(247, 140, 108)">4096</span><span class="token plain"> Nov </span><span class="token number" style="color:rgb(247, 140, 108)">14</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">17</span><span class="token plain">:06 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">drwx------  </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain"> root root </span><span class="token number" style="color:rgb(247, 140, 108)">4096</span><span class="token plain"> Nov </span><span class="token number" style="color:rgb(247, 140, 108)">14</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">17</span><span class="token plain">:06 member</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">stat</span><span class="token plain"> -c %a /var/lib/etcd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>755</code></p><p><strong>Result:</strong> Fail</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1412---ensure-that-the-etcd-data-directory-ownership-is-set-to-etcdetcd-scored">1.4.12 - Ensure that the <code>etcd</code> data directory ownership is set to <code>etcd:etcd</code> (Scored)<a href="#1412---ensure-that-the-etcd-data-directory-ownership-is-set-to-etcdetcd-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>The <code>etcd</code> container runs as the <code>root</code> user. The data directory and files are owned by <code>root</code>.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">stat</span><span class="token plain"> -c %U:%G /var/lib/etcd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>root:root</code></p><p><strong>Result:</strong> Fail</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1413---ensure-that-the-file-permissions-for-adminconf-are-set-to-644-or-more-restrictive-scored">1.4.13 - Ensure that the file permissions for <code>admin.conf</code> are set to <code>644</code> or more restrictive (Scored)<a href="#1413---ensure-that-the-file-permissions-for-adminconf-are-set-to-644-or-more-restrictive-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE does not store the kubernetes default kubeconfig credentials file on the nodes.  It&#x27;s presented to user where RKE is run. We recommend that this <code>kube_config_cluster.yml</code> file be kept in secure store.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1414---ensure-that-ownership-of-adminconf-is-set-to-rootroot-scored">1.4.14 - Ensure that ownership of <code>admin.conf</code> is set to <code>root:root</code> (Scored)<a href="#1414---ensure-that-ownership-of-adminconf-is-set-to-rootroot-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE does not store the default <code>kubectl</code> config credentials file on the nodes.  It presents credentials to the user when <code>rke</code> is first run, and only on the device where the user ran the command. Rancher Labs recommends that this <code>kube_config_cluster.yml</code> file be kept in secure store.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1415---ensure-that-the-file-permissions-for-schedulerconf-are-set-to-644-or-more-restrictive-scored">1.4.15 - Ensure that the file permissions for <code>scheduler.conf</code> are set to <code>644</code> or more restrictive (Scored)<a href="#1415---ensure-that-the-file-permissions-for-schedulerconf-are-set-to-644-or-more-restrictive-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">stat</span><span class="token plain"> -c %a /etc/kubernetes/ssl/kubecfg-kube-scheduler.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>644</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1416---ensure-that-the-file-ownership-of-schedulerconf-is-set-to-rootroot-scored">1.4.16 - Ensure that the file ownership of <code>scheduler.conf</code> is set to <code>root:root</code> (Scored)<a href="#1416---ensure-that-the-file-ownership-of-schedulerconf-is-set-to-rootroot-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">stat</span><span class="token plain"> -c %U:%G /etc/kubernetes/ssl/kubecfg-kube-scheduler.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>root:root</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1417---ensure-that-the-file-permissions-for-controller-managerconf-are-set-to-644-or-more-restrictive-scored">1.4.17 - Ensure that the file permissions for <code>controller-manager.conf</code> are set to <code>644</code> or more restrictive (Scored)<a href="#1417---ensure-that-the-file-permissions-for-controller-managerconf-are-set-to-644-or-more-restrictive-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">stat</span><span class="token plain"> -c %a /etc/kubernetes/ssl/kubecfg-kube-controller-manager.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>644</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1418---ensure-that-the-file-ownership-of-controller-managerconf-is-set-to-rootroot-scored">1.4.18 - Ensure that the file ownership of <code>controller-manager.conf</code> is set to <code>root:root</code> (Scored)<a href="#1418---ensure-that-the-file-ownership-of-controller-managerconf-is-set-to-rootroot-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">stat</span><span class="token plain"> -c %U:%G /etc/kubernetes/ssl/kubecfg-kube-controller-manager.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>root:root</code></p><p><strong>Result:</strong> Pass</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="15---etcd">1.5 - etcd<a href="#15---etcd" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="151---ensure-that-the---cert-file-and---key-file-arguments-are-set-as-appropriate-scored">1.5.1 - Ensure that the <code>--cert-file</code> and <code>--key-file</code> arguments are set as appropriate (Scored)<a href="#151---ensure-that-the---cert-file-and---key-file-arguments-are-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong> <code>(--cert-file</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect etcd </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--cert-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--cert-file=/etc/kubernetes/ssl/kube-etcd-172-31-22-135.pem</code></p><p><strong>Audit</strong> (<code>--key-file</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect etcd </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--key-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--key-file=/etc/kubernetes/ssl/kube-etcd-172-31-22-135-key.pem</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="152---ensure-that-the---client-cert-auth-argument-is-set-to-true-scored">1.5.2 - Ensure that the <code>--client-cert-auth</code> argument is set to <code>true</code> (Scored)<a href="#152---ensure-that-the---client-cert-auth-argument-is-set-to-true-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>Setting &quot;--client-cert-auth&quot; is the equivalent of setting &quot;--client-cert-auth=true&quot;.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect etcd </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--client-cert-auth(=true)*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--client-cert-auth</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="153---ensure-that-the---auto-tls-argument-is-not-set-to-true-scored">1.5.3 - Ensure that the <code>--auto-tls</code> argument is not set to <code>true</code> (Scored)<a href="#153---ensure-that-the---auto-tls-argument-is-not-set-to-true-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect etcd </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--auto-tls(?:(?!=false).*)&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="154---ensure-that-the---peer-cert-file-and---peer-key-file-arguments-are-set-as-appropriate-scored">1.5.4 - Ensure that the <code>--peer-cert-file</code> and <code>--peer-key-file</code> arguments are set as appropriate (Scored)<a href="#154---ensure-that-the---peer-cert-file-and---peer-key-file-arguments-are-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong> (<code>--peer-cert-file</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect etcd </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--peer-cert-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--peer-cert-file=/etc/kubernetes/ssl/kube-etcd-172-31-22-135.pem</code></p><p><strong>Audit</strong> (<code>--peer-key-file</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect etcd </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--peer-key-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--peer-key-file=/etc/kubernetes/ssl/kube-etcd-172-31-22-135-key.pem</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="155---ensure-that-the---peer-client-cert-auth-argument-is-set-to-true-scored">1.5.5 - Ensure that the <code>--peer-client-cert-auth</code> argument is set to <code>true</code> (Scored)<a href="#155---ensure-that-the---peer-client-cert-auth-argument-is-set-to-true-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>Setting <code>--peer-client-cert-auth</code> is the equivalent of setting <code>--peer-client-cert-auth=true</code>.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect etcd </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--peer-client-cert-auth(=true)*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--client-cert-auth</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="156---ensure-that-the---peer-auto-tls-argument-is-not-set-to-true-scored">1.5.6 - Ensure that the <code>--peer-auto-tls</code> argument is not set to <code>true</code> (Scored)<a href="#156---ensure-that-the---peer-auto-tls-argument-is-not-set-to-true-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect etcd </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--peer-auto-tls(?:(?!=false).*)&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="157---ensure-that-a-unique-certificate-authority-is-used-for-etcd-not-scored">1.5.7 - Ensure that a unique Certificate Authority is used for <code>etcd</code> (Not Scored)<a href="#157---ensure-that-a-unique-certificate-authority-is-used-for-etcd-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE does not currently implement a separate CA for etcd certificates.</p><p><code>--trusted-ca-file</code> is set and different from the <code>--client-ca-file</code> used by <code>kube-apiserver</code>.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect etcd </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--trusted-ca-file=(?:(?!/etc/kubernetes/ssl/kube-ca.pem).*)&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Fail</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="16---general-security-primitives">1.6 - General Security Primitives<a href="#16---general-security-primitives" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p>These &quot;Not Scored&quot; controls are implementation best practices. To ease the administrative burden, we recommend that you implement these best practices on your workload clusters by creating clusters with Rancher rather than using RKE alone.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="161---ensure-that-the-cluster-admin-role-is-only-used-where-required-not-scored">1.6.1 - Ensure that the cluster-admin role is only used where required (Not Scored)<a href="#161---ensure-that-the-cluster-admin-role-is-only-used-where-required-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p>Rancher has built in support for maintaining and enforcing Kubernetes RBAC on your workload clusters.</p><p>Rancher has the ability integrate with external authentication sources (LDAP, SAML, AD…) allows easy access with unique credentials to your existing users or groups.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="162---create-administrative-boundaries-between-resources-using-namespaces-not-scored">1.6.2 - Create administrative boundaries between resources using namespaces (Not Scored)<a href="#162---create-administrative-boundaries-between-resources-using-namespaces-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p>With Rancher, users or groups can be assigned access to all clusters, a single cluster or a &quot;Project&quot; (a group of one or more namespaces in a cluster). This allows granular access control to cluster resources.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="163---create-network-segmentation-using-network-policies-not-scored">1.6.3 - Create network segmentation using Network Policies (Not Scored)<a href="#163---create-network-segmentation-using-network-policies-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p>Rancher can (optionally) automatically create Network Policies to isolate &quot;Projects&quot; (a group of one or more namespaces) in a cluster.</p><p>See &quot;Cluster Options&quot; when creating a cluster with Rancher to turn on Network Isolation.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="164---ensure-that-the-seccomp-profile-is-set-to-dockerdefault-in-your-pod-definitions-not-scored">1.6.4 - Ensure that the <code>seccomp</code> profile is set to <code>docker/default</code> in your pod definitions (Not Scored)<a href="#164---ensure-that-the-seccomp-profile-is-set-to-dockerdefault-in-your-pod-definitions-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p>Since this requires the enabling of AllAlpha feature gates we would not recommend enabling this feature at the moment.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="165---apply-security-context-to-your-pods-and-containers-not-scored">1.6.5 - Apply security context to your pods and containers (Not Scored)<a href="#165---apply-security-context-to-your-pods-and-containers-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p>This practice does go against control 1.1.13, but we prefer using <code>PodSecurityPolicy</code> and allowing security context to be set over a blanket deny.</p><p>Rancher allows users to set various Security Context options when launching pods via the GUI interface.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="166---configure-image-provenance-using-the-imagepolicywebhook-admission-controller-not-scored">1.6.6 - Configure image provenance using the <code>ImagePolicyWebhook</code> admission controller (Not Scored)<a href="#166---configure-image-provenance-using-the-imagepolicywebhook-admission-controller-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p>Image Policy Webhook requires a 3rd party service to enforce policy. This can be configured in the <code>--admission-control-config-file</code>.  See the Host configuration section for the admission.yaml file.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="167---configure-network-policies-as-appropriate-not-scored">1.6.7 - Configure network policies as appropriate (Not Scored)<a href="#167---configure-network-policies-as-appropriate-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p>Rancher can (optionally) automatically create Network Policies to isolate projects (a group of one or more namespaces) within a cluster.</p><p>See the <em>Cluster Options</em> section when creating a cluster with Rancher to turn on network isolation.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="168---place-compensating-controls-in-the-form-of-podsecuritypolicy-psp-and-rbac-for-privileged-container-usage-not-scored">1.6.8 - Place compensating controls in the form of PodSecurityPolicy (PSP) and RBAC for privileged container usage (Not Scored)<a href="#168---place-compensating-controls-in-the-form-of-podsecuritypolicy-psp-and-rbac-for-privileged-container-usage-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p>Section 1.7 of this guide shows how to add and configure a default &quot;restricted&quot; PSP based on controls.</p><p>With Rancher you can create a centrally maintained &quot;restricted&quot; PSP and deploy it to all of the clusters that Rancher manages.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="17---pod-security-policies-psp">1.7 - Pod Security Policies (PSP)<a href="#17---pod-security-policies-psp" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p>This RKE configuration has two Pod Security Policies.</p><ul><li><code>default-psp</code>: assigned to namespaces that require additional privileged access:  <code>kube-system</code>, <code>ingress-nginx</code> and <code>cattle-system</code>.</li><li><code>restricted</code>: This is the cluster default PSP and follows the best practices defined by controls in this section.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="171---do-not-admit-privileged-containers-not-scored">1.7.1 - Do not admit privileged containers (Not Scored)<a href="#171---do-not-admit-privileged-containers-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>The restricted PodSecurityPolicy (PSP) is available to all ServiceAccounts.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get psp restricted -o </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{.spec.privileged}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="172---do-not-admit-containers-wishing-to-share-the-host-process-id-namespace-scored">1.7.2 - Do not admit containers wishing to share the host process ID namespace (Scored)<a href="#172---do-not-admit-containers-wishing-to-share-the-host-process-id-namespace-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>The restricted PodSecurityPolicy (PSP) is available to all ServiceAccounts.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get psp restricted -o </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{.spec.hostPID}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="173---do-not-admit-containers-wishing-to-share-the-host-ipc-namespace-scored">1.7.3 - Do not admit containers wishing to share the host IPC namespace (Scored)<a href="#173---do-not-admit-containers-wishing-to-share-the-host-ipc-namespace-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>The restricted PodSecurityPolicy (PSP) is available to all ServiceAccounts.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get psp restricted -o </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{.spec.hostIPC}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="174---do-not-admit-containers-wishing-to-share-the-host-network-namespace-scored">1.7.4 - Do not admit containers wishing to share the host network namespace (Scored)<a href="#174---do-not-admit-containers-wishing-to-share-the-host-network-namespace-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>The restricted PodSecurityPolicy (PSP) is available to all ServiceAccounts.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get psp restricted -o </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{.spec.hostNetwork}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="175---do-not-admit-containers-with-allowprivilegeescalation-scored">1.7.5 - Do not admit containers with <code>allowPrivilegeEscalation</code> (Scored)<a href="#175---do-not-admit-containers-with-allowprivilegeescalation-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>The restricted PodSecurityPolicy (PSP) is available to all ServiceAccounts.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get psp restricted -o </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{.spec.allowPrivilegeEscalation}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;true&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="176---do-not-admit-containers-whose-processes-run-as-root-not-scored">1.7.6 - Do not admit containers whose processes run as <code>root</code> (Not Scored)<a href="#176---do-not-admit-containers-whose-processes-run-as-root-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>The restricted PodSecurityPolicy (PSP) is available to all ServiceAccounts.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get psp restricted -o </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{.spec.runAsUser.rule}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;RunAsAny&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="177---do-not-admit-containers-with-dangerous-capabilities-not-scored">1.7.7 - Do not admit containers with dangerous capabilities (Not Scored)<a href="#177---do-not-admit-containers-with-dangerous-capabilities-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>The restricted PodSecurityPolicy (PSP) is available to all ServiceAccounts.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get psp restricted -o </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">jsonpath</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{.spec.requiredDropCapabilities}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">grep</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;NET_RAW&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>[NET_RAW]</code></p><p><strong>Result:</strong> Pass</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2---worker-node-security-configuration">2 - Worker Node Security Configuration<a href="#2---worker-node-security-configuration" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="21---kubelet">2.1 - Kubelet<a href="#21---kubelet" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="211---ensure-that-the---allow-privileged-argument-is-set-to-false-scored">2.1.1 - Ensure that the <code>--allow-privileged</code> argument is set to false (Scored)<a href="#211---ensure-that-the---allow-privileged-argument-is-set-to-false-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>The <code>--allow-privileged</code> argument is deprecated from Kubernetes v1.11, and the default setting is <code>true</code> with the intention that users should use <code>PodSecurityPolicy</code> settings to allow or prevent privileged containers.</p><p>Our RKE configuration uses <code>PodSecurityPolicy</code> with a default policy to reject privileged containers.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="212---ensure-that-the---anonymous-auth-argument-is-set-to-false-scored">2.1.2 - Ensure that the <code>--anonymous-auth</code> argument is set to <code>false</code> (Scored)<a href="#212---ensure-that-the---anonymous-auth-argument-is-set-to-false-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--anonymous-auth=false&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--anonymous-auth=false</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="213---ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-scored">2.1.3 - Ensure that the <code>--authorization-mode</code> argument is not set to <code>AlwaysAllow</code> (Scored)<a href="#213---ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE currently runs the kubelet without the <code>--authorization-mode</code> flag.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--authorization-mode=Webhook&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Fail</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="214---ensure-that-the---client-ca-file-argument-is-set-as-appropriate-scored">2.1.4 - Ensure that the <code>--client-ca-file</code> argument is set as appropriate (Scored)<a href="#214---ensure-that-the---client-ca-file-argument-is-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--client-ca-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--client-ca-file=/etc/kubernetes/ssl/kube-ca.pem</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="215---ensure-that-the---read-only-port-argument-is-set-to-0-scored">2.1.5 - Ensure that the <code>--read-only-port</code> argument is set to <code>0</code> (Scored)<a href="#215---ensure-that-the---read-only-port-argument-is-set-to-0-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--read-only-port=0&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--read-only-port=0</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="216---ensure-that-the---streaming-connection-idle-timeout-argument-is-not-set-to-0-scored">2.1.6 - Ensure that the <code>--streaming-connection-idle-timeout</code> argument is not set to <code>0</code> (Scored)<a href="#216---ensure-that-the---streaming-connection-idle-timeout-argument-is-not-set-to-0-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--streaming-connection-idle-timeout=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--streaming-connection-idle-timeout=1800s</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="217---ensure-that-the---protect-kernel-defaults-argument-is-set-to-true-scored">2.1.7 - Ensure that the <code>--protect-kernel-defaults</code> argument is set to <code>true</code> (Scored)<a href="#217---ensure-that-the---protect-kernel-defaults-argument-is-set-to-true-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--protect-kernel-defaults=true&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--protect-kernel-defaults=true</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="218---ensure-that-the---make-iptables-util-chains-argument-is-set-to-true-scored">2.1.8 - Ensure that the <code>--make-iptables-util-chains</code> argument is set to <code>true</code> (Scored)<a href="#218---ensure-that-the---make-iptables-util-chains-argument-is-set-to-true-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--make-iptables-util-chains=true&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--make-iptables-util-chains=true</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="219---ensure-that-the---hostname-override-argument-is-not-set-scored">2.1.9 - Ensure that the <code>--hostname-override</code> argument is not set (Scored)<a href="#219---ensure-that-the---hostname-override-argument-is-not-set-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--hostname-override=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--hostname-override=&lt;ipv4 address&gt;</code></p><p><strong>Result:</strong> Fail</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2110---ensure-that-the---event-qps-argument-is-set-to-0-scored">2.1.10 - Ensure that the <code>--event-qps</code> argument is set to <code>0</code> (Scored)<a href="#2110---ensure-that-the---event-qps-argument-is-set-to-0-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--event-qps=0&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--event-qps=0</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2111---ensure-that-the---tls-cert-file-and---tls-private-key-file-arguments-are-set-as-appropriate-scored">2.1.11 - Ensure that the <code>--tls-cert-file</code> and <code>--tls-private-key-file</code> arguments are set as appropriate (Scored)<a href="#2111---ensure-that-the---tls-cert-file-and---tls-private-key-file-arguments-are-set-as-appropriate-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE does not set these options and uses the kubelet&#x27;s self generated certificates for TLS communication. These files are located in the default directory (<code>/var/lib/kubelet/pki</code>).</p><p><strong>Audit</strong> (<code>--tls-cert-file</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cert-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Audit</strong> (<code>--tls-private-key-file</code>)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-private-key-file=.*&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2112---ensure-that-the---cadvisor-port-argument-is-set-to-0-scored">2.1.12 - Ensure that the <code>--cadvisor-port</code> argument is set to <code>0</code> (Scored)<a href="#2112---ensure-that-the---cadvisor-port-argument-is-set-to-0-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--cadvisor-port=0&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>--cadvisor-port=0</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2113---ensure-that-the---rotate-certificates-argument-is-not-set-to-false-scored">2.1.13 - Ensure that the <code>--rotate-certificates</code> argument is not set to <code>false</code> (Scored)<a href="#2113---ensure-that-the---rotate-certificates-argument-is-not-set-to-false-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE will enable certificate rotation in version 0.1.12.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--rotate-certificates=true&quot;).string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Fail</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2114---ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-scored">2.1.14 - Ensure that the <code>RotateKubeletServerCertificate</code> argument is set to <code>true</code> (Scored)<a href="#2114---ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE does not yet support certificate rotation. This feature is due for the 0.1.12 release of RKE.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--feature-gates=.*(RotateKubeletServerCertificate=true).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Fail</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2115---ensure-that-the-kubelet-only-makes-use-of-strong-cryptographic-ciphers-not-scored">2.1.15 - Ensure that the kubelet only makes use of strong cryptographic ciphers (Not Scored)<a href="#2115---ensure-that-the-kubelet-only-makes-use-of-strong-cryptographic-ciphers-not-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong> (Allowed Ciphers)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</code></p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</code></p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305</code></p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong></p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong></p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong></p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_RSA_WITH_AES_128_GCM_SHA256).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305</code></p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(TLS_RSA_WITH_AES_256_GCM_SHA384).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>TLS_RSA_WITH_AES_256_GCM_SHA384</code></p><p><strong>Audit</strong> (Disallowed Ciphers)</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(CBC).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> inspect kubelet </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> jq -e </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.[0].Args[] | match(&quot;--tls-cipher-suites=.*(RC4).*&quot;).captures[].string&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>null</code></p><p><strong>Result:</strong> Pass</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="22---configuration-files">2.2 - Configuration Files<a href="#22---configuration-files" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="221---ensure-that-the-permissions-for-kubeletconf-are-set-to-644-or-more-restrictive-scored">2.2.1 - Ensure that the permissions for <code>kubelet.conf</code> are set to <code>644</code> or more restrictive (Scored)<a href="#221---ensure-that-the-permissions-for-kubeletconf-are-set-to-644-or-more-restrictive-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>This is the value of the <code>--kubeconfig</code> option.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">stat</span><span class="token plain"> -c %a /etc/kubernetes/ssl/kubecfg-kube-node.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>644</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="222---ensure-that-the-kubeletconf-file-ownership-is-set-to-rootroot-scored">2.2.2 - Ensure that the kubelet.conf file ownership is set to root:root (Scored)<a href="#222---ensure-that-the-kubeletconf-file-ownership-is-set-to-rootroot-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>This is the value of the <code>--kubeconfig</code> option.</p><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">stat</span><span class="token plain"> -c %U:%G /etc/kubernetes/ssl/kubecfg-kube-node.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>root:root</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="223---ensure-that-the-kubelet-service-file-permissions-are-set-to-644-or-more-restrictive-scored">2.2.3 - Ensure that the kubelet service file permissions are set to <code>644</code> or more restrictive (Scored)<a href="#223---ensure-that-the-kubelet-service-file-permissions-are-set-to-644-or-more-restrictive-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE doesn&#x27;t require or maintain a configuration file for kubelet. All configuration is passed in as arguments at container run time.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="224---ensure-that-the-kubelet-service-file-ownership-is-set-to-rootroot-scored">2.2.4 - Ensure that the kubelet service file ownership is set to <code>root:root</code> (Scored)<a href="#224---ensure-that-the-kubelet-service-file-ownership-is-set-to-rootroot-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE doesn&#x27;t require or maintain a configuration file for kubelet. All configuration is passed in as arguments at container run time.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="225---ensure-that-the-proxy-kubeconfig-file-permissions-are-set-to-644-or-more-restrictive-scored">2.2.5 - Ensure that the proxy kubeconfig file permissions are set to <code>644</code> or more restrictive (Scored)<a href="#225---ensure-that-the-proxy-kubeconfig-file-permissions-are-set-to-644-or-more-restrictive-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">stat</span><span class="token plain"> -c %a /etc/kubernetes/ssl/kubecfg-kube-proxy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>644</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="226---ensure-that-the-proxy-kubeconfig-file-ownership-is-set-to-rootroot-scored">2.2.6 - Ensure that the proxy kubeconfig file ownership is set to <code>root:root</code> (Scored)<a href="#226---ensure-that-the-proxy-kubeconfig-file-ownership-is-set-to-rootroot-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">stat</span><span class="token plain"> -c %U:%G /etc/kubernetes/ssl/kubecfg-kube-proxy.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>root:root</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="227---ensure-that-the-certificate-authorities-file-permissions-are-set-to-644-or-more-restrictive-scored">2.2.7 - Ensure that the certificate authorities file permissions are set to <code>644</code> or more restrictive (Scored)<a href="#227---ensure-that-the-certificate-authorities-file-permissions-are-set-to-644-or-more-restrictive-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">stat</span><span class="token plain"> -c %a /etc/kubernetes/ssl/kube-ca.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>644</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="228---ensure-that-the-client-certificate-authorities-file-ownership-is-set-to-rootroot-scored">2.2.8 - Ensure that the client certificate authorities file ownership is set to <code>root:root</code> (Scored)<a href="#228---ensure-that-the-client-certificate-authorities-file-ownership-is-set-to-rootroot-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Audit</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">stat</span><span class="token plain"> -c %U:%G /etc/kubernetes/ssl/kube-ca.pem</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Returned Value:</strong> <code>root:root</code></p><p><strong>Result:</strong> Pass</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="229---ensure-that-the-kubelet-configuration-file-ownership-is-set-to-rootroot-scored">2.2.9 - Ensure that the kubelet configuration file ownership is set to <code>root:root</code> (Scored)<a href="#229---ensure-that-the-kubelet-configuration-file-ownership-is-set-to-rootroot-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE doesn&#x27;t require or maintain a configuration file for kubelet. All configuration is passed in as arguments at container run time.</p><p><strong>Result:</strong> Pass (Not Applicable)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2210---ensure-that-the-kubelet-configuration-file-permissions-are-set-to-644-or-more-restrictive-scored">2.2.10 - Ensure that the kubelet configuration file permissions are set to <code>644</code> or more restrictive (Scored)<a href="#2210---ensure-that-the-kubelet-configuration-file-permissions-are-set-to-644-or-more-restrictive-scored" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p><strong>Notes</strong></p><p>RKE doesn&#x27;t require or maintain a configuration file for kubelet. All configuration is passed in as arguments at container run time.</p><p><strong>Result:</strong> Pass (Not Applicable)</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.0-2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides/self-assessment-guide-with-cis-v1.3-benchmark.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">最后<!-- -->于 <b><time datetime="2022-09-23T17:11:24.000Z">2022年9月23日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Rancher v2.1</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.1-hardening-guides/hardening-guide-with-cis-v1.3-benchmark"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Hardening Guide v2.1</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#controls" class="table-of-contents__link toc-highlight">Controls</a></li><li><a href="#1---master-node-security-configuration" class="table-of-contents__link toc-highlight">1 - Master Node Security Configuration</a><ul><li><a href="#11---api-server" class="table-of-contents__link toc-highlight">1.1 - API Server</a></li><li><a href="#12---scheduler" class="table-of-contents__link toc-highlight">1.2 - Scheduler</a></li><li><a href="#13---controller-manager" class="table-of-contents__link toc-highlight">1.3 - Controller Manager</a></li><li><a href="#14---configuration-files" class="table-of-contents__link toc-highlight">1.4 - Configuration Files</a></li><li><a href="#15---etcd" class="table-of-contents__link toc-highlight">1.5 - etcd</a></li></ul></li><li><a href="#2---worker-node-security-configuration" class="table-of-contents__link toc-highlight">2 - Worker Node Security Configuration</a><ul><li><a href="#21---kubelet" class="table-of-contents__link toc-highlight">2.1 - Kubelet</a></li><li><a href="#22---configuration-files" class="table-of-contents__link toc-highlight">2.2 - Configuration Files</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/zh/assets/js/runtime~main.f9ac86ca.js"></script>
<script src="/zh/assets/js/main.d6cf12b1.js"></script>
</body>
</html>