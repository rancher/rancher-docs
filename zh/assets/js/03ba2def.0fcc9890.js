"use strict";(self.webpackChunkrancher_docs=self.webpackChunkrancher_docs||[]).push([[57526],{3905:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return k}});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),p=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},u=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=p(r),k=a,m=d["".concat(l,".").concat(k)]||d[k]||c[k]||s;return r?n.createElement(m,o(o({ref:t},u),{},{components:r})):n.createElement(m,o({ref:t},u))}));function k(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=r.length,o=new Array(s);o[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:a,o[1]=i;for(var p=2;p<s;p++)o[p]=r[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},14858:function(e,t,r){r.r(t),r.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return k},frontMatter:function(){return i},metadata:function(){return p},toc:function(){return c}});var n=r(87462),a=r(63366),s=(r(67294),r(3905)),o=["components"],i={title:"CIS Benchmark Rancher Self-Assessment Guide v2.2",weight:208,aliases:["/rancher/v2.0-v2.4/en/security/benchmark-2.2","/rancher/v2.x/en/security/rancher-2.2/benchmark-2.2/"]},l=void 0,p={unversionedId:"reference-guides/rancher-security/rancher-v2.2-hardening-guides/self-assessment-guide-with-cis-v1.4-benchmark",id:"version-2.0-2.4/reference-guides/rancher-security/rancher-v2.2-hardening-guides/self-assessment-guide-with-cis-v1.4-benchmark",title:"CIS Benchmark Rancher Self-Assessment Guide v2.2",description:"This document is a companion to the Rancher v2.2 security hardening guide. The hardening guide provides prescriptive guidance for hardening a production installation of Rancher, and this benchmark guide is meant to help you evaluate the level of security of the hardened cluster against each control in the benchmark.",source:"@site/versioned_docs/version-2.0-2.4/reference-guides/rancher-security/rancher-v2.2-hardening-guides/self-assessment-guide-with-cis-v1.4-benchmark.md",sourceDirName:"reference-guides/rancher-security/rancher-v2.2-hardening-guides",slug:"/reference-guides/rancher-security/rancher-v2.2-hardening-guides/self-assessment-guide-with-cis-v1.4-benchmark",permalink:"/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.2-hardening-guides/self-assessment-guide-with-cis-v1.4-benchmark",draft:!1,editUrl:"https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.0-2.4/reference-guides/rancher-security/rancher-v2.2-hardening-guides/self-assessment-guide-with-cis-v1.4-benchmark.md",tags:[],version:"2.0-2.4",lastUpdatedAt:1663710212,formattedLastUpdatedAt:"2022/9/20",frontMatter:{title:"CIS Benchmark Rancher Self-Assessment Guide v2.2",weight:208,aliases:["/rancher/v2.0-v2.4/en/security/benchmark-2.2","/rancher/v2.x/en/security/rancher-2.2/benchmark-2.2/"]},sidebar:"tutorialSidebar",previous:{title:"Rancher v2.2",permalink:"/zh/v2.0-v2.4/pages-for-subheaders/rancher-v2.2-hardening-guides"},next:{title:"Hardening Guide v2.2",permalink:"/zh/v2.0-v2.4/reference-guides/rancher-security/rancher-v2.2-hardening-guides/hardening-guide-with-cis-v1.4-benchmark"}},u={},c=[{value:"CIS Kubernetes Benchmark 1.4.0 - Rancher 2.2.x with Kubernetes 1.13",id:"cis-kubernetes-benchmark-140---rancher-22x-with-kubernetes-113",level:3},{value:"CIS Kubernetes Benchmark 1.4.1 - Rancher 2.2.x with Kubernetes 1.13",id:"cis-kubernetes-benchmark-141---rancher-22x-with-kubernetes-113",level:3},{value:"Testing controls methodology",id:"testing-controls-methodology",level:4},{value:"Known Scored Control Failures",id:"known-scored-control-failures",level:4},{value:"Controls",id:"controls",level:3},{value:"1 - Master Node Security Configuration",id:"1---master-node-security-configuration",level:2},{value:"1.1 - API Server",id:"11---api-server",level:3},{value:"1.1.1 - Ensure that the <code>--anonymous-auth</code> argument is set to <code>false</code> (Scored)",id:"111---ensure-that-the---anonymous-auth-argument-is-set-to-false-scored",level:4},{value:"1.1.2 - Ensure that the <code>--basic-auth-file</code> argument is not set (Scored)",id:"112---ensure-that-the---basic-auth-file-argument-is-not-set-scored",level:4},{value:"1.1.3 - Ensure that the <code>--insecure-allow-any-token</code> argument is not set (Scored)",id:"113---ensure-that-the---insecure-allow-any-token-argument-is-not-set-scored",level:4},{value:"1.1.4 - Ensure that the <code>--kubelet-https</code> argument is set to <code>true</code> (Scored)",id:"114---ensure-that-the---kubelet-https-argument-is-set-to-true-scored",level:4},{value:"1.1.5 - Ensure that the <code>--insecure-bind-address</code> argument is not set (Scored)",id:"115---ensure-that-the---insecure-bind-address-argument-is-not-set-scored",level:4},{value:"1.1.6 - Ensure that the <code>--insecure-port argument</code> is set to <code>0</code> (Scored)",id:"116---ensure-that-the---insecure-port-argument-is-set-to-0-scored",level:4},{value:"1.1.7 - Ensure that the <code>--secure-port</code> argument is not set to <code>0</code> (Scored)",id:"117---ensure-that-the---secure-port-argument-is-not-set-to-0-scored",level:4},{value:"1.1.8 - Ensure that the <code>--profiling</code> argument is set to <code>false</code> (Scored)",id:"118---ensure-that-the---profiling-argument-is-set-to-false-scored",level:4},{value:"1.1.9 - Ensure that the <code>--repair-malformed-updates</code> argument is set to <code>false</code> (Scored)",id:"119---ensure-that-the---repair-malformed-updates-argument-is-set-to-false-scored",level:4},{value:"1.1.10 - Ensure that the admission control plugin <code>AlwaysAdmit</code> is not set (Scored)",id:"1110---ensure-that-the-admission-control-plugin-alwaysadmit-is-not-set-scored",level:4},{value:"1.1.11 - Ensure that the admission control plugin <code>AlwaysPullImages</code> is set (Scored)",id:"1111---ensure-that-the-admission-control-plugin-alwayspullimages-is-set-scored",level:4},{value:"1.1.12 - Ensure that the admission control plugin <code>DenyEscalatingExec</code> is set (Scored)",id:"1112---ensure-that-the-admission-control-plugin-denyescalatingexec-is-set-scored",level:4},{value:"1.1.13 - Ensure that the admission control plugin <code>SecurityContextDeny</code> is set (Not Scored)",id:"1113---ensure-that-the-admission-control-plugin-securitycontextdeny-is-set-not-scored",level:4},{value:"1.1.14 - Ensure that the admission control plugin <code>NamespaceLifecycle</code> is set (Scored)",id:"1114---ensure-that-the-admission-control-plugin-namespacelifecycle-is-set-scored",level:4},{value:"1.1.15 - Ensure that the <code>--audit-log-path</code> argument is set as appropriate (Scored)",id:"1115---ensure-that-the---audit-log-path-argument-is-set-as-appropriate-scored",level:4},{value:"1.1.16 - Ensure that the <code>--audit-log-maxage</code> argument is set to <code>30</code> or as appropriate (Scored)",id:"1116---ensure-that-the---audit-log-maxage-argument-is-set-to-30-or-as-appropriate-scored",level:4},{value:"1.1.17 - Ensure that the <code>--audit-log-maxbackup</code> argument is set to <code>10</code> or as appropriate (Scored)",id:"1117---ensure-that-the---audit-log-maxbackup-argument-is-set-to-10-or-as-appropriate-scored",level:4},{value:"1.1.18 - Ensure that the <code>--audit-log-maxsize</code> argument is set to <code>100</code> or as appropriate (Scored)",id:"1118---ensure-that-the---audit-log-maxsize-argument-is-set-to-100-or-as-appropriate-scored",level:4},{value:"1.1.19 - Ensure that the <code>--authorization-mode</code> argument is not set to <code>AlwaysAllow</code> (Scored)",id:"1119---ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-scored",level:4},{value:"1.1.20 - Ensure that the <code>--token-auth-file</code> parameter is not set (Scored)",id:"1120---ensure-that-the---token-auth-file-parameter-is-not-set-scored",level:4},{value:"1.1.21 - Ensure that the <code>--kubelet-certificate-authority</code> argument is set as appropriate (Scored)",id:"1121---ensure-that-the---kubelet-certificate-authority-argument-is-set-as-appropriate-scored",level:4},{value:"1.1.22 - Ensure that the <code>--kubelet-client-certificate</code> and <code>--kubelet-client-key</code> arguments are set as appropriate (Scored)",id:"1122---ensure-that-the---kubelet-client-certificate-and---kubelet-client-key-arguments-are-set-as-appropriate-scored",level:4},{value:"1.1.23 Ensure that the <code>--service-account-lookup</code> argument is set to <code>true</code> (Scored)",id:"1123-ensure-that-the---service-account-lookup-argument-is-set-to-true-scored",level:4},{value:"1.1.24 - Ensure that the admission control plugin <code>PodSecurityPolicy</code> is set (Scored)",id:"1124---ensure-that-the-admission-control-plugin-podsecuritypolicy-is-set-scored",level:4},{value:"1.1.25 - Ensure that the <code>--service-account-key-file</code> argument is set as appropriate (Scored)",id:"1125---ensure-that-the---service-account-key-file-argument-is-set-as-appropriate-scored",level:4},{value:"1.1.26 - Ensure that the <code>--etcd-certfile</code> and <code>--etcd-keyfile</code> arguments are set as appropriate (Scored)",id:"1126---ensure-that-the---etcd-certfile-and---etcd-keyfile-arguments-are-set-as-appropriate-scored",level:4},{value:"1.1.27 - Ensure that the admission control plugin <code>ServiceAccount</code> is set (Scored)",id:"1127---ensure-that-the-admission-control-plugin-serviceaccount-is-set-scored",level:4},{value:"1.1.28 - Ensure that the <code>--tls-cert-file</code> and <code>--tls-private-key-file</code> arguments are set as appropriate (Scored)",id:"1128---ensure-that-the---tls-cert-file-and---tls-private-key-file-arguments-are-set-as-appropriate-scored",level:4},{value:"1.1.29 - Ensure that the <code>--client-ca-file</code> argument is set as appropriate (Scored)",id:"1129---ensure-that-the---client-ca-file-argument-is-set-as-appropriate-scored",level:4},{value:"1.1.30 - Ensure that the API Server only makes use of strong cryptographic ciphers (Not Scored)",id:"1130---ensure-that-the-api-server-only-makes-use-of-strong-cryptographic-ciphers-not-scored",level:4},{value:"1.1.31 - Ensure that the <code>--etcd-cafile</code> argument is set as appropriate (Scored)",id:"1131---ensure-that-the---etcd-cafile-argument-is-set-as-appropriate-scored",level:4},{value:"1.1.32 - Ensure that the <code>--authorization-mode</code> argument includes Node (Scored)",id:"1132---ensure-that-the---authorization-mode-argument-includes-node-scored",level:4},{value:"1.1.33 - Ensure that the admission control plugin <code>NodeRestriction</code> is set (Scored)",id:"1133---ensure-that-the-admission-control-plugin-noderestriction-is-set-scored",level:4},{value:"1.1.34 - Ensure that the <code>--experimental-encryption-provider-config</code> argument is set as appropriate (Scored)",id:"1134---ensure-that-the---experimental-encryption-provider-config-argument-is-set-as-appropriate-scored",level:4},{value:"1.1.35 - Ensure that the encryption provider is set to aescbc (Scored)",id:"1135---ensure-that-the-encryption-provider-is-set-to-aescbc-scored",level:4},{value:"1.1.36 - Ensure that the admission control plugin <code>EventRateLimit</code> is set (Scored)",id:"1136---ensure-that-the-admission-control-plugin-eventratelimit-is-set-scored",level:4},{value:"1.1.37 Ensure that the AdvancedAuditing argument is not set to false (Scored)",id:"1137-ensure-that-the-advancedauditing-argument-is-not-set-to-false-scored",level:4},{value:"1.1.38 Ensure that the <code>--request-timeout</code> argument is set as appropriate (Scored)",id:"1138-ensure-that-the---request-timeout-argument-is-set-as-appropriate-scored",level:4},{value:"Ensure that the --authorization-mode argument includes RBAC (Scored)",id:"ensure-that-the---authorization-mode-argument-includes-rbac-scored",level:4},{value:"1.2 - Scheduler",id:"12---scheduler",level:3},{value:"1.2.1 - Ensure that the <code>--profiling</code> argument is set to false (Scored)",id:"121---ensure-that-the---profiling-argument-is-set-to-false-scored",level:4},{value:"1.2.2 - Ensure that the <code>--address</code> argument is set to 127.0.0.1 (Scored)",id:"122---ensure-that-the---address-argument-is-set-to-127001-scored",level:4},{value:"1.3 - Controller Manager",id:"13---controller-manager",level:3},{value:"1.3.1 - Ensure that the <code>--terminated-pod-gc-threshold</code> argument is set as appropriate (Scored)",id:"131---ensure-that-the---terminated-pod-gc-threshold-argument-is-set-as-appropriate-scored",level:4},{value:"1.3.2 - Ensure that the <code>--profiling</code> argument is set to false (Scored)",id:"132---ensure-that-the---profiling-argument-is-set-to-false-scored",level:4},{value:"1.3.3 - Ensure that the <code>--use-service-account-credentials</code> argument is set to true (Scored)",id:"133---ensure-that-the---use-service-account-credentials-argument-is-set-to-true-scored",level:4},{value:"1.3.4 - Ensure that the <code>--service-account-private-key-file</code> argument is set as appropriate (Scored)",id:"134---ensure-that-the---service-account-private-key-file-argument-is-set-as-appropriate-scored",level:4},{value:"1.3.5 - Ensure that the <code>--root-ca-file</code> argument is set as appropriate (Scored)",id:"135---ensure-that-the---root-ca-file-argument-is-set-as-appropriate-scored",level:4},{value:"1.3.6 - Ensure that the RotateKubeletServerCertificate argument is set to true (Scored)",id:"136---ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-scored",level:4},{value:"1.3.7 - Ensure that the <code>--address</code> argument is set to 127.0.0.1 (Scored)",id:"137---ensure-that-the---address-argument-is-set-to-127001-scored",level:4},{value:"1.4 - Configuration Files",id:"14---configuration-files",level:3},{value:"1.4.1 - Ensure that the API server pod specification file permissions are set to 644 or more restrictive (Scored)",id:"141---ensure-that-the-api-server-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored",level:4},{value:"1.4.2 - Ensure that the API server pod specification file ownership is set to <code>root:root</code> (Scored)",id:"142---ensure-that-the-api-server-pod-specification-file-ownership-is-set-to-rootroot-scored",level:4},{value:"1.4.3 - Ensure that the controller manager pod specification file permissions are set to <code>644</code> or more restrictive (Scored)",id:"143---ensure-that-the-controller-manager-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored",level:4},{value:"1.4.4 - Ensure that the controller manager pod specification file ownership is set to <code>root:root</code> (Scored)",id:"144---ensure-that-the-controller-manager-pod-specification-file-ownership-is-set-to-rootroot-scored",level:4},{value:"1.4.5 - Ensure that the scheduler pod specification file permissions are set to <code>644</code> or more restrictive (Scored)",id:"145---ensure-that-the-scheduler-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored",level:4},{value:"1.4.6 - Ensure that the scheduler pod specification file ownership is set to <code>root:root</code> (Scored)",id:"146---ensure-that-the-scheduler-pod-specification-file-ownership-is-set-to-rootroot-scored",level:4},{value:"1.4.7 - Ensure that the <code>etcd</code> pod specification file permissions are set to <code>644</code> or more restrictive (Scored)",id:"147---ensure-that-the-etcd-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored",level:4},{value:"1.4.8 - Ensure that the <code>etcd</code> pod specification file ownership is set to <code>root:root</code> (Scored)",id:"148---ensure-that-the-etcd-pod-specification-file-ownership-is-set-to-rootroot-scored",level:4},{value:"1.4.9 - Ensure that the Container Network Interface file permissions are set to <code>644</code> or more restrictive (Not Scored)",id:"149---ensure-that-the-container-network-interface-file-permissions-are-set-to-644-or-more-restrictive-not-scored",level:4},{value:"1.4.10 - Ensure that the Container Network Interface file ownership is set to <code>root:root</code> (Not Scored)",id:"1410---ensure-that-the-container-network-interface-file-ownership-is-set-to-rootroot-not-scored",level:4},{value:"1.4.11 - Ensure that the etcd data directory permissions are set to 700 or more restrictive (Scored)",id:"1411---ensure-that-the-etcd-data-directory-permissions-are-set-to-700-or-more-restrictive-scored",level:4},{value:"1.4.12 - Ensure that the <code>etcd</code> data directory ownership is set to <code>etcd:etcd</code> (Scored)",id:"1412---ensure-that-the-etcd-data-directory-ownership-is-set-to-etcdetcd-scored",level:4},{value:"1.4.13 - Ensure that the file permissions for <code>admin.conf</code> are set to <code>644</code> or more restrictive (Scored)",id:"1413---ensure-that-the-file-permissions-for-adminconf-are-set-to-644-or-more-restrictive-scored",level:4},{value:"1.4.14 - Ensure that ownership of <code>admin.conf</code> is set to <code>root:root</code> (Scored)",id:"1414---ensure-that-ownership-of-adminconf-is-set-to-rootroot-scored",level:4},{value:"1.4.15 - Ensure that the file permissions for <code>scheduler.conf</code> are set to <code>644</code> or more restrictive (Scored)",id:"1415---ensure-that-the-file-permissions-for-schedulerconf-are-set-to-644-or-more-restrictive-scored",level:4},{value:"1.4.16 - Ensure that the file ownership of <code>scheduler.conf</code> is set to <code>root:root</code> (Scored)",id:"1416---ensure-that-the-file-ownership-of-schedulerconf-is-set-to-rootroot-scored",level:4},{value:"1.4.17 - Ensure that the file permissions for <code>controller-manager.conf</code> are set to <code>644</code> or more restrictive (Scored)",id:"1417---ensure-that-the-file-permissions-for-controller-managerconf-are-set-to-644-or-more-restrictive-scored",level:4},{value:"1.4.18 - Ensure that the file ownership of <code>controller-manager.conf</code> is set to <code>root:root</code> (Scored)",id:"1418---ensure-that-the-file-ownership-of-controller-managerconf-is-set-to-rootroot-scored",level:4},{value:"1.4.19 - Ensure that the Kubernetes PKI directory and file ownership is set to root:root (Scored)",id:"1419---ensure-that-the-kubernetes-pki-directory-and-file-ownership-is-set-to-rootroot-scored",level:4},{value:"1.4.20 - Ensure that the Kubernetes PKI certificate file permissions are set to <code>644</code> or more restrictive (Scored)",id:"1420---ensure-that-the-kubernetes-pki-certificate-file-permissions-are-set-to-644-or-more-restrictive-scored",level:4},{value:"1.4.21 - Ensure that the Kubernetes PKI key file permissions are set to 600 (Scored)",id:"1421---ensure-that-the-kubernetes-pki-key-file-permissions-are-set-to-600-scored",level:4},{value:"1.5 - etcd",id:"15---etcd",level:3},{value:"1.5.1 - Ensure that the <code>--cert-file</code> and <code>--key-file</code> arguments are set as appropriate (Scored)",id:"151---ensure-that-the---cert-file-and---key-file-arguments-are-set-as-appropriate-scored",level:4},{value:"1.5.2 - Ensure that the <code>--client-cert-auth</code> argument is set to <code>true</code> (Scored)",id:"152---ensure-that-the---client-cert-auth-argument-is-set-to-true-scored",level:4},{value:"1.5.3 - Ensure that the <code>--auto-tls</code> argument is not set to <code>true</code> (Scored)",id:"153---ensure-that-the---auto-tls-argument-is-not-set-to-true-scored",level:4},{value:"1.5.4 - Ensure that the <code>--peer-cert-file</code> and <code>--peer-key-file</code> arguments are set as appropriate (Scored)",id:"154---ensure-that-the---peer-cert-file-and---peer-key-file-arguments-are-set-as-appropriate-scored",level:4},{value:"1.5.5 - Ensure that the <code>--peer-client-cert-auth</code> argument is set to <code>true</code> (Scored)",id:"155---ensure-that-the---peer-client-cert-auth-argument-is-set-to-true-scored",level:4},{value:"1.5.6 - Ensure that the <code>--peer-auto-tls</code> argument is not set to <code>true</code> (Scored)",id:"156---ensure-that-the---peer-auto-tls-argument-is-not-set-to-true-scored",level:4},{value:"1.5.7 - Ensure that a unique Certificate Authority is used for <code>etcd</code> (Not Scored)",id:"157---ensure-that-a-unique-certificate-authority-is-used-for-etcd-not-scored",level:4},{value:"1.6 - General Security Primitives",id:"16---general-security-primitives",level:4},{value:"1.6.1 - Ensure that the cluster-admin role is only used where required (Not Scored)",id:"161---ensure-that-the-cluster-admin-role-is-only-used-where-required-not-scored",level:4},{value:"1.6.2 - Create administrative boundaries between resources using namespaces (Not Scored)",id:"162---create-administrative-boundaries-between-resources-using-namespaces-not-scored",level:4},{value:"1.6.3 - Create network segmentation using Network Policies (Not Scored)",id:"163---create-network-segmentation-using-network-policies-not-scored",level:4},{value:"1.6.4 - Ensure that the <code>seccomp</code> profile is set to <code>docker/default</code> in your pod definitions (Not Scored)",id:"164---ensure-that-the-seccomp-profile-is-set-to-dockerdefault-in-your-pod-definitions-not-scored",level:4},{value:"1.6.5 - Apply security context to your pods and containers (Not Scored)",id:"165---apply-security-context-to-your-pods-and-containers-not-scored",level:4},{value:"1.6.6 - Configure image provenance using the <code>ImagePolicyWebhook</code> admission controller (Not Scored)",id:"166---configure-image-provenance-using-the-imagepolicywebhook-admission-controller-not-scored",level:4},{value:"1.6.7 - Configure network policies as appropriate (Not Scored)",id:"167---configure-network-policies-as-appropriate-not-scored",level:4},{value:"1.6.8 - Place compensating controls in the form of PodSecurityPolicy (PSP) and RBAC for privileged container usage (Not Scored)",id:"168---place-compensating-controls-in-the-form-of-podsecuritypolicy-psp-and-rbac-for-privileged-container-usage-not-scored",level:4},{value:"1.7 - Pod Security Policies (PSP)",id:"17---pod-security-policies-psp",level:4},{value:"1.7.1 - Do not admit privileged containers (Not Scored)",id:"171---do-not-admit-privileged-containers-not-scored",level:4},{value:"1.7.2 - Do not admit containers wishing to share the host process ID namespace (Scored)",id:"172---do-not-admit-containers-wishing-to-share-the-host-process-id-namespace-scored",level:4},{value:"1.7.3 - Do not admit containers wishing to share the host IPC namespace (Scored)",id:"173---do-not-admit-containers-wishing-to-share-the-host-ipc-namespace-scored",level:4},{value:"1.7.4 - Do not admit containers wishing to share the host network namespace (Scored)",id:"174---do-not-admit-containers-wishing-to-share-the-host-network-namespace-scored",level:4},{value:"1.7.5 - Do not admit containers with <code>allowPrivilegeEscalation</code> (Scored)",id:"175---do-not-admit-containers-with-allowprivilegeescalation-scored",level:4},{value:"1.7.6 - Do not admit containers whose processes run as <code>root</code> (Not Scored)",id:"176---do-not-admit-containers-whose-processes-run-as-root-not-scored",level:4},{value:"1.7.7 - Do not admit containers with dangerous capabilities (Not Scored)",id:"177---do-not-admit-containers-with-dangerous-capabilities-not-scored",level:4},{value:"2 - Worker Node Security Configuration",id:"2---worker-node-security-configuration",level:2},{value:"2.1 - Kubelet",id:"21---kubelet",level:3},{value:"2.1.1 - Ensure that the <code>--anonymous-auth</code> argument is set to <code>false</code> (Scored)",id:"211---ensure-that-the---anonymous-auth-argument-is-set-to-false-scored",level:4},{value:"2.1.2 - Ensure that the <code>--authorization-mode</code> argument is not set to <code>AlwaysAllow</code> (Scored)",id:"212---ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-scored",level:4},{value:"2.1.3 - Ensure that the <code>--client-ca-file</code> argument is set as appropriate (Scored)",id:"213---ensure-that-the---client-ca-file-argument-is-set-as-appropriate-scored",level:4},{value:"2.1.4 - Ensure that the <code>--read-only-port</code> argument is set to <code>0</code> (Scored)",id:"214---ensure-that-the---read-only-port-argument-is-set-to-0-scored",level:4},{value:"2.1.5 - Ensure that the <code>--streaming-connection-idle-timeout</code> argument is not set to <code>0</code> (Scored)",id:"215---ensure-that-the---streaming-connection-idle-timeout-argument-is-not-set-to-0-scored",level:4},{value:"2.1.6 - Ensure that the <code>--protect-kernel-defaults</code> argument is set to <code>true</code> (Scored)",id:"216---ensure-that-the---protect-kernel-defaults-argument-is-set-to-true-scored",level:4},{value:"2.1.7 - Ensure that the <code>--make-iptables-util-chains</code> argument is set to <code>true</code> (Scored)",id:"217---ensure-that-the---make-iptables-util-chains-argument-is-set-to-true-scored",level:4},{value:"2.1.8 - Ensure that the <code>--hostname-override</code> argument is not set (Scored)",id:"218---ensure-that-the---hostname-override-argument-is-not-set-scored",level:4},{value:"2.1.9 - Ensure that the <code>--event-qps</code> argument is set to <code>0</code> (Scored)",id:"219---ensure-that-the---event-qps-argument-is-set-to-0-scored",level:4},{value:"2.1.10 - Ensure that the <code>--tls-cert-file</code> and <code>--tls-private-key-file</code> arguments are set as appropriate (Scored)",id:"2110---ensure-that-the---tls-cert-file-and---tls-private-key-file-arguments-are-set-as-appropriate-scored",level:4},{value:"2.1.11 - Ensure that the <code>--cadvisor-port</code> argument is set to <code>0</code> (Scored)",id:"2111---ensure-that-the---cadvisor-port-argument-is-set-to-0-scored",level:4},{value:"2.1.12 - Ensure that the <code>--rotate-certificates</code> argument is not set to <code>false</code> (Scored)",id:"2112---ensure-that-the---rotate-certificates-argument-is-not-set-to-false-scored",level:4},{value:"2.1.13 - Ensure that the <code>RotateKubeletServerCertificate</code> argument is set to <code>true</code> (Scored)",id:"2113---ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-scored",level:4},{value:"2.1.14 - Ensure that the kubelet only makes use of strong cryptographic ciphers (Not Scored)",id:"2114---ensure-that-the-kubelet-only-makes-use-of-strong-cryptographic-ciphers-not-scored",level:4},{value:"2.2 - Configuration Files",id:"22---configuration-files",level:3},{value:"2.2.1 - Ensure that the permissions for <code>kubelet.conf</code> are set to <code>644</code> or more restrictive (Scored)",id:"221---ensure-that-the-permissions-for-kubeletconf-are-set-to-644-or-more-restrictive-scored",level:4},{value:"2.2.2 - Ensure that the kubelet.conf file ownership is set to root:root (Scored)",id:"222---ensure-that-the-kubeletconf-file-ownership-is-set-to-rootroot-scored",level:4},{value:"2.2.3 - Ensure that the kubelet service file permissions are set to <code>644</code> or more restrictive (Scored)",id:"223---ensure-that-the-kubelet-service-file-permissions-are-set-to-644-or-more-restrictive-scored",level:4},{value:"2.2.4 - Ensure that the kubelet service file ownership is set to <code>root:root</code> (Scored)",id:"224---ensure-that-the-kubelet-service-file-ownership-is-set-to-rootroot-scored",level:4},{value:"2.2.5 - Ensure that the proxy kubeconfig file permissions are set to <code>644</code> or more restrictive (Scored)",id:"225---ensure-that-the-proxy-kubeconfig-file-permissions-are-set-to-644-or-more-restrictive-scored",level:4},{value:"2.2.6 - Ensure that the proxy kubeconfig file ownership is set to <code>root:root</code> (Scored)",id:"226---ensure-that-the-proxy-kubeconfig-file-ownership-is-set-to-rootroot-scored",level:4},{value:"2.2.7 - Ensure that the certificate authorities file permissions are set to <code>644</code> or more restrictive (Scored)",id:"227---ensure-that-the-certificate-authorities-file-permissions-are-set-to-644-or-more-restrictive-scored",level:4},{value:"2.2.8 - Ensure that the client certificate authorities file ownership is set to <code>root:root</code> (Scored)",id:"228---ensure-that-the-client-certificate-authorities-file-ownership-is-set-to-rootroot-scored",level:4},{value:"2.2.9 - Ensure that the kubelet configuration file ownership is set to <code>root:root</code> (Scored)",id:"229---ensure-that-the-kubelet-configuration-file-ownership-is-set-to-rootroot-scored",level:4},{value:"2.2.10 - Ensure that the kubelet configuration file permissions are set to <code>644</code> or more restrictive (Scored)",id:"2210---ensure-that-the-kubelet-configuration-file-permissions-are-set-to-644-or-more-restrictive-scored",level:4}],d={toc:c};function k(e){var t=e.components,r=(0,a.Z)(e,o);return(0,s.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"This document is a companion to the Rancher v2.2 security hardening guide. The hardening guide provides prescriptive guidance for hardening a production installation of Rancher, and this benchmark guide is meant to help you evaluate the level of security of the hardened cluster against each control in the benchmark."),(0,s.kt)("p",null,"This guide corresponds to specific versions of the hardening guide, Rancher, Kubernetes, and the CIS Benchmark:"),(0,s.kt)("table",null,(0,s.kt)("thead",{parentName:"table"},(0,s.kt)("tr",{parentName:"thead"},(0,s.kt)("th",{parentName:"tr",align:null},"Self Assessment Guide Version"),(0,s.kt)("th",{parentName:"tr",align:null},"Rancher Version"),(0,s.kt)("th",{parentName:"tr",align:null},"Hardening Guide Version"),(0,s.kt)("th",{parentName:"tr",align:null},"Kubernetes Version"),(0,s.kt)("th",{parentName:"tr",align:null},"CIS Benchmark Version"))),(0,s.kt)("tbody",{parentName:"table"},(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"Self Assessment Guide v2.2"),(0,s.kt)("td",{parentName:"tr",align:null},"Rancher v2.2.x"),(0,s.kt)("td",{parentName:"tr",align:null},"Hardening Guide v2.2"),(0,s.kt)("td",{parentName:"tr",align:null},"Kubernetes 1.13"),(0,s.kt)("td",{parentName:"tr",align:null},"Benchmark v1.4.0 and v1.4.1")))),(0,s.kt)("h3",{id:"cis-kubernetes-benchmark-140---rancher-22x-with-kubernetes-113"},"CIS Kubernetes Benchmark 1.4.0 - Rancher 2.2.x with Kubernetes 1.13"),(0,s.kt)("p",null,"There is no material difference in control verification checks between CIS Kubernetes Benchmark 1.4.0 and 1.4.1."),(0,s.kt)("h3",{id:"cis-kubernetes-benchmark-141---rancher-22x-with-kubernetes-113"},"CIS Kubernetes Benchmark 1.4.1 - Rancher 2.2.x with Kubernetes 1.13"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://releases.rancher.com/documents/security/2.2.x/Rancher_Benchmark_Assessment.pdf"},"Click here to download a PDF version of this document")),(0,s.kt)("p",null,"Because Rancher and RKE install Kubernetes services as Docker containers, many of the control verification checks in the CIS Kubernetes Benchmark don't apply. This guide will walk through the various controls and provide updated example commands to audit compliance in Rancher-created clusters."),(0,s.kt)("p",null,"This document is to be used by Rancher operators, security teams, auditors and decision makers."),(0,s.kt)("p",null,"For more detail about each audit, including rationales and remediations for failing tests, you can refer to the corresponding section of the CIS Kubernetes Benchmark v1.4.0. You can download the benchmark after logging in to ",(0,s.kt)("a",{parentName:"p",href:"https://www.cisecurity.org/benchmark/kubernetes/"},"CISecurity.org"),"."),(0,s.kt)("h4",{id:"testing-controls-methodology"},"Testing controls methodology"),(0,s.kt)("p",null,"Rancher and RKE install Kubernetes services via Docker containers. Configuration is defined by arguments passed to the container at the time of initialization, not via configuration files."),(0,s.kt)("p",null,"Scoring the commands is different in Rancher Labs than in the CIS Benchmark. Where the commands differ from the original CIS benchmark, the commands specific to Rancher Labs are provided for testing."),(0,s.kt)("p",null,"When performing the tests, you will need access to the Docker command line on the hosts of all three RKE roles. The commands also make use of the the ",(0,s.kt)("inlineCode",{parentName:"p"},"jq")," command to provide human-readable formatting."),(0,s.kt)("h4",{id:"known-scored-control-failures"},"Known Scored Control Failures"),(0,s.kt)("p",null,"The following scored controls do not currently pass, and Rancher Labs is working towards addressing these through future enhancements to the product."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"1.1.21 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"li"},"--kubelet-certificate-authority")," argument is set as appropriate (Scored)"),(0,s.kt)("li",{parentName:"ul"},"1.4.11 - Ensure that the etcd data directory permissions are set to ",(0,s.kt)("inlineCode",{parentName:"li"},"700")," or more-restrictive (Scored)"),(0,s.kt)("li",{parentName:"ul"},"1.4.12 - Ensure that the etcd data directory ownership is set to ",(0,s.kt)("inlineCode",{parentName:"li"},"etcd:etcd")," (Scored)"),(0,s.kt)("li",{parentName:"ul"},"2.1.8 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"li"},"--hostname-override")," argument is not set (Scored)")),(0,s.kt)("h3",{id:"controls"},"Controls"),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"1---master-node-security-configuration"},"1 - Master Node Security Configuration"),(0,s.kt)("h3",{id:"11---api-server"},"1.1 - API Server"),(0,s.kt)("h4",{id:"111---ensure-that-the---anonymous-auth-argument-is-set-to-false-scored"},"1.1.1 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--anonymous-auth")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"false")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--anonymous-auth=false\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--anonymous-auth=false")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"112---ensure-that-the---basic-auth-file-argument-is-not-set-scored"},"1.1.2 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--basic-auth-file")," argument is not set (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--basic-auth-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:"),"  ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"113---ensure-that-the---insecure-allow-any-token-argument-is-not-set-scored"},"1.1.3 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--insecure-allow-any-token")," argument is not set (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--insecure-allow-any-token\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:"),"  ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"114---ensure-that-the---kubelet-https-argument-is-set-to-true-scored"},"1.1.4 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--kubelet-https")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"true")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--kubelet-https=false\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"115---ensure-that-the---insecure-bind-address-argument-is-not-set-scored"},"1.1.5 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--insecure-bind-address")," argument is not set (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"Flag not set or ",(0,s.kt)("inlineCode",{parentName:"p"},"--insecure-bind-address=127.0.0.1"),". RKE sets this flag to ",(0,s.kt)("inlineCode",{parentName:"p"},"--insecure-bind-address=127.0.0.1")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--insecure-bind-address=(?:(?!127\\\\.0\\\\.0\\\\.1).)+\")'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"116---ensure-that-the---insecure-port-argument-is-set-to-0-scored"},"1.1.6 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--insecure-port argument")," is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"0")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--insecure-port=0\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--insecure-port=0")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"117---ensure-that-the---secure-port-argument-is-not-set-to-0-scored"},"1.1.7 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--secure-port")," argument is not set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"0")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--secure-port=6443\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--secure-port=6443")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"118---ensure-that-the---profiling-argument-is-set-to-false-scored"},"1.1.8 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--profiling")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"false")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--profiling=false\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--profiling=false")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"119---ensure-that-the---repair-malformed-updates-argument-is-set-to-false-scored"},"1.1.9 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--repair-malformed-updates")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"false")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Note:")," This deprecated flag was removed in 1.14, so it cannot be set."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1110---ensure-that-the-admission-control-plugin-alwaysadmit-is-not-set-scored"},"1.1.10 - Ensure that the admission control plugin ",(0,s.kt)("inlineCode",{parentName:"h4"},"AlwaysAdmit")," is not set (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--enable-admission-plugins=.*(AlwaysAdmit).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1111---ensure-that-the-admission-control-plugin-alwayspullimages-is-set-scored"},"1.1.11 - Ensure that the admission control plugin ",(0,s.kt)("inlineCode",{parentName:"h4"},"AlwaysPullImages")," is set (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--enable-admission-plugins=.*(AlwaysPullImages).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"AlwaysPullImages")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1112---ensure-that-the-admission-control-plugin-denyescalatingexec-is-set-scored"},"1.1.12 - Ensure that the admission control plugin ",(0,s.kt)("inlineCode",{parentName:"h4"},"DenyEscalatingExec")," is set (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--enable-admission-plugins=.*(DenyEscalatingExec).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"DenyEscalatingExec")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1113---ensure-that-the-admission-control-plugin-securitycontextdeny-is-set-not-scored"},"1.1.13 - Ensure that the admission control plugin ",(0,s.kt)("inlineCode",{parentName:"h4"},"SecurityContextDeny")," is set (Not Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"This ",(0,s.kt)("strong",{parentName:"p"},"SHOULD NOT")," be set if you are using a ",(0,s.kt)("inlineCode",{parentName:"p"},"PodSecurityPolicy")," (PSP). From the CIS Benchmark document:"),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"This admission controller should only be used where Pod Security Policies cannot be used on the cluster, as it can interact poorly with certain Pod Security Policies")),(0,s.kt)("p",null,"Several system services (such as ",(0,s.kt)("inlineCode",{parentName:"p"},"nginx-ingress"),") utilize ",(0,s.kt)("inlineCode",{parentName:"p"},"SecurityContext")," to switch users and assign capabilities. These exceptions to the general principle of not allowing privilege or capabilities can be managed with PSP."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--enable-admission-plugins=.*(SecurityContextDeny).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Document"),(0,s.kt)("h4",{id:"1114---ensure-that-the-admission-control-plugin-namespacelifecycle-is-set-scored"},"1.1.14 - Ensure that the admission control plugin ",(0,s.kt)("inlineCode",{parentName:"h4"},"NamespaceLifecycle")," is set (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--enable-admission-plugins=.*(NamespaceLifecycle).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"NamespaceLifecycle")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1115---ensure-that-the---audit-log-path-argument-is-set-as-appropriate-scored"},"1.1.15 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--audit-log-path")," argument is set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"This path is the path inside of the container.  It's combined with the RKE ",(0,s.kt)("inlineCode",{parentName:"p"},"cluster.yml")," ",(0,s.kt)("inlineCode",{parentName:"p"},"extra-binds:")," option to map the audit log to the host filesystem."),(0,s.kt)("p",null,"Audit logs should be collected and shipped off-system to guarantee their integrity."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--audit-log-path=/var/log/kube-audit/audit-log.json\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--audit-log-log=/var/log/kube-audit/audit-log.json")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1116---ensure-that-the---audit-log-maxage-argument-is-set-to-30-or-as-appropriate-scored"},"1.1.16 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--audit-log-maxage")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"30")," or as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"Audit logs should be collected and shipped off-system to guarantee their integrity. Rancher Labs recommends setting this argument to a low value to prevent audit logs from filling the local disk."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--audit-log-maxage=\\\\d+\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--audit-log-maxage=5")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1117---ensure-that-the---audit-log-maxbackup-argument-is-set-to-10-or-as-appropriate-scored"},"1.1.17 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--audit-log-maxbackup")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"10")," or as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"Audit logs should be collected and shipped off-system to guarantee their integrity. Rancher Labs recommends setting this argument to a low value to prevent audit logs from filling the local disk."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--audit-log-maxbackup=\\\\d+\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--audit-log-maxbackup=5")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1118---ensure-that-the---audit-log-maxsize-argument-is-set-to-100-or-as-appropriate-scored"},"1.1.18 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--audit-log-maxsize")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"100")," or as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"Audit logs should be collected and shipped off-system to guarantee their integrity."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--audit-log-maxsize=\\\\d+\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--audit-log-maxsize=100")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1119---ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-scored"},"1.1.19 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--authorization-mode")," argument is not set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"AlwaysAllow")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--authorization-mode=(Node|RBAC|,)+\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--authorization-mode=Node,RBAC")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1120---ensure-that-the---token-auth-file-parameter-is-not-set-scored"},"1.1.20 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--token-auth-file")," parameter is not set (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--token-auth-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1121---ensure-that-the---kubelet-certificate-authority-argument-is-set-as-appropriate-scored"},"1.1.21 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--kubelet-certificate-authority")," argument is set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE is using the kubelet's ability to automatically create self-signed certs. No CA cert is saved to verify the communication between ",(0,s.kt)("inlineCode",{parentName:"p"},"kube-apiserver")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"kubelet"),"."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Mitigation")),(0,s.kt)("p",null,"Make sure nodes with ",(0,s.kt)("inlineCode",{parentName:"p"},"role:controlplane")," are on the same local network as your nodes with ",(0,s.kt)("inlineCode",{parentName:"p"},"role:worker"),".  Use network ACLs to restrict connections to the kubelet port (10250/tcp) on worker nodes, only permitting it from controlplane nodes."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--kubelet-certificate-authority=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," none"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Fail (See Mitigation)"),(0,s.kt)("h4",{id:"1122---ensure-that-the---kubelet-client-certificate-and---kubelet-client-key-arguments-are-set-as-appropriate-scored"},"1.1.22 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--kubelet-client-certificate")," and ",(0,s.kt)("inlineCode",{parentName:"h4"},"--kubelet-client-key")," arguments are set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"--kubelet-client-certificate"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--kubelet-client-certificate=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--kubelet-client-certificate=/etc/kubernetes/ssl/kube-apiserver.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"--kubelet-client-key"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--kubelet-client-key=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--kubelet-client-key=/etc/kubernetes/ssl/kube-apiserver-key.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1123-ensure-that-the---service-account-lookup-argument-is-set-to-true-scored"},"1.1.23 Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--service-account-lookup")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"true")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--service-account-lookup=true\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--service-account-lookup=true")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1124---ensure-that-the-admission-control-plugin-podsecuritypolicy-is-set-scored"},"1.1.24 - Ensure that the admission control plugin ",(0,s.kt)("inlineCode",{parentName:"h4"},"PodSecurityPolicy")," is set (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--enable-admission-plugins=.*(PodSecurityPolicy).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"PodSecurityPolicy")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1125---ensure-that-the---service-account-key-file-argument-is-set-as-appropriate-scored"},"1.1.25 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--service-account-key-file")," argument is set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--service-account-key-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--service-account-key-file=/etc/kubernetes/ssl/kube-service-account-token-key.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1126---ensure-that-the---etcd-certfile-and---etcd-keyfile-arguments-are-set-as-appropriate-scored"},"1.1.26 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--etcd-certfile")," and ",(0,s.kt)("inlineCode",{parentName:"h4"},"--etcd-keyfile")," arguments are set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"--etcd-certfile"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--etcd-certfile=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--etcd-certfile=/etc/kubernetes/ssl/kube-node.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"--etcd-keyfile"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--etcd-keyfile=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--etcd-keyfile=/etc/kubernetes/ssl/kube-node-key.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1127---ensure-that-the-admission-control-plugin-serviceaccount-is-set-scored"},"1.1.27 - Ensure that the admission control plugin ",(0,s.kt)("inlineCode",{parentName:"h4"},"ServiceAccount")," is set (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--enable-admission-plugins=.*(ServiceAccount).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"ServiceAccount")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1128---ensure-that-the---tls-cert-file-and---tls-private-key-file-arguments-are-set-as-appropriate-scored"},"1.1.28 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--tls-cert-file")," and ",(0,s.kt)("inlineCode",{parentName:"h4"},"--tls-private-key-file")," arguments are set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"--tls-cert-file"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--tls-cert-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--tls-cert-file=/etc/kubernetes/ssl/kube-apiserver.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"--tls-key-file"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--tls-private-key-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--tls-private-key-file=/etc/kubernetes/ssl/kube-apiserver-key.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1129---ensure-that-the---client-ca-file-argument-is-set-as-appropriate-scored"},"1.1.29 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--client-ca-file")," argument is set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--client-ca-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--client-ca-file=/etc/kubernetes/ssl/kube-ca.pem"),"\n",(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1130---ensure-that-the-api-server-only-makes-use-of-strong-cryptographic-ciphers-not-scored"},"1.1.30 - Ensure that the API Server only makes use of strong cryptographic ciphers (Not Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (Allowed Ciphers)"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_RSA_WITH_AES_256_GCM_SHA384).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_RSA_WITH_AES_256_GCM_SHA384")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_RSA_WITH_AES_128_GCM_SHA256).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_RSA_WITH_AES_128_GCM_SHA256")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (Disallowed Ciphers)"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(CBC).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(RC4).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1131---ensure-that-the---etcd-cafile-argument-is-set-as-appropriate-scored"},"1.1.31 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--etcd-cafile")," argument is set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--etcd-cafile=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--etcd-cafile=/etc/kubernetes/ssl/kube-ca.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1132---ensure-that-the---authorization-mode-argument-includes-node-scored"},"1.1.32 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--authorization-mode")," argument includes Node (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--authorization-mode=(Node|RBAC|,)+\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--authorization-mode=Node,RBAC"),"\n",(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1133---ensure-that-the-admission-control-plugin-noderestriction-is-set-scored"},"1.1.33 - Ensure that the admission control plugin ",(0,s.kt)("inlineCode",{parentName:"h4"},"NodeRestriction")," is set (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--enable-admission-plugins=.*(NodeRestriction).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"NodeRestriction")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1134---ensure-that-the---experimental-encryption-provider-config-argument-is-set-as-appropriate-scored"},"1.1.34 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--experimental-encryption-provider-config")," argument is set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes"),"\nIn Kubernetes 1.13.x this flag is ",(0,s.kt)("inlineCode",{parentName:"p"},"--encryption-provider-config")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--encryption-provider-config=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"encryption-provider-config=/opt/kubernetes/encryption.yaml")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1135---ensure-that-the-encryption-provider-is-set-to-aescbc-scored"},"1.1.35 - Ensure that the encryption provider is set to aescbc (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"Only the first provider in the list is active."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"grep -A 1 providers: /opt/kubernetes/encryption.yaml | grep aescbc\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:"),"  ",(0,s.kt)("inlineCode",{parentName:"p"},"- aescbc:")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1136---ensure-that-the-admission-control-plugin-eventratelimit-is-set-scored"},"1.1.36 - Ensure that the admission control plugin ",(0,s.kt)("inlineCode",{parentName:"h4"},"EventRateLimit")," is set (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"EventRateLimit")," plugin requires setting the ",(0,s.kt)("inlineCode",{parentName:"p"},"--admission-control-config-file")," option and configuring details in the following files:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"/opt/kubernetes/admission.yaml")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"/opt/kubernetes/event.yaml"))),(0,s.kt)("p",null,"See Host Configuration for details."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (Admissions plugin)"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--enable-admission-plugins=.*(EventRateLimit).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"EventRateLimit")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"--admission-control-config-file"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--admission-control-config-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--admission-control-config-file=/opt/kubernetes/admission.yaml")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1137-ensure-that-the-advancedauditing-argument-is-not-set-to-false-scored"},"1.1.37 Ensure that the AdvancedAuditing argument is not set to false (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"AdvancedAuditing=false")," should not be set, but ",(0,s.kt)("inlineCode",{parentName:"p"},"--audit-policy-file")," should be set and configured.  See Host Configuration for a sample audit policy file."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (Feature Gate)"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--feature-gates=.*(AdvancedAuditing=false).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (Audit Policy File)"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--audit-policy-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--audit-policy-file=/opt/kubernetes/audit.yaml")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1138-ensure-that-the---request-timeout-argument-is-set-as-appropriate-scored"},"1.1.38 Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--request-timeout")," argument is set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE uses the default value of 60s and doesn't set this option. Tuning this value is specific to the environment."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--request-timeout=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"ensure-that-the---authorization-mode-argument-includes-rbac-scored"},"Ensure that the --authorization-mode argument includes RBAC (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-apiserver | jq -e '.[0].Args[] | match(\"--authorization-mode=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},'"--authorization-mode=Node,RBAC"')),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h3",{id:"12---scheduler"},"1.2 - Scheduler"),(0,s.kt)("h4",{id:"121---ensure-that-the---profiling-argument-is-set-to-false-scored"},"1.2.1 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--profiling")," argument is set to false (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-scheduler | jq -e '.[0].Args[] | match(\"--profiling=false\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--profiling=false"),"\n",(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"122---ensure-that-the---address-argument-is-set-to-127001-scored"},"1.2.2 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--address")," argument is set to 127.0.0.1 (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-scheduler | jq -e '.[0].Args[] | match(\"--address=127\\\\.0\\\\.0\\\\.1\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--address=127.0.0.1"),"\n",(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h3",{id:"13---controller-manager"},"1.3 - Controller Manager"),(0,s.kt)("h4",{id:"131---ensure-that-the---terminated-pod-gc-threshold-argument-is-set-as-appropriate-scored"},"1.3.1 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--terminated-pod-gc-threshold")," argument is set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-controller-manager | jq -e '.[0].Args[] | match(\"--terminated-pod-gc-threshold=\\\\d+\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--terminated-pod-gc-threshold=1000")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"132---ensure-that-the---profiling-argument-is-set-to-false-scored"},"1.3.2 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--profiling")," argument is set to false (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-controller-manager | jq -e '.[0].Args[] | match(\"--profiling=false\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--profiling=false")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"133---ensure-that-the---use-service-account-credentials-argument-is-set-to-true-scored"},"1.3.3 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--use-service-account-credentials")," argument is set to true (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-controller-manager | jq -e '.[0].Args[] | match(\"--use-service-account-credentials=true\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--use-service-account-credentials=true")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"134---ensure-that-the---service-account-private-key-file-argument-is-set-as-appropriate-scored"},"1.3.4 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--service-account-private-key-file")," argument is set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-controller-manager | jq -e '.[0].Args[] | match(\"--service-account-private-key-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--service-account-private-key-file=/etc/kubernetes/ssl/kube-service-account-token-key.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"135---ensure-that-the---root-ca-file-argument-is-set-as-appropriate-scored"},"1.3.5 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--root-ca-file")," argument is set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-controller-manager | jq -e '.[0].Args[] | match(\"--root-ca-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--root-ca-file=/etc/kubernetes/ssl/kube-ca.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"136---ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-scored"},"1.3.6 - Ensure that the RotateKubeletServerCertificate argument is set to true (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE does not yet support certificate rotation. This feature is due for the 0.1.12 release of RKE."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-controller-manager | jq -e '.[0].Args[] | match(\"--feature-gates=.*(RotateKubeletServerCertificate=true).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"RotateKubeletServerCertificate=true")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"137---ensure-that-the---address-argument-is-set-to-127001-scored"},"1.3.7 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--address")," argument is set to 127.0.0.1 (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kube-controller-manager | jq -e '.[0].Args[] | match(\"--address=127\\\\.0\\\\.0\\\\.1\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--address=127.0.0.1")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h3",{id:"14---configuration-files"},"1.4 - Configuration Files"),(0,s.kt)("h4",{id:"141---ensure-that-the-api-server-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored"},"1.4.1 - Ensure that the API server pod specification file permissions are set to 644 or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE doesn't require or maintain a configuration file for kube-apiserver. All configuration is passed in as arguments at container run time."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"142---ensure-that-the-api-server-pod-specification-file-ownership-is-set-to-rootroot-scored"},"1.4.2 - Ensure that the API server pod specification file ownership is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"root:root")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE doesn't require or maintain a configuration file for kube-apiserver. All configuration is passed in as arguments at container run time."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"143---ensure-that-the-controller-manager-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored"},"1.4.3 - Ensure that the controller manager pod specification file permissions are set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"644")," or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE doesn't require or maintain a configuration file for ",(0,s.kt)("inlineCode",{parentName:"p"},"kube-controller-manager"),". All configuration is passed in as arguments at container run time."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"144---ensure-that-the-controller-manager-pod-specification-file-ownership-is-set-to-rootroot-scored"},"1.4.4 - Ensure that the controller manager pod specification file ownership is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"root:root")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE doesn't require or maintain a configuration file for ",(0,s.kt)("inlineCode",{parentName:"p"},"kube-controller-manager"),". All configuration is passed in as arguments at container run time."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"145---ensure-that-the-scheduler-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored"},"1.4.5 - Ensure that the scheduler pod specification file permissions are set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"644")," or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE doesn't require or maintain a configuration file for ",(0,s.kt)("inlineCode",{parentName:"p"},"kube-scheduler"),". All configuration is passed in as arguments at container run time."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"146---ensure-that-the-scheduler-pod-specification-file-ownership-is-set-to-rootroot-scored"},"1.4.6 - Ensure that the scheduler pod specification file ownership is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"root:root")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE doesn't require or maintain a configuration file for kube-scheduler. All configuration is passed in as arguments at container run time."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"147---ensure-that-the-etcd-pod-specification-file-permissions-are-set-to-644-or-more-restrictive-scored"},"1.4.7 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"etcd")," pod specification file permissions are set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"644")," or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE doesn't require or maintain a configuration file for etcd. All configuration is passed in as arguments at container run time."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"148---ensure-that-the-etcd-pod-specification-file-ownership-is-set-to-rootroot-scored"},"1.4.8 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"etcd")," pod specification file ownership is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"root:root")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE doesn't require or maintain a configuration file for etcd. All configuration is passed in as arguments at container run time."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"149---ensure-that-the-container-network-interface-file-permissions-are-set-to-644-or-more-restrictive-not-scored"},"1.4.9 - Ensure that the Container Network Interface file permissions are set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"644")," or more restrictive (Not Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"This is a manual check."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"/var/lib/cni/networks/k8s-pod-network"),")"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Note"),"\nThis may return a lockfile. Permissions on this file do not need to be as restrictive as the CNI files."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},'stat -c "%n - %a" /var/lib/cni/networks/k8s-pod-network/*\n')),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"/var/lib/cni/networks/k8s-pod-network/10.42.0.2 - 644\n/var/lib/cni/networks/k8s-pod-network/10.42.0.3 - 644\n/var/lib/cni/networks/k8s-pod-network/last_reserved_ip.0 - 644\n/var/lib/cni/networks/k8s-pod-network/lock - 750\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"/etc/cni/net.d"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},'stat -c "%n - %a" /etc/cni/net.d/*\n')),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"/etc/cni/net.d/10-canal.conflist - 664\n/etc/cni/net.d/calico-kubeconfig - 600\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1410---ensure-that-the-container-network-interface-file-ownership-is-set-to-rootroot-not-scored"},"1.4.10 - Ensure that the Container Network Interface file ownership is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"root:root")," (Not Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"This is a manual check."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"/var/lib/cni/networks/k8s-pod-network"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},'stat -c "%n - %U:%G" /var/lib/cni/networks/k8s-pod-network/*\n')),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"/var/lib/cni/networks/k8s-pod-network/10.42.0.2 - root:root\n/var/lib/cni/networks/k8s-pod-network/10.42.0.3 - root:root\n/var/lib/cni/networks/k8s-pod-network/last_reserved_ip.0 - root:root\n/var/lib/cni/networks/k8s-pod-network/lock - root:root\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"/etc/cni/net.d"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},'stat -c "%n - %U:%G" /etc/cni/net.d/*\n')),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"/etc/cni/net.d/10-canal.conflist - root:root\n/etc/cni/net.d/calico-kubeconfig - root:root\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1411---ensure-that-the-etcd-data-directory-permissions-are-set-to-700-or-more-restrictive-scored"},"1.4.11 - Ensure that the etcd data directory permissions are set to 700 or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"Files underneath the data dir have permissions set to ",(0,s.kt)("inlineCode",{parentName:"p"},"700")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},'stat -c "%n - %a" /var/lib/etcd/*\n\n/var/lib/etcd/member - 700\n')),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"stat -c %a /var/lib/etcd\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"755")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Fail"),(0,s.kt)("h4",{id:"1412---ensure-that-the-etcd-data-directory-ownership-is-set-to-etcdetcd-scored"},"1.4.12 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"etcd")," data directory ownership is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"etcd:etcd")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"etcd")," container runs as the ",(0,s.kt)("inlineCode",{parentName:"p"},"root")," user. The data directory and files are owned by ",(0,s.kt)("inlineCode",{parentName:"p"},"root"),"."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"stat -c %U:%G /var/lib/etcd\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"root:root")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Fail"),(0,s.kt)("h4",{id:"1413---ensure-that-the-file-permissions-for-adminconf-are-set-to-644-or-more-restrictive-scored"},"1.4.13 - Ensure that the file permissions for ",(0,s.kt)("inlineCode",{parentName:"h4"},"admin.conf")," are set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"644")," or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE does not store the kubernetes default kubeconfig credentials file on the nodes.  It's presented to user where RKE is run. We recommend that this kube_config_cluster.yml file be kept in secure store."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"1414---ensure-that-ownership-of-adminconf-is-set-to-rootroot-scored"},"1.4.14 - Ensure that ownership of ",(0,s.kt)("inlineCode",{parentName:"h4"},"admin.conf")," is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"root:root")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE does not store the default ",(0,s.kt)("inlineCode",{parentName:"p"},"kubectl")," config credentials file on the nodes.  It presents credentials to the user when ",(0,s.kt)("inlineCode",{parentName:"p"},"rke")," is first run, and only on the device where the user ran the command. Rancher Labs recommends that this ",(0,s.kt)("inlineCode",{parentName:"p"},"kube_config_cluster.yml")," file be kept in secure store."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"1415---ensure-that-the-file-permissions-for-schedulerconf-are-set-to-644-or-more-restrictive-scored"},"1.4.15 - Ensure that the file permissions for ",(0,s.kt)("inlineCode",{parentName:"h4"},"scheduler.conf")," are set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"644")," or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"stat -c %a /etc/kubernetes/ssl/kubecfg-kube-scheduler.yaml\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"644")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1416---ensure-that-the-file-ownership-of-schedulerconf-is-set-to-rootroot-scored"},"1.4.16 - Ensure that the file ownership of ",(0,s.kt)("inlineCode",{parentName:"h4"},"scheduler.conf")," is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"root:root")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"stat -c %U:%G /etc/kubernetes/ssl/kubecfg-kube-scheduler.yaml\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"root:root")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1417---ensure-that-the-file-permissions-for-controller-managerconf-are-set-to-644-or-more-restrictive-scored"},"1.4.17 - Ensure that the file permissions for ",(0,s.kt)("inlineCode",{parentName:"h4"},"controller-manager.conf")," are set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"644")," or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"stat -c %a /etc/kubernetes/ssl/kubecfg-kube-controller-manager.yaml\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"644")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1418---ensure-that-the-file-ownership-of-controller-managerconf-is-set-to-rootroot-scored"},"1.4.18 - Ensure that the file ownership of ",(0,s.kt)("inlineCode",{parentName:"h4"},"controller-manager.conf")," is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"root:root")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"stat -c %U:%G /etc/kubernetes/ssl/kubecfg-kube-controller-manager.yaml\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"root:root")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1419---ensure-that-the-kubernetes-pki-directory-and-file-ownership-is-set-to-rootroot-scored"},"1.4.19 - Ensure that the Kubernetes PKI directory and file ownership is set to root:root (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"ls -laR /etc/kubernetes/ssl/ |grep -v yaml\n\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"total 128\ndrwxr-xr-x 2 root root 4096 Jul  1 19:53 .\ndrwxr-xr-x 4 root root 4096 Jul  1 19:53 ..\n-rw------- 1 root root 1679 Jul  1 19:53 kube-apiserver-key.pem\n-rw------- 1 root root 1679 Jul  1 19:53 kube-apiserver-proxy-client-key.pem\n-rw-r--r-- 1 root root 1107 Jul  1 19:53 kube-apiserver-proxy-client.pem\n-rw------- 1 root root 1675 Jul  1 19:53 kube-apiserver-requestheader-ca-key.pem\n-rw-r--r-- 1 root root 1082 Jul  1 19:53 kube-apiserver-requestheader-ca.pem\n-rw-r--r-- 1 root root 1285 Jul  1 19:53 kube-apiserver.pem\n-rw------- 1 root root 1675 Jul  1 19:53 kube-ca-key.pem\n-rw-r--r-- 1 root root 1017 Jul  1 19:53 kube-ca.pem\n-rw------- 1 root root 1679 Jul  1 19:53 kube-controller-manager-key.pem\n-rw-r--r-- 1 root root 1062 Jul  1 19:53 kube-controller-manager.pem\n-rw------- 1 root root 1675 Jul  1 19:53 kube-etcd-172-31-16-161-key.pem\n-rw-r--r-- 1 root root 1277 Jul  1 19:53 kube-etcd-172-31-16-161.pem\n-rw------- 1 root root 1679 Jul  1 19:53 kube-etcd-172-31-24-134-key.pem\n-rw-r--r-- 1 root root 1277 Jul  1 19:53 kube-etcd-172-31-24-134.pem\n-rw------- 1 root root 1675 Jul  1 19:53 kube-etcd-172-31-30-57-key.pem\n-rw-r--r-- 1 root root 1277 Jul  1 19:53 kube-etcd-172-31-30-57.pem\n-rw------- 1 root root 1679 Jul  1 19:53 kube-node-key.pem\n-rw-r--r-- 1 root root 1070 Jul  1 19:53 kube-node.pem\n-rw------- 1 root root 1679 Jul  1 19:53 kube-proxy-key.pem\n-rw-r--r-- 1 root root 1046 Jul  1 19:53 kube-proxy.pem\n-rw------- 1 root root 1679 Jul  1 19:53 kube-scheduler-key.pem\n-rw-r--r-- 1 root root 1050 Jul  1 19:53 kube-scheduler.pem\n-rw------- 1 root root 1679 Jul  1 19:53 kube-service-account-token-key.pem\n-rw-r--r-- 1 root root 1285 Jul  1 19:53 kube-service-account-token.pem\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1420---ensure-that-the-kubernetes-pki-certificate-file-permissions-are-set-to-644-or-more-restrictive-scored"},"1.4.20 - Ensure that the Kubernetes PKI certificate file permissions are set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"644")," or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},'stat -c "%n - %a" /etc/kubernetes/ssl/*.pem |grep -v key\n\n')),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"/etc/kubernetes/ssl/kube-apiserver-proxy-client.pem - 644\n/etc/kubernetes/ssl/kube-apiserver-requestheader-ca.pem - 644\n/etc/kubernetes/ssl/kube-apiserver.pem - 644\n/etc/kubernetes/ssl/kube-ca.pem - 644\n/etc/kubernetes/ssl/kube-controller-manager.pem - 644\n/etc/kubernetes/ssl/kube-etcd-172-31-16-161.pem - 644\n/etc/kubernetes/ssl/kube-etcd-172-31-24-134.pem - 644\n/etc/kubernetes/ssl/kube-etcd-172-31-30-57.pem - 644\n/etc/kubernetes/ssl/kube-node.pem - 644\n/etc/kubernetes/ssl/kube-proxy.pem - 644\n/etc/kubernetes/ssl/kube-scheduler.pem - 644\n/etc/kubernetes/ssl/kube-service-account-token.pem - 644\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"1421---ensure-that-the-kubernetes-pki-key-file-permissions-are-set-to-600-scored"},"1.4.21 - Ensure that the Kubernetes PKI key file permissions are set to 600 (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},'stat -c "%n - %a" /etc/kubernetes/ssl/*key*\n\n')),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"/etc/kubernetes/ssl/kube-apiserver-key.pem - 600\n/etc/kubernetes/ssl/kube-apiserver-proxy-client-key.pem - 600\n/etc/kubernetes/ssl/kube-apiserver-requestheader-ca-key.pem - 600\n/etc/kubernetes/ssl/kube-ca-key.pem - 600\n/etc/kubernetes/ssl/kube-controller-manager-key.pem - 600\n/etc/kubernetes/ssl/kube-etcd-172-31-16-161-key.pem - 600\n/etc/kubernetes/ssl/kube-etcd-172-31-24-134-key.pem - 600\n/etc/kubernetes/ssl/kube-etcd-172-31-30-57-key.pem - 600\n/etc/kubernetes/ssl/kube-node-key.pem - 600\n/etc/kubernetes/ssl/kube-proxy-key.pem - 600\n/etc/kubernetes/ssl/kube-scheduler-key.pem - 600\n/etc/kubernetes/ssl/kube-service-account-token-key.pem - 600\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h3",{id:"15---etcd"},"1.5 - etcd"),(0,s.kt)("h4",{id:"151---ensure-that-the---cert-file-and---key-file-arguments-are-set-as-appropriate-scored"},"1.5.1 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--cert-file")," and ",(0,s.kt)("inlineCode",{parentName:"h4"},"--key-file")," arguments are set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," ",(0,s.kt)("inlineCode",{parentName:"p"},"(--cert-file"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect etcd | jq -e '.[0].Args[] | match(\"--cert-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Note"),"\nCertificate file name may vary slightly, since it contains the IP of the etcd container."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--cert-file=/etc/kubernetes/ssl/kube-etcd-172-31-24-134.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"--key-file"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect etcd | jq -e '.[0].Args[] | match(\"--key-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Note"),"\nKey file name may vary slightly, since it contains the IP of the etcd container."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--key-file=/etc/kubernetes/ssl/kube-etcd-172-31-24-134-key.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"152---ensure-that-the---client-cert-auth-argument-is-set-to-true-scored"},"1.5.2 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--client-cert-auth")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"true")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,'Setting "--client-cert-auth" is the equivalent of setting "--client-cert-auth=true".'),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect etcd | jq -e '.[0].Args[] | match(\"--client-cert-auth(=true)*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--client-cert-auth")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"153---ensure-that-the---auto-tls-argument-is-not-set-to-true-scored"},"1.5.3 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--auto-tls")," argument is not set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"true")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect etcd | jq -e '.[0].Args[] | match(\"--auto-tls(?:(?!=false).*)\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"154---ensure-that-the---peer-cert-file-and---peer-key-file-arguments-are-set-as-appropriate-scored"},"1.5.4 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--peer-cert-file")," and ",(0,s.kt)("inlineCode",{parentName:"h4"},"--peer-key-file")," arguments are set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"--peer-cert-file"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect etcd | jq -e '.[0].Args[] | match(\"--peer-cert-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Note"),"\nCertificate file name may vary slightly, since it contains the IP of the etcd container."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--peer-cert-file=/etc/kubernetes/ssl/kube-etcd-172-31-22-135.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"--peer-key-file"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect etcd | jq -e '.[0].Args[] | match(\"--peer-key-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Note"),"\nKey file name may vary slightly, since it contains the IP of the etcd container."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--peer-key-file=/etc/kubernetes/ssl/kube-etcd-172-31-22-135-key.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"155---ensure-that-the---peer-client-cert-auth-argument-is-set-to-true-scored"},"1.5.5 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--peer-client-cert-auth")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"true")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"Setting ",(0,s.kt)("inlineCode",{parentName:"p"},"--peer-client-cert-auth")," is the equivalent of setting ",(0,s.kt)("inlineCode",{parentName:"p"},"--peer-client-cert-auth=true"),"."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect etcd | jq -e '.[0].Args[] | match(\"--peer-client-cert-auth(=true)*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--peer-client-cert-auth")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"156---ensure-that-the---peer-auto-tls-argument-is-not-set-to-true-scored"},"1.5.6 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--peer-auto-tls")," argument is not set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"true")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect etcd | jq -e '.[0].Args[] | match(\"--peer-auto-tls(?:(?!=false).*)\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"157---ensure-that-a-unique-certificate-authority-is-used-for-etcd-not-scored"},"1.5.7 - Ensure that a unique Certificate Authority is used for ",(0,s.kt)("inlineCode",{parentName:"h4"},"etcd")," (Not Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Mitigation")),(0,s.kt)("p",null,"RKE supports connecting to an external etcd cluster. This external cluster could be configured with its own discreet CA."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"--trusted-ca-file")," is set and different from the ",(0,s.kt)("inlineCode",{parentName:"p"},"--client-ca-file")," used by ",(0,s.kt)("inlineCode",{parentName:"p"},"kube-apiserver"),"."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect etcd | jq -e '.[0].Args[] | match(\"--trusted-ca-file=(?:(?!/etc/kubernetes/ssl/kube-ca.pem).*)\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (See Mitigation)"),(0,s.kt)("h4",{id:"16---general-security-primitives"},"1.6 - General Security Primitives"),(0,s.kt)("p",null,'These "Not Scored" controls are implementation best practices. To ease the administrative burden, we recommend that you implement these best practices on your workload clusters by creating clusters with Rancher rather than using RKE alone.'),(0,s.kt)("h4",{id:"161---ensure-that-the-cluster-admin-role-is-only-used-where-required-not-scored"},"1.6.1 - Ensure that the cluster-admin role is only used where required (Not Scored)"),(0,s.kt)("p",null,"Rancher has built in support for maintaining and enforcing Kubernetes RBAC on your workload clusters."),(0,s.kt)("p",null,"Rancher has the ability integrate with external authentication sources (LDAP, SAML, AD\u2026) allows easy access with unique credentials to your existing users or groups."),(0,s.kt)("h4",{id:"162---create-administrative-boundaries-between-resources-using-namespaces-not-scored"},"1.6.2 - Create administrative boundaries between resources using namespaces (Not Scored)"),(0,s.kt)("p",null,'With Rancher, users or groups can be assigned access to all clusters, a single cluster or a "Project" (a group of one or more namespaces in a cluster). This allows granular access control to cluster resources.'),(0,s.kt)("h4",{id:"163---create-network-segmentation-using-network-policies-not-scored"},"1.6.3 - Create network segmentation using Network Policies (Not Scored)"),(0,s.kt)("p",null,'Rancher can (optionally) automatically create Network Policies to isolate "Projects" (a group of one or more namespaces) in a cluster.'),(0,s.kt)("p",null,'See "Cluster Options" when creating a cluster with Rancher to turn on Network Isolation.'),(0,s.kt)("h4",{id:"164---ensure-that-the-seccomp-profile-is-set-to-dockerdefault-in-your-pod-definitions-not-scored"},"1.6.4 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"seccomp")," profile is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"docker/default")," in your pod definitions (Not Scored)"),(0,s.kt)("p",null,"Since this requires the enabling of AllAlpha feature gates we would not recommend enabling this feature at the moment."),(0,s.kt)("h4",{id:"165---apply-security-context-to-your-pods-and-containers-not-scored"},"1.6.5 - Apply security context to your pods and containers (Not Scored)"),(0,s.kt)("p",null,"This practice does go against control 1.1.13, but we prefer using a PodSecurityPolicy and allowing security context to be set over a blanket deny."),(0,s.kt)("p",null,"Rancher allows users to set various Security Context options when launching pods via the GUI interface."),(0,s.kt)("h4",{id:"166---configure-image-provenance-using-the-imagepolicywebhook-admission-controller-not-scored"},"1.6.6 - Configure image provenance using the ",(0,s.kt)("inlineCode",{parentName:"h4"},"ImagePolicyWebhook")," admission controller (Not Scored)"),(0,s.kt)("p",null,"Image Policy Webhook requires a 3rd party service to enforce policy. This can be configured in the ",(0,s.kt)("inlineCode",{parentName:"p"},"--admission-control-config-file"),".  See the Host configuration section for the admission.yaml file."),(0,s.kt)("h4",{id:"167---configure-network-policies-as-appropriate-not-scored"},"1.6.7 - Configure network policies as appropriate (Not Scored)"),(0,s.kt)("p",null,"Rancher can (optionally) automatically create Network Policies to isolate projects (a group of one or more namespaces) within a cluster."),(0,s.kt)("p",null,"See the ",(0,s.kt)("em",{parentName:"p"},"Cluster Options")," section when creating a cluster with Rancher to turn on network isolation."),(0,s.kt)("h4",{id:"168---place-compensating-controls-in-the-form-of-podsecuritypolicy-psp-and-rbac-for-privileged-container-usage-not-scored"},"1.6.8 - Place compensating controls in the form of PodSecurityPolicy (PSP) and RBAC for privileged container usage (Not Scored)"),(0,s.kt)("p",null,'Section 1.7 of this guide shows how to add and configure a default "restricted" PSP based on controls.'),(0,s.kt)("p",null,'With Rancher you can create a centrally maintained "restricted" PSP and deploy it to all of the clusters that Rancher manages.'),(0,s.kt)("h4",{id:"17---pod-security-policies-psp"},"1.7 - Pod Security Policies (PSP)"),(0,s.kt)("p",null,"This RKE configuration has two Pod Security Policies."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"default-psp"),": assigned to namespaces that require additional privileged access:  ",(0,s.kt)("inlineCode",{parentName:"li"},"kube-system"),", ",(0,s.kt)("inlineCode",{parentName:"li"},"ingress-nginx")," and ",(0,s.kt)("inlineCode",{parentName:"li"},"cattle-system"),"."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"restricted"),": This is the cluster default PSP and follows the best practices defined by controls in this section.")),(0,s.kt)("h4",{id:"171---do-not-admit-privileged-containers-not-scored"},"1.7.1 - Do not admit privileged containers (Not Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"The restricted PodSecurityPolicy is available to all ServiceAccounts."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get psp restricted -o jsonpath='{.spec.privileged}' | grep \"true\"\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"172---do-not-admit-containers-wishing-to-share-the-host-process-id-namespace-scored"},"1.7.2 - Do not admit containers wishing to share the host process ID namespace (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"The restricted PodSecurityPolicy is available to all ServiceAccounts."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get psp restricted -o jsonpath='{.spec.hostPID}' | grep \"true\"\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"173---do-not-admit-containers-wishing-to-share-the-host-ipc-namespace-scored"},"1.7.3 - Do not admit containers wishing to share the host IPC namespace (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"The restricted PodSecurityPolicy is available to all ServiceAccounts."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get psp restricted -o jsonpath='{.spec.hostIPC}' | grep \"true\"\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"174---do-not-admit-containers-wishing-to-share-the-host-network-namespace-scored"},"1.7.4 - Do not admit containers wishing to share the host network namespace (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"The restricted PodSecurityPolicy is available to all ServiceAccounts."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get psp restricted -o jsonpath='{.spec.hostNetwork}' | grep \"true\"\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"175---do-not-admit-containers-with-allowprivilegeescalation-scored"},"1.7.5 - Do not admit containers with ",(0,s.kt)("inlineCode",{parentName:"h4"},"allowPrivilegeEscalation")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"The restricted PodSecurityPolicy is available to all ServiceAccounts."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get psp restricted -o jsonpath='{.spec.allowPrivilegeEscalation}' | grep \"true\"\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"176---do-not-admit-containers-whose-processes-run-as-root-not-scored"},"1.7.6 - Do not admit containers whose processes run as ",(0,s.kt)("inlineCode",{parentName:"h4"},"root")," (Not Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"The restricted PodSecurityPolicy is available to all ServiceAccounts."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get psp restricted -o jsonpath='{.spec.runAsUser.rule}' | grep \"RunAsAny\"\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"177---do-not-admit-containers-with-dangerous-capabilities-not-scored"},"1.7.7 - Do not admit containers with dangerous capabilities (Not Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"The restricted PodSecurityPolicy is available to all ServiceAccounts."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl get psp restricted -o jsonpath='{.spec.requiredDropCapabilities}' | grep \"NET_RAW\"\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"[NET_RAW]")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h2",{id:"2---worker-node-security-configuration"},"2 - Worker Node Security Configuration"),(0,s.kt)("h3",{id:"21---kubelet"},"2.1 - Kubelet"),(0,s.kt)("h4",{id:"211---ensure-that-the---anonymous-auth-argument-is-set-to-false-scored"},"2.1.1 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--anonymous-auth")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"false")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--anonymous-auth=false\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--anonymous-auth=false")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"212---ensure-that-the---authorization-mode-argument-is-not-set-to-alwaysallow-scored"},"2.1.2 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--authorization-mode")," argument is not set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"AlwaysAllow")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--authorization-mode=Webhook\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--authorization-mode=Webhook")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"213---ensure-that-the---client-ca-file-argument-is-set-as-appropriate-scored"},"2.1.3 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--client-ca-file")," argument is set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--client-ca-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--client-ca-file=/etc/kubernetes/ssl/kube-ca.pem")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"214---ensure-that-the---read-only-port-argument-is-set-to-0-scored"},"2.1.4 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--read-only-port")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"0")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--read-only-port=0\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--read-only-port=0")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"215---ensure-that-the---streaming-connection-idle-timeout-argument-is-not-set-to-0-scored"},"2.1.5 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--streaming-connection-idle-timeout")," argument is not set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"0")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--streaming-connection-idle-timeout=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--streaming-connection-idle-timeout=1800s")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"216---ensure-that-the---protect-kernel-defaults-argument-is-set-to-true-scored"},"2.1.6 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--protect-kernel-defaults")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"true")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--protect-kernel-defaults=true\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--protect-kernel-defaults=true")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"217---ensure-that-the---make-iptables-util-chains-argument-is-set-to-true-scored"},"2.1.7 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--make-iptables-util-chains")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"true")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--make-iptables-util-chains=true\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--make-iptables-util-chains=true")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"218---ensure-that-the---hostname-override-argument-is-not-set-scored"},"2.1.8 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--hostname-override")," argument is not set (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes"),"\nThis is used by most cloud providers. Not setting this is not practical in most cases."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--hostname-override=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--hostname-override=<ipv4 address>")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Fail"),(0,s.kt)("h4",{id:"219---ensure-that-the---event-qps-argument-is-set-to-0-scored"},"2.1.9 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--event-qps")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"0")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--event-qps=0\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"--event-qps=0")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"2110---ensure-that-the---tls-cert-file-and---tls-private-key-file-arguments-are-set-as-appropriate-scored"},"2.1.10 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--tls-cert-file")," and ",(0,s.kt)("inlineCode",{parentName:"h4"},"--tls-private-key-file")," arguments are set as appropriate (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE does not set these options and uses the kubelet's self generated certificates for TLS communication. These files are located in the default directory (",(0,s.kt)("inlineCode",{parentName:"p"},"/var/lib/kubelet/pki"),")."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"--tls-cert-file"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--tls-cert-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (",(0,s.kt)("inlineCode",{parentName:"p"},"--tls-private-key-file"),")"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--tls-private-key-file=.*\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"2111---ensure-that-the---cadvisor-port-argument-is-set-to-0-scored"},"2.1.11 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--cadvisor-port")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"0")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--cadvisor-port=0\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"2112---ensure-that-the---rotate-certificates-argument-is-not-set-to-false-scored"},"2.1.12 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"--rotate-certificates")," argument is not set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"false")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE handles certificate rotation through an external process."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--rotate-certificates=true\").string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"2113---ensure-that-the-rotatekubeletservercertificate-argument-is-set-to-true-scored"},"2.1.13 - Ensure that the ",(0,s.kt)("inlineCode",{parentName:"h4"},"RotateKubeletServerCertificate")," argument is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"true")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--feature-gates=.*(RotateKubeletServerCertificate=true).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"RotateKubeletServerCertificate=true")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"2114---ensure-that-the-kubelet-only-makes-use-of-strong-cryptographic-ciphers-not-scored"},"2.1.14 - Ensure that the kubelet only makes use of strong cryptographic ciphers (Not Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (Allowed Ciphers)"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_RSA_WITH_AES_256_GCM_SHA384).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_RSA_WITH_AES_256_GCM_SHA384")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(TLS_RSA_WITH_AES_128_GCM_SHA256).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"TLS_RSA_WITH_AES_128_GCM_SHA256")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")," (Disallowed Ciphers)"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(CBC).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"docker inspect kubelet | jq -e '.[0].Args[] | match(\"--tls-cipher-suites=.*(RC4).*\").captures[].string'\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"null")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h3",{id:"22---configuration-files"},"2.2 - Configuration Files"),(0,s.kt)("h4",{id:"221---ensure-that-the-permissions-for-kubeletconf-are-set-to-644-or-more-restrictive-scored"},"2.2.1 - Ensure that the permissions for ",(0,s.kt)("inlineCode",{parentName:"h4"},"kubelet.conf")," are set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"644")," or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"This is the value of the ",(0,s.kt)("inlineCode",{parentName:"p"},"--kubeconfig")," option."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"stat -c %a /etc/kubernetes/ssl/kubecfg-kube-node.yaml\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"644")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"222---ensure-that-the-kubeletconf-file-ownership-is-set-to-rootroot-scored"},"2.2.2 - Ensure that the kubelet.conf file ownership is set to root:root (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"This is the value of the ",(0,s.kt)("inlineCode",{parentName:"p"},"--kubeconfig")," option."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"stat -c %U:%G /etc/kubernetes/ssl/kubecfg-kube-node.yaml\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"root:root")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"223---ensure-that-the-kubelet-service-file-permissions-are-set-to-644-or-more-restrictive-scored"},"2.2.3 - Ensure that the kubelet service file permissions are set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"644")," or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE doesn't require or maintain a configuration file for kubelet. All configuration is passed in as arguments at container run time."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"224---ensure-that-the-kubelet-service-file-ownership-is-set-to-rootroot-scored"},"2.2.4 - Ensure that the kubelet service file ownership is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"root:root")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE doesn't require or maintain a configuration file for kubelet. All configuration is passed in as arguments at container run time."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"225---ensure-that-the-proxy-kubeconfig-file-permissions-are-set-to-644-or-more-restrictive-scored"},"2.2.5 - Ensure that the proxy kubeconfig file permissions are set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"644")," or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"stat -c %a /etc/kubernetes/ssl/kubecfg-kube-proxy.yaml\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"644")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"226---ensure-that-the-proxy-kubeconfig-file-ownership-is-set-to-rootroot-scored"},"2.2.6 - Ensure that the proxy kubeconfig file ownership is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"root:root")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"stat -c %U:%G /etc/kubernetes/ssl/kubecfg-kube-proxy.yaml\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"root:root")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"227---ensure-that-the-certificate-authorities-file-permissions-are-set-to-644-or-more-restrictive-scored"},"2.2.7 - Ensure that the certificate authorities file permissions are set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"644")," or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"stat -c %a /etc/kubernetes/ssl/kube-ca.pem\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"644")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"228---ensure-that-the-client-certificate-authorities-file-ownership-is-set-to-rootroot-scored"},"2.2.8 - Ensure that the client certificate authorities file ownership is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"root:root")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Audit")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"stat -c %U:%G /etc/kubernetes/ssl/kube-ca.pem\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Returned Value:")," ",(0,s.kt)("inlineCode",{parentName:"p"},"root:root")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass"),(0,s.kt)("h4",{id:"229---ensure-that-the-kubelet-configuration-file-ownership-is-set-to-rootroot-scored"},"2.2.9 - Ensure that the kubelet configuration file ownership is set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"root:root")," (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE doesn't require or maintain a configuration file for kubelet. All configuration is passed in as arguments at container run time."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"),(0,s.kt)("h4",{id:"2210---ensure-that-the-kubelet-configuration-file-permissions-are-set-to-644-or-more-restrictive-scored"},"2.2.10 - Ensure that the kubelet configuration file permissions are set to ",(0,s.kt)("inlineCode",{parentName:"h4"},"644")," or more restrictive (Scored)"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Notes")),(0,s.kt)("p",null,"RKE doesn't require or maintain a configuration file for kubelet. All configuration is passed in as arguments at container run time."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Result:")," Pass (Not Applicable)"))}k.isMDXComponent=!0}}]);