<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-2.5 plugin-docs plugin-id-default docs-doc-id-how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters/use-windows-clusters" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Launching Kubernetes on Windows Clusters | Rancher</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ranchermanager.docs.rancher.com/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="2.5"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.5"><meta data-rh="true" name="docsearch:version" content="2.5"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.5"><meta data-rh="true" property="og:title" content="Launching Kubernetes on Windows Clusters | Rancher"><meta data-rh="true" name="description" content="When provisioning a custom cluster using Rancher, Rancher uses RKE (the Rancher Kubernetes Engine) to install Kubernetes on your existing nodes."><meta data-rh="true" property="og:description" content="When provisioning a custom cluster using Rancher, Rancher uses RKE (the Rancher Kubernetes Engine) to install Kubernetes on your existing nodes."><link data-rh="true" rel="icon" href="/zh/img/favicon.png"><link data-rh="true" rel="alternate" href="https://ranchermanager.docs.rancher.com/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters" hreflang="en"><link data-rh="true" rel="alternate" href="https://ranchermanager.docs.rancher.com/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters" hreflang="zh"><link data-rh="true" rel="alternate" href="https://ranchermanager.docs.rancher.com/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://30NEY6C9UY-dsn.algolia.net" crossorigin="anonymous"><link data-rh="true" rel="canonical" href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/use-windows-clusters"><link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-57KS2MW",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>



<link rel="search" type="application/opensearchdescription+xml" title="Rancher" href="/zh/opensearch.xml">



<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="0f98beb0-fc4c-417d-a42e-564e2cae42d2" async></script>
<script src="/scripts/optanonwrapper.js" async></script><link rel="stylesheet" href="/zh/assets/css/styles.30c9cd28.css">
<link rel="preload" href="/zh/assets/js/runtime~main.dc7416f5.js" as="script">
<link rel="preload" href="/zh/assets/js/main.9b16affc.js" as="script">
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-57KS2MW" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh/"><div class="navbar__logo"><img src="/zh/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/zh/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/zh/v2.5">v2.5</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/">Latest</a></li><li><a class="dropdown__link" href="/zh/v2.8">v2.8</a></li><li><a class="dropdown__link" href="/zh/v2.7">v2.7</a></li><li><a class="dropdown__link" href="/zh/v2.6">v2.6</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters">v2.5</a></li><li><a class="dropdown__link" href="/zh/v2.0-v2.4/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters">v2.0-v2.4</a></li><li><a class="dropdown__link" href="/zh/versions">All versions</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">简体中文</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Quick Links</a><ul class="dropdown__menu"><li><a href="https://github.com/rancher/rancher" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/rancher/rancher-docs" target="_blank" rel="noopener noreferrer" class="dropdown__link">Docs GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">More from SUSE</a><ul class="dropdown__menu"><li><a href="https://www.rancher.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rancher">Rancher<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://elemental.docs.rancher.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__elemental">Elemental<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://fleet.rancher.io/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__fleet">Fleet<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://harvesterhci.io" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__harvester">Harvester<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://rancherdesktop.io/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rancher__desktop">Rancher Desktop<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://opensource.suse.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__suse">More Projects...<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh/v2.5">Rancher 2.5</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/v2.5/getting-started">Getting Started</a><button aria-label="打开/收起侧边栏菜单「Getting Started」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/zh/v2.5/how-to-guides">How-to Guides</a><button aria-label="打开/收起侧边栏菜单「How-to Guides」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides">New User Guides</a><button aria-label="打开/收起侧边栏菜单「New User Guides」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-cluster-setup">Setting up a Kubernetes Cluster for Rancher Server</a><button aria-label="打开/收起侧边栏菜单「Setting up a Kubernetes Cluster for Rancher Server」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/infrastructure-setup">Infrastructure Setup</a><button aria-label="打开/收起侧边栏菜单「Infrastructure Setup」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup">Kubernetes Clusters in Rancher Setup</a><button aria-label="打开/收起侧边栏菜单「Kubernetes Clusters in Rancher Setup」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/node-requirements-for-rancher-managed-clusters">Node Requirements for Rancher Managed Clusters</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/checklist-for-production-ready-clusters">Checklist for Production-Ready Clusters</a><button aria-label="打开/收起侧边栏菜单「Checklist for Production-Ready Clusters」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/set-up-clusters-from-hosted-kubernetes-providers">Setting up Clusters from Hosted Kubernetes Providers</a><button aria-label="打开/收起侧边栏菜单「Setting up Clusters from Hosted Kubernetes Providers」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher">Launching Kubernetes with Rancher</a><button aria-label="打开/收起侧边栏菜单「Launching Kubernetes with Rancher」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-new-nodes-in-an-infra-provider">Launching New Nodes in an Infra Provider</a><button aria-label="打开/收起侧边栏菜单「Launching New Nodes in an Infra Provider」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters">Launching Kubernetes on Windows Clusters</a><button aria-label="打开/收起侧边栏菜单「Launching Kubernetes on Windows Clusters」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters/azure-storageclass-configuration">Configuring Storage Classes in Azure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters/windows-linux-cluster-feature-parity">Windows and Linux Cluster Feature Parity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters/network-requirements-for-host-gateway">Networking Requirements for Host Gateway (L2bridge)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/set-up-cloud-providers">Setting up Cloud Providers</a><button aria-label="打开/收起侧边栏菜单「Setting up Cloud Providers」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/about-rancher-agents">Rancher Agents</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/register-existing-clusters">Registering Existing Clusters</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-resources-setup">Kubernetes Resources Setup</a><button aria-label="打开/收起侧边栏菜单「Kubernetes Resources Setup」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/helm-charts-in-rancher">Helm Charts and Apps</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/deploy-apps-across-clusters">Deploying Apps Across Clusters</a><button aria-label="打开/收起侧边栏菜单「Deploying Apps Across Clusters」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.5/how-to-guides/new-user-guides/backup-restore-and-disaster-recovery">Backup, Restore, and Disaster Recovery</a><button aria-label="打开/收起侧边栏菜单「Backup, Restore, and Disaster Recovery」" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/v2.5/how-to-guides/advanced-user-guides">Advanced User Guides</a><button aria-label="打开/收起侧边栏菜单「Advanced User Guides」" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/v2.5/reference-guides">Reference Guides</a><button aria-label="打开/收起侧边栏菜单「Reference Guides」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/v2.5/explanations">Explanations</a><button aria-label="打开/收起侧边栏菜单「Explanations」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/v2.5/faq">FAQ</a><button aria-label="打开/收起侧边栏菜单「FAQ」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/v2.5/troubleshooting">Troubleshooting</a><button aria-label="打开/收起侧边栏菜单「Troubleshooting」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh/v2.5/contribute-to-rancher">Contributing to Rancher</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>此为 <!-- -->Rancher<!-- --> <b>v2.5</b> 版的文档，现已不再积极维护。</div><div class="margin-top--md">最新的文档请参阅<b><a href="/zh/">最新版本</a></b> (<!-- -->Latest<!-- -->)。</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/zh/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/v2.5/how-to-guides"><span itemprop="name">How-to Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/v2.5/how-to-guides/new-user-guides"><span itemprop="name">New User Guides</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup"><span itemprop="name">Kubernetes Clusters in Rancher Setup</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher"><span itemprop="name">Launching Kubernetes with Rancher</span></a><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Launching Kubernetes on Windows Clusters</span><meta itemprop="position" content="5"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">版本：v2.5</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Launching Kubernetes on Windows Clusters</h1></header><p>When provisioning a <a href="/zh/v2.5/reference-guides/cluster-configuration/rancher-server-configuration/use-existing-nodes">custom cluster</a> using Rancher, Rancher uses RKE (the Rancher Kubernetes Engine) to install Kubernetes on your existing nodes.</p><p>In a Windows cluster provisioned with Rancher, the cluster must contain both Linux and Windows nodes. The Kubernetes controlplane can only run on Linux nodes, and the Windows nodes can only have the worker role. Windows nodes can only be used for deploying workloads.</p><p>Some other requirements for Windows clusters include:</p><ul><li>You can only add Windows nodes to a cluster if Windows support is enabled when the cluster is created. Windows support cannot be enabled for existing clusters.</li><li>Kubernetes 1.15+ is required.</li><li>The Flannel network provider must be used.</li><li>Windows nodes must have 50 GB of disk space.</li></ul><p>For the full list of requirements, see <a href="#requirements-for-windows-clusters">this section.</a></p><p>For a summary of Kubernetes features supported in Windows, see the Kubernetes documentation on <a href="https://kubernetes.io/docs/setup/production-environment/windows/intro-windows-in-kubernetes/#supported-functionality-and-limitations" target="_blank" rel="noopener noreferrer">supported functionality and limitations for using Kubernetes with Windows</a> or the <a href="https://kubernetes.io/docs/setup/production-environment/windows/user-guide-windows-containers/" target="_blank" rel="noopener noreferrer">guide for scheduling Windows containers in Kubernetes</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="requirements-for-windows-clusters">Requirements for Windows Clusters<a href="#requirements-for-windows-clusters" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>The general node requirements for networking, operating systems, and Docker are the same as the node requirements for a <a href="/zh/v2.5/getting-started/installation-and-upgrade/installation-requirements">Rancher installation</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="os-and-docker-requirements">OS and Docker Requirements<a href="#os-and-docker-requirements" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Rancher v2.5.8+</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Rancher before v2.5.8</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>Our support for Windows Server and Windows containers match the Microsoft official lifecycle for LTSC (Long-Term Servicing Channel) and SAC (Semi-Annual Channel).</p><p>For the support lifecycle dates for Windows Server, see the <a href="https://docs.microsoft.com/en-us/windows-server/get-started/windows-server-release-info" target="_blank" rel="noopener noreferrer">Microsoft Documentation.</a></p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>In order to add Windows worker nodes to a cluster, the node must be running one of the following Windows Server versions and the corresponding version of Docker Engine - Enterprise Edition (EE):</p><ul><li>Nodes with Windows Server core version 1809 should use Docker EE-basic 18.09 or Docker EE-basic 19.03.</li><li>Nodes with Windows Server core version 1903 should use Docker EE-basic 19.03.</li></ul><blockquote><p><strong>Notes:</strong></p><ul><li>If you are using AWS, Rancher recommends <em>Microsoft Windows Server 2019 Base with Containers</em> as the Amazon Machine Image (AMI).</li><li>If you are using GCE, Rancher recommends <em>Windows Server 2019 Datacenter for Containers</em> as the OS image.</li></ul></blockquote></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes-version">Kubernetes Version<a href="#kubernetes-version" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>Kubernetes v1.15+ is required.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="node-requirements">Node Requirements<a href="#node-requirements" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>The hosts in the cluster need to have at least:</p><ul><li>2 core CPUs</li><li>5 GB memory</li><li>50 GB disk space</li></ul><p>Rancher will not provision the node if the node does not meet these requirements.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="networking-requirements">Networking Requirements<a href="#networking-requirements" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>Before provisioning a new cluster, be sure that you have already installed Rancher on a device that accepts inbound network traffic. This is required in order for the cluster nodes to communicate with Rancher. If you have not already installed Rancher, please refer to the <a href="/zh/v2.5/getting-started/installation-and-upgrade">installation documentation</a> before proceeding with this guide.</p><p>Rancher only supports Windows using Flannel as the network provider.</p><p>There are two network options: <a href="https://github.com/coreos/flannel/blob/master/Documentation/backends.md#host-gw" target="_blank" rel="noopener noreferrer"><strong>Host Gateway (L2bridge)</strong></a> and <a href="https://github.com/coreos/flannel/blob/master/Documentation/backends.md#vxlan" target="_blank" rel="noopener noreferrer"><strong>VXLAN (Overlay)</strong></a>. The default option is <strong>VXLAN (Overlay)</strong> mode.</p><p>For <strong>Host Gateway (L2bridge)</strong> networking, it&#x27;s best to use the same Layer 2 network for all nodes. Otherwise, you need to configure the route rules for them. For details, refer to the <a href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters/network-requirements-for-host-gateway#cloud-hosted-vm-routes-configuration">documentation on configuring cloud-hosted VM routes.</a> You will also need to <a href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters/network-requirements-for-host-gateway#disabling-private-ip-address-checks">disable private IP address checks</a> if you are using Amazon EC2, Google GCE, or Azure VM.</p><p>For <strong>VXLAN (Overlay)</strong> networking, the <a href="https://support.microsoft.com/en-us/help/4489899" target="_blank" rel="noopener noreferrer">KB4489899</a> hotfix must be installed. Most cloud-hosted VMs already have this hotfix.</p><p>If you are configuring DHCP options sets for an AWS virtual private cloud, note that in the <code>domain-name</code> option field, only one domain name can be specified. According to the DHCP options <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_DHCP_Options.html" target="_blank" rel="noopener noreferrer">documentation:</a></p><blockquote><p>Some Linux operating systems accept multiple domain names separated by spaces. However, other Linux operating systems and Windows treat the value as a single domain, which results in unexpected behavior. If your DHCP options set is associated with a VPC that has instances with multiple operating systems, specify only one domain name.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rancher-on-vsphere-with-esxi-67u2-and-above">Rancher on vSphere with ESXi 6.7u2 and above<a href="#rancher-on-vsphere-with-esxi-67u2-and-above" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>If you are using Rancher on VMware vSphere with ESXi 6.7u2 or later with Red Hat Enterprise Linux 8.3, CentOS 8.3, or SUSE Enterprise Linux 15 SP2 or later, it is necessary to disable the <code>vmxnet3</code> virtual network adapter hardware offloading feature. Failure to do so will result in all network connections between pods on different cluster nodes to fail with timeout errors. All connections from Windows pods to critical services running on Linux nodes, such as CoreDNS, will fail as well. It is also possible that external connections may fail. This issue is the result of Linux distributions enabling the hardware offloading feature in <code>vmxnet3</code> and a bug in the <code>vmxnet3</code> hardware offloading feature that results in the discarding of packets for guest overlay traffic. To address this issue, it is necessary disable the <code>vmxnet3</code> hardware offloading feature. This setting does not survive reboot, so it is necessary to disable on every boot. The recommended course of action is to create a systemd unit file at <code>/etc/systemd/system/disable_hw_offloading.service</code>, which disables the <code>vmxnet3</code> hardware offloading feature on boot. A sample systemd unit file which disables the <code>vmxnet3</code> hardware offloading feature is as follows. Note that <code>&lt;VM network interface&gt;</code> must be customized to the host <code>vmxnet3</code> network interface, e.g., <code>ens192</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Unit]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Description=Disable vmxnet3 hardware offloading feature</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Type=oneshot</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ExecStart=ethtool -K &lt;VM network interface&gt; tx-udp_tnl-segmentation off</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ExecStart=ethtool -K &lt;VM network interface&gt; tx-udp_tnl-csum-segmentation off</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">StandardOutput=journal</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Install]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">WantedBy=multi-user.target</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then set the appropriate permissions on the systemd unit file:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">chmod 0644 /etc/systemd/system/disable_hw_offloading.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Finally, enable the systemd service:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">systemctl enable disable_hw_offloading.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="architecture-requirements">Architecture Requirements<a href="#architecture-requirements" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>The Kubernetes cluster management nodes (<code>etcd</code> and <code>controlplane</code>) must be run on Linux nodes.</p><p>The <code>worker</code> nodes, which is where your workloads will be deployed on, will typically be Windows nodes, but there must be at least one <code>worker</code> node that is run on Linux in order to run the Rancher cluster agent, DNS, metrics server, and Ingress related containers.</p><p>Clusters won&#x27;t begin provisioning until all three node roles (worker, etcd and controlplane) are present.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="recommended-architecture">Recommended Architecture<a href="#recommended-architecture" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h4><p>We recommend the minimum three-node architecture listed in the table below, but you can always add more Linux and Windows workers to scale up your cluster for redundancy:</p><table><thead><tr><th>Node</th><th>Operating System</th><th>Kubernetes Cluster Role(s)</th><th>Purpose</th></tr></thead><tbody><tr><td>Node 1</td><td>Linux (Ubuntu Server 18.04 recommended)</td><td>Control plane, etcd, worker</td><td>Manage the Kubernetes cluster</td></tr><tr><td>Node 2</td><td>Linux (Ubuntu Server 18.04 recommended)</td><td>Worker</td><td>Support the Rancher Cluster agent, Metrics server, DNS, and Ingress for the cluster</td></tr><tr><td>Node 3</td><td>Windows (Windows Server core version 1809 or above)</td><td>Worker</td><td>Run your Windows containers</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="container-requirements">Container Requirements<a href="#container-requirements" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>Windows requires that containers must be built on the same Windows Server version that they are being deployed on. Therefore, containers must be built on Windows Server core version 1809 or above. If you have existing containers built for an earlier Windows Server core version, they must be re-built on Windows Server core version 1809 or above.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloud-provider-specific-requirements">Cloud Provider Specific Requirements<a href="#cloud-provider-specific-requirements" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>If you set a Kubernetes cloud provider in your cluster, some additional steps are required. You might want to set a cloud provider if you want to want to leverage a cloud provider&#x27;s capabilities, for example, to automatically provision storage, load balancers, or other infrastructure for your cluster. Refer to <a href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/set-up-cloud-providers">this page</a> for details on how to configure a cloud provider cluster of nodes that meet the prerequisites.</p><p>If you are using the GCE (Google Compute Engine) cloud provider, you must do the following:</p><ul><li>Enable the GCE cloud provider in the <code>cluster.yml</code> by following <a href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/set-up-cloud-providers/other-cloud-providers/google-compute-engine">these steps.</a></li><li>When provisioning the cluster in Rancher, choose <strong>Custom cloud provider</strong> as the cloud provider in the Rancher UI.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tutorial-how-to-create-a-cluster-with-windows-support">Tutorial: How to Create a Cluster with Windows Support<a href="#tutorial-how-to-create-a-cluster-with-windows-support" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>This tutorial describes how to create a Rancher-provisioned cluster with the three nodes in the <a href="#recommended-architecture">recommended architecture.</a></p><p>When you provision a cluster with Rancher on existing nodes, you will add nodes to the cluster by installing the <a href="/zh/v2.5/reference-guides/cluster-configuration/rancher-server-configuration/use-existing-nodes/rancher-agent-options">Rancher agent</a> on each one. When you create or edit your cluster from the Rancher UI, you will see a <strong>Customize Node Run Command</strong> that you can run on each server to add it to your cluster.</p><p>To set up a cluster with support for Windows nodes and containers, you will need to complete the tasks below.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-provision-hosts">1. Provision Hosts<a href="#1-provision-hosts" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>To begin provisioning a cluster on existing nodes with Windows support, prepare your hosts.</p><p>Your hosts can be:</p><ul><li>Cloud-hosted VMs</li><li>VMs from virtualization clusters</li><li>Bare-metal servers</li></ul><p>You will provision three nodes:</p><ul><li>One Linux node, which manages the Kubernetes control plane and stores your <code>etcd</code></li><li>A second Linux node, which will be another worker node</li><li>The Windows node, which will run your Windows containers as a worker node</li></ul><table><thead><tr><th>Node</th><th>Operating System</th></tr></thead><tbody><tr><td>Node 1</td><td>Linux (Ubuntu Server 18.04 recommended)</td></tr><tr><td>Node 2</td><td>Linux (Ubuntu Server 18.04 recommended)</td></tr><tr><td>Node 3</td><td>Windows (Windows Server core version 1809 or above required)</td></tr></tbody></table><p>If your nodes are hosted by a <strong>Cloud Provider</strong> and you want automation support such as loadbalancers or persistent storage devices, your nodes have additional configuration requirements. For details, see <a href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/set-up-cloud-providers">Selecting Cloud Providers.</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-create-the-cluster-on-existing-nodes">2. Create the Cluster on Existing Nodes<a href="#2-create-the-cluster-on-existing-nodes" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>The instructions for creating a Windows cluster on existing nodes are very similar to the general <a href="/zh/v2.5/reference-guides/cluster-configuration/rancher-server-configuration/use-existing-nodes">instructions for creating a custom cluster</a> with some Windows-specific requirements.</p><ol><li>From the <strong>Global</strong> view, click on the <strong>Clusters</strong> tab and click <strong>Add Cluster</strong>.</li><li>Click <strong>From existing nodes (Custom)</strong>.</li><li>Enter a name for your cluster in the <strong>Cluster Name</strong> text box.</li><li>In the <strong>Kubernetes Version</strong> dropdown menu, select v1.15 or above.</li><li>In the <strong>Network Provider</strong> field, select <strong>Flannel.</strong></li><li>In the <strong>Windows Support</strong> section, click <strong>Enable.</strong></li><li>Optional: After you enable Windows support, you will be able to choose the Flannel backend. There are two network options: <a href="https://github.com/coreos/flannel/blob/master/Documentation/backends.md#host-gw" target="_blank" rel="noopener noreferrer"><strong>Host Gateway (L2bridge)</strong></a> and <a href="https://github.com/coreos/flannel/blob/master/Documentation/backends.md#vxlan" target="_blank" rel="noopener noreferrer"><strong>VXLAN (Overlay)</strong></a>. The default option is <strong>VXLAN (Overlay)</strong> mode.</li><li>Click <strong>Next</strong>.</li></ol><blockquote><p><strong>Important:</strong> For <b>Host Gateway (L2bridge)</b> networking, it&#x27;s best to use the same Layer 2 network for all nodes. Otherwise, you need to configure the route rules for them. For details, refer to the <a href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters/network-requirements-for-host-gateway#cloud-hosted-vm-routes-configuration">documentation on configuring cloud-hosted VM routes.</a> You will also need to <a href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters/network-requirements-for-host-gateway#disabling-private-ip-address-checks">disable private IP address checks</a> if you are using Amazon EC2, Google GCE, or Azure VM.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-add-nodes-to-the-cluster">3. Add Nodes to the Cluster<a href="#3-add-nodes-to-the-cluster" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>This section describes how to register your Linux and Worker nodes to your cluster. You will run a command on each node, which will install the Rancher agent and allow Rancher to manage each node.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-linux-master-node">Add Linux Master Node<a href="#add-linux-master-node" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>In this section, we fill out a form on the Rancher UI to get a custom command to install the Rancher agent on the Linux master node. Then we will copy the command and run it on our Linux master node to register the node in the cluster.</p><p>The first node in your cluster should be a Linux host has both the <strong>Control Plane</strong> and <strong>etcd</strong> roles. At a minimum, both of these roles must be enabled for this node, and this node must be added to your cluster before you can add Windows hosts.</p><ol><li>In the <strong>Node Operating System</strong> section, click <strong>Linux</strong>.</li><li>In the <strong>Node Role</strong> section, choose at least <strong>etcd</strong> and <strong>Control Plane</strong>. We recommend selecting all three.</li><li>Optional: If you click <strong>Show advanced options,</strong> you can customize the settings for the <a href="/zh/v2.5/reference-guides/cluster-configuration/rancher-server-configuration/use-existing-nodes/rancher-agent-options">Rancher agent</a> and <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/" target="_blank" rel="noopener noreferrer">node labels.</a></li><li>Copy the command displayed on the screen to your clipboard.</li><li>SSH into your Linux host and run the command that you copied to your clipboard.</li><li>When you are finished provisioning your Linux node(s), select <strong>Done</strong>.</li></ol><p><strong>Result:</strong></p><p>Your cluster is created and assigned a state of <strong>Provisioning.</strong> Rancher is standing up your cluster.</p><p>You can access your cluster after its state is updated to <strong>Active.</strong></p><p><strong>Active</strong> clusters are assigned two Projects:</p><ul><li><code>Default</code>, containing the <code>default</code> namespace</li><li><code>System</code>, containing the <code>cattle-system</code>, <code>ingress-nginx</code>, <code>kube-public</code>, and <code>kube-system</code> namespaces</li></ul><p>It may take a few minutes for the node to be registered in your cluster.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-linux-worker-node">Add Linux Worker Node<a href="#add-linux-worker-node" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>In this section, we run a command to register the Linux worker node to the cluster.</p><p>After the initial provisioning of your cluster, your cluster only has a single Linux host. Next, we add another Linux <code>worker</code> host, which will be used to support <em>Rancher cluster agent</em>, <em>Metrics server</em>, <em>DNS</em> and <em>Ingress</em> for your cluster.</p><ol><li>From the <strong>Global</strong> view, click <strong>Clusters.</strong></li><li>Go to the cluster that you created and click <strong>⋮<!-- --> &gt; Edit.</strong></li><li>Scroll down to <strong>Node Operating System</strong>. Choose <strong>Linux</strong>.</li><li>In the <strong>Customize Node Run Command</strong> section, go to the <strong>Node Options</strong> and select the <strong>Worker</strong> role.</li><li>Copy the command displayed on screen to your clipboard.</li><li>Log in to your Linux host using a remote Terminal connection. Run the command copied to your clipboard.</li><li>From <strong>Rancher</strong>, click <strong>Save</strong>.</li></ol><p><strong>Result:</strong> The <strong>Worker</strong> role is installed on your Linux host, and the node registers with Rancher. It may take a few minutes for the node to be registered in your cluster.</p><blockquote><p><strong>Note:</strong> Taints on Linux Worker Nodes</p><p>For each Linux worker node added into the cluster, the following taints will be added to Linux worker node. By adding this taint to the Linux worker node, any workloads added to the Windows cluster will be automatically scheduled to the Windows worker node. If you want to schedule workloads specifically onto the Linux worker node, you will need to add tolerations to those workloads.</p></blockquote><blockquote><table><thead><tr><th>Taint Key</th><th>Taint Value</th><th>Taint Effect</th></tr></thead><tbody><tr><td><code>cattle.io/os</code></td><td><code>linux</code></td><td><code>NoSchedule</code></td></tr></tbody></table></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-a-windows-worker-node">Add a Windows Worker Node<a href="#add-a-windows-worker-node" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>In this section, we run a command to register the Windows worker node to the cluster.</p><p>You can add Windows hosts to the cluster by editing the cluster and choosing the <strong>Windows</strong> option.</p><ol><li>From the <strong>Global</strong> view, click <strong>Clusters.</strong></li><li>Go to the cluster that you created and click <strong>⋮<!-- --> &gt; Edit.</strong></li><li>Scroll down to <strong>Node Operating System</strong>. Choose <strong>Windows</strong>. Note: You will see that the <strong>worker</strong> role is the only available role.</li><li>Copy the command displayed on screen to your clipboard.</li><li>Log in to your Windows host using your preferred tool, such as <a href="https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services/clients/remote-desktop-clients" target="_blank" rel="noopener noreferrer">Microsoft Remote Desktop</a>. Run the command copied to your clipboard in the <strong>Command Prompt (CMD)</strong>.</li><li>From Rancher, click <strong>Save</strong>.</li><li>Optional: Repeat these instructions if you want to add more Windows nodes to your cluster.</li></ol><p><strong>Result:</strong> The <strong>Worker</strong> role is installed on your Windows host, and the node registers with Rancher. It may take a few minutes for the node to be registered in your cluster. You now have a Windows Kubernetes cluster.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="optional-next-steps">Optional Next Steps<a href="#optional-next-steps" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h3><p>After creating your cluster, you can access it through the Rancher UI. As a best practice, we recommend setting up these alternate ways of accessing your cluster:</p><ul><li><strong>Access your cluster with the kubectl CLI:</strong> Follow <a href="/zh/v2.5/how-to-guides/advanced-user-guides/manage-clusters/access-clusters/use-kubectl-and-kubeconfig#accessing-clusters-with-kubectl-from-your-workstation">these steps</a> to access clusters with kubectl on your workstation. In this case, you will be authenticated through the Rancher server’s authentication proxy, then Rancher will connect you to the downstream cluster. This method lets you manage the cluster without the Rancher UI.</li><li><strong>Access your cluster with the kubectl CLI, using the authorized cluster endpoint:</strong> Follow <a href="/zh/v2.5/how-to-guides/advanced-user-guides/manage-clusters/access-clusters/use-kubectl-and-kubeconfig#authenticating-directly-with-a-downstream-cluster">these steps</a> to access your cluster with kubectl directly, without authenticating through the Rancher server. We recommend setting up this alternative method to access your cluster so that in case you can’t connect to Rancher, you can still access the cluster.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-for-storage-classes-in-azure">Configuration for Storage Classes in Azure<a href="#configuration-for-storage-classes-in-azure" class="hash-link" aria-label="标题的直接链接" title="标题的直接链接">​</a></h2><p>If you are using Azure VMs for your nodes, you can use <a href="https://docs.microsoft.com/en-us/azure/aks/azure-files-dynamic-pv" target="_blank" rel="noopener noreferrer">Azure files</a> as a StorageClass for the cluster. For details, refer to <a href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters/azure-storageclass-configuration">this section.</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters/use-windows-clusters.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">最后<!-- -->于 <b><time datetime="2024-01-12T00:36:20.000Z">2024年1月12日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-new-nodes-in-an-infra-provider/vsphere/create-credentials"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Creating Credentials in the vSphere Console</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup/launch-kubernetes-with-rancher/use-windows-clusters/azure-storageclass-configuration"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Configuring Storage Classes in Azure</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#requirements-for-windows-clusters" class="table-of-contents__link toc-highlight">Requirements for Windows Clusters</a><ul><li><a href="#os-and-docker-requirements" class="table-of-contents__link toc-highlight">OS and Docker Requirements</a></li><li><a href="#kubernetes-version" class="table-of-contents__link toc-highlight">Kubernetes Version</a></li><li><a href="#node-requirements" class="table-of-contents__link toc-highlight">Node Requirements</a></li><li><a href="#networking-requirements" class="table-of-contents__link toc-highlight">Networking Requirements</a></li><li><a href="#rancher-on-vsphere-with-esxi-67u2-and-above" class="table-of-contents__link toc-highlight">Rancher on vSphere with ESXi 6.7u2 and above</a></li><li><a href="#architecture-requirements" class="table-of-contents__link toc-highlight">Architecture Requirements</a></li><li><a href="#container-requirements" class="table-of-contents__link toc-highlight">Container Requirements</a></li><li><a href="#cloud-provider-specific-requirements" class="table-of-contents__link toc-highlight">Cloud Provider Specific Requirements</a></li></ul></li><li><a href="#tutorial-how-to-create-a-cluster-with-windows-support" class="table-of-contents__link toc-highlight">Tutorial: How to Create a Cluster with Windows Support</a></li><li><a href="#1-provision-hosts" class="table-of-contents__link toc-highlight">1. Provision Hosts</a></li><li><a href="#2-create-the-cluster-on-existing-nodes" class="table-of-contents__link toc-highlight">2. Create the Cluster on Existing Nodes</a></li><li><a href="#3-add-nodes-to-the-cluster" class="table-of-contents__link toc-highlight">3. Add Nodes to the Cluster</a><ul><li><a href="#add-linux-master-node" class="table-of-contents__link toc-highlight">Add Linux Master Node</a></li><li><a href="#add-linux-worker-node" class="table-of-contents__link toc-highlight">Add Linux Worker Node</a></li><li><a href="#add-a-windows-worker-node" class="table-of-contents__link toc-highlight">Add a Windows Worker Node</a></li><li><a href="#optional-next-steps" class="table-of-contents__link toc-highlight">Optional Next Steps</a></li></ul></li><li><a href="#configuration-for-storage-classes-in-azure" class="table-of-contents__link toc-highlight">Configuration for Storage Classes in Azure</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/zh/assets/js/runtime~main.dc7416f5.js"></script>
<script src="/zh/assets/js/main.9b16affc.js"></script>
</body>
</html>