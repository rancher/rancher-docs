<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-2.5 plugin-docs plugin-id-default docs-doc-id-how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Setting up Amazon ELB Network Load Balancer | Rancher</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ranchermanager.docs.rancher.com/v2.5/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="2.5"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.5"><meta data-rh="true" name="docsearch:version" content="2.5"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.5"><meta data-rh="true" property="og:title" content="Setting up Amazon ELB Network Load Balancer | Rancher"><meta data-rh="true" name="description" content="This how-to guide describes how to set up a Network Load Balancer (NLB) in Amazon&#x27;s EC2 service that will direct traffic to multiple instances on EC2."><meta data-rh="true" property="og:description" content="This how-to guide describes how to set up a Network Load Balancer (NLB) in Amazon&#x27;s EC2 service that will direct traffic to multiple instances on EC2."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="alternate" href="https://ranchermanager.docs.rancher.com/v2.5/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer" hreflang="en"><link data-rh="true" rel="alternate" href="https://ranchermanager.docs.rancher.com/zh/v2.5/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer" hreflang="zh"><link data-rh="true" rel="alternate" href="https://ranchermanager.docs.rancher.com/v2.5/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://30NEY6C9UY-dsn.algolia.net" crossorigin="anonymous"><link data-rh="true" rel="canonical" href="https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer"><link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-57KS2MW",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>



<link rel="search" type="application/opensearchdescription+xml" title="Rancher" href="/opensearch.xml">



<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="0f98beb0-fc4c-417d-a42e-564e2cae42d2" async></script>
<script src="/scripts/optanonwrapper.js" async></script><link rel="stylesheet" href="/assets/css/styles.cd075367.css">
<link rel="preload" href="/assets/js/runtime~main.a880013c.js" as="script">
<link rel="preload" href="/assets/js/main.da998aa1.js" as="script">
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-57KS2MW" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/rancher-logo-horiz-color.svg" alt="logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/v2.5">v2.5</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer">Latest</a></li><li><a class="dropdown__link" href="/v2.8/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer">v2.8</a></li><li><a class="dropdown__link" href="/v2.7/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer">v2.7</a></li><li><a class="dropdown__link" href="/v2.6/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer">v2.6</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/v2.5/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer">v2.5</a></li><li><a class="dropdown__link" href="/v2.0-v2.4/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer">v2.0-v2.4</a></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/v2.5/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh/v2.5/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">简体中文</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Quick Links</a><ul class="dropdown__menu"><li><a href="https://github.com/rancher/rancher" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/rancher/rancher-docs" target="_blank" rel="noopener noreferrer" class="dropdown__link">Docs GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">More from SUSE</a><ul class="dropdown__menu"><li><a href="https://www.rancher.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rancher">Rancher<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://elemental.docs.rancher.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__elemental">Elemental<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://fleet.rancher.io/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__fleet">Fleet<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://harvesterhci.io" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__harvester">Harvester<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://rancherdesktop.io/" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__rancher__desktop">Rancher Desktop<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://opensource.suse.com" target="_blank" rel="noopener noreferrer" class="dropdown__link navbar__icon navbar__suse">More Projects...<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v2.5">Rancher 2.5</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/getting-started">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/v2.5/how-to-guides">How-to Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;How-to Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.5/how-to-guides/new-user-guides">New User Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;New User Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/kubernetes-cluster-setup">Kubernetes Cluster Setup</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes Cluster Setup&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/infrastructure-setup">Infrastructure Setup</a><button aria-label="Toggle the collapsible sidebar category &#x27;Infrastructure Setup&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/infrastructure-setup/ha-k3s-kubernetes-cluster">Setting up Infrastructure for a High Availability K3s Kubernetes Cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/infrastructure-setup/ha-rke1-kubernetes-cluster">Setting up Infrastructure for a High Availability RKE Kubernetes Cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/infrastructure-setup/ha-rke2-kubernetes-cluster">Setting up Infrastructure for a High Availability RKE2 Kubernetes Cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/infrastructure-setup/nodes-in-amazon-ec2">Setting up Nodes in Amazon EC2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/infrastructure-setup/mysql-database-in-amazon-rds">Setting up a MySQL Database in Amazon RDS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/infrastructure-setup/nginx-load-balancer">Setting up an NGINX Load Balancer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer">Setting up Amazon ELB Network Load Balancer</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup">Kubernetes Clusters in Rancher Setup</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes Clusters in Rancher Setup&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/kubernetes-resources-setup">Kubernetes Resources Setup</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes Resources Setup&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/helm-charts-in-rancher">Helm Charts and Apps</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/deploy-apps-across-clusters">Deploying Apps Across Clusters</a><button aria-label="Toggle the collapsible sidebar category &#x27;Deploying Apps Across Clusters&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/how-to-guides/new-user-guides/backup-restore-and-disaster-recovery">Backup, Restore, and Disaster Recovery</a><button aria-label="Toggle the collapsible sidebar category &#x27;Backup, Restore, and Disaster Recovery&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/v2.5/how-to-guides/advanced-user-guides">Advanced User Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Advanced User Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/reference-guides">Reference Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/explanations">Explanations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Explanations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/faq">FAQ</a><button aria-label="Toggle the collapsible sidebar category &#x27;FAQ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/v2.5/troubleshooting">Troubleshooting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Troubleshooting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/v2.5/contribute-to-rancher">Contributing to Rancher</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Rancher<!-- --> <b>v2.5</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer">latest version</a></b> (<!-- -->Latest<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.5/how-to-guides"><span itemprop="name">How-to Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.5/how-to-guides/new-user-guides"><span itemprop="name">New User Guides</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/v2.5/how-to-guides/new-user-guides/infrastructure-setup"><span itemprop="name">Infrastructure Setup</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Setting up Amazon ELB Network Load Balancer</span><meta itemprop="position" content="4"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v2.5</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Setting up Amazon ELB Network Load Balancer</h1></header><p>This how-to guide describes how to set up a Network Load Balancer (NLB) in Amazon&#x27;s EC2 service that will direct traffic to multiple instances on EC2.</p><p>These examples show the load balancer being configured to direct traffic to three Rancher server nodes. If Rancher is installed on an RKE Kubernetes cluster, three nodes are required. If Rancher is installed on a K3s Kubernetes cluster, only two nodes are required.</p><p>This tutorial is about one possible way to set up your load balancer, not the only way. Other types of load balancers, such as a Classic Load Balancer or Application Load Balancer, could also direct traffic to the Rancher server nodes.</p><p>Rancher only supports using the Amazon NLB when terminating traffic in <code>tcp</code> mode for port 443 rather than <code>tls</code> mode. This is due to the fact that the NLB does not inject the correct headers into requests when terminated at the NLB. This means that if you want to use certificates managed by the Amazon Certificate Manager (ACM), you should use an ALB.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-the-load-balancer">Setting up the Load Balancer<a href="#setting-up-the-load-balancer" class="hash-link" aria-label="Direct link to Setting up the Load Balancer" title="Direct link to Setting up the Load Balancer">​</a></h2><p>Configuring an Amazon NLB is a multistage process:</p><ol><li><a href="#1-create-target-groups">Create Target Groups</a></li><li><a href="#2-register-targets">Register Targets</a></li><li><a href="#3-create-your-nlb">Create Your NLB</a></li><li><a href="#4-add-listener-to-nlb-for-tcp-port-80">Add listener to NLB for TCP port 80</a></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="requirements">Requirements<a href="#requirements" class="hash-link" aria-label="Direct link to Requirements" title="Direct link to Requirements">​</a></h2><p>These instructions assume you have already created Linux instances in EC2. The load balancer will direct traffic to these nodes.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-create-target-groups">1. Create Target Groups<a href="#1-create-target-groups" class="hash-link" aria-label="Direct link to 1. Create Target Groups" title="Direct link to 1. Create Target Groups">​</a></h2><p>Begin by creating two target groups for the <strong>TCP</strong> protocol, one with TCP port 443 and one regarding TCP port 80 (providing redirect to TCP port 443). You&#x27;ll add your Linux nodes to these groups.</p><p>Your first NLB configuration step is to create two target groups. Technically, only port 443 is needed to access Rancher, but it&#x27;s convenient to add a listener for port 80, because traffic to port 80 will be automatically redirected to port 443.</p><p>Regardless of whether an NGINX Ingress or Traefik Ingress controller is used, the Ingress should redirect traffic from port 80 to port 443.</p><ol><li>Log into the <a href="https://console.aws.amazon.com/ec2/" target="_blank" rel="noopener noreferrer">Amazon AWS Console</a> to get started. Make sure to select the <strong>Region</strong> where your EC2 instances (Linux nodes) are created.</li><li>Select <strong>Services</strong> and choose <strong>EC2</strong>, find the section <strong>Load Balancing</strong> and open <strong>Target Groups</strong>.</li><li>Click <strong>Create target group</strong> to create the first target group, regarding TCP port 443.</li></ol><blockquote><p><strong>Note:</strong> Health checks are handled differently based on the Ingress. For details, refer to <a href="#health-check-paths-for-nginx-ingress-and-traefik-ingresses">this section.</a></p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="target-group-tcp-port-443">Target Group (TCP port 443)<a href="#target-group-tcp-port-443" class="hash-link" aria-label="Direct link to Target Group (TCP port 443)" title="Direct link to Target Group (TCP port 443)">​</a></h3><p>Configure the first target group according to the table below.</p><table><thead><tr><th>Option</th><th>Setting</th></tr></thead><tbody><tr><td>Target Group Name</td><td><code>rancher-tcp-443</code></td></tr><tr><td>Target type</td><td><code>instance</code></td></tr><tr><td>Protocol</td><td><code>TCP</code></td></tr><tr><td>Port</td><td><code>443</code></td></tr><tr><td>VPC</td><td>Choose your VPC</td></tr></tbody></table><p>Health check settings:</p><table><thead><tr><th>Option</th><th>Setting</th></tr></thead><tbody><tr><td>Protocol</td><td>TCP</td></tr><tr><td>Port</td><td><code>override</code>,<code>80</code></td></tr><tr><td>Healthy threshold</td><td><code>3</code></td></tr><tr><td>Unhealthy threshold</td><td><code>3</code></td></tr><tr><td>Timeout</td><td><code>6 seconds</code></td></tr><tr><td>Interval</td><td><code>10 seconds</code></td></tr></tbody></table><p>Click <strong>Create target group</strong> to create the second target group, regarding TCP port 80.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="target-group-tcp-port-80">Target Group (TCP port 80)<a href="#target-group-tcp-port-80" class="hash-link" aria-label="Direct link to Target Group (TCP port 80)" title="Direct link to Target Group (TCP port 80)">​</a></h3><p>Configure the second target group according to the table below.</p><table><thead><tr><th>Option</th><th>Setting</th></tr></thead><tbody><tr><td>Target Group Name</td><td><code>rancher-tcp-80</code></td></tr><tr><td>Target type</td><td><code>instance</code></td></tr><tr><td>Protocol</td><td><code>TCP</code></td></tr><tr><td>Port</td><td><code>80</code></td></tr><tr><td>VPC</td><td>Choose your VPC</td></tr></tbody></table><p>Health check settings:</p><table><thead><tr><th>Option</th><th>Setting</th></tr></thead><tbody><tr><td>Protocol</td><td>TCP</td></tr><tr><td>Port</td><td><code>traffic port</code></td></tr><tr><td>Healthy threshold</td><td><code>3</code></td></tr><tr><td>Unhealthy threshold</td><td><code>3</code></td></tr><tr><td>Timeout</td><td><code>6 seconds</code></td></tr><tr><td>Interval</td><td><code>10 seconds</code></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-register-targets">2. Register Targets<a href="#2-register-targets" class="hash-link" aria-label="Direct link to 2. Register Targets" title="Direct link to 2. Register Targets">​</a></h2><p>Next, add your Linux nodes to both target groups.</p><p>Select the target group named <strong>rancher-tcp-443</strong>, click the tab <strong>Targets</strong> and choose <strong>Edit</strong>.</p><p><img loading="lazy" src="/assets/images/edit-targetgroup-443-1143314c2ed28b80d6b1daf6068bf52e.png" width="624" height="736" class="img_ev3q"></p><p>Select the instances (Linux nodes) you want to add, and click <strong>Add to registered</strong>.</p><hr><p><strong>Screenshot Add targets to target group TCP port 443</strong><br></p><p><img loading="lazy" src="/assets/images/add-targets-targetgroup-443-331e2f186b568860b9d8700b7acfc1ea.png" width="1094" height="1136" class="img_ev3q"></p><hr><p><strong>Screenshot Added targets to target group TCP port 443</strong><br></p><p><img loading="lazy" src="/assets/images/added-targets-targetgroup-443-e076e0c70c61c458767ccb7bc17e9361.png" width="1586" height="656" class="img_ev3q"></p><p>When the instances are added, click <strong>Save</strong> on the bottom right of the screen.</p><p>Repeat those steps, replacing <strong>rancher-tcp-443</strong> with <strong>rancher-tcp-80</strong>. The same instances need to be added as targets to this target group.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-create-your-nlb">3. Create Your NLB<a href="#3-create-your-nlb" class="hash-link" aria-label="Direct link to 3. Create Your NLB" title="Direct link to 3. Create Your NLB">​</a></h2><p>Use Amazon&#x27;s Wizard to create a Network Load Balancer. As part of this process, you&#x27;ll add the target groups you created in <a href="#1-create-target-groups">1. Create Target Groups</a>.</p><ol><li><p>From your web browser, navigate to the <a href="https://console.aws.amazon.com/ec2/" target="_blank" rel="noopener noreferrer">Amazon EC2 Console</a>.</p></li><li><p>From the navigation pane, choose <strong>LOAD BALANCING</strong> &gt; <strong>Load Balancers</strong>.</p></li><li><p>Click <strong>Create Load Balancer</strong>.</p></li><li><p>Choose <strong>Network Load Balancer</strong> and click <strong>Create</strong>. Then complete each form.</p></li></ol><ul><li><a href="#step-1-configure-load-balancer">Step 1: Configure Load Balancer</a></li><li><a href="#step-2-configure-routing">Step 2: Configure Routing</a></li><li><a href="#step-3-register-targets">Step 3: Register Targets</a></li><li><a href="#step-4-review">Step 4: Review</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-configure-load-balancer">Step 1: Configure Load Balancer<a href="#step-1-configure-load-balancer" class="hash-link" aria-label="Direct link to Step 1: Configure Load Balancer" title="Direct link to Step 1: Configure Load Balancer">​</a></h3><p>Set the following fields in the form:</p><ul><li><strong>Name:</strong> <code>rancher</code></li><li><strong>Scheme:</strong> <code>internal</code> or <code>internet-facing</code>. The scheme that you choose for your NLB is dependent on the configuration of your instances and VPC. If your instances do not have public IPs associated with them, or you will only be accessing Rancher internally, you should set your NLB Scheme to <code>internal</code> rather than <code>internet-facing</code>.</li><li><strong>Listeners:</strong> The Load Balancer Protocol should be <code>TCP</code> and the corresponding Load Balancer Port should be set to <code>443</code>.</li><li><strong>Availability Zones:</strong> Select Your <strong>VPC</strong> and <strong>Availability Zones</strong>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-configure-routing">Step 2: Configure Routing<a href="#step-2-configure-routing" class="hash-link" aria-label="Direct link to Step 2: Configure Routing" title="Direct link to Step 2: Configure Routing">​</a></h3><ol><li>From the <strong>Target Group</strong> drop-down, choose <strong>Existing target group</strong>.</li><li>From the <strong>Name</strong> drop-down, choose <code>rancher-tcp-443</code>.</li><li>Open <strong>Advanced health check settings</strong>, and configure <strong>Interval</strong> to <code>10 seconds</code>.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-register-targets">Step 3: Register Targets<a href="#step-3-register-targets" class="hash-link" aria-label="Direct link to Step 3: Register Targets" title="Direct link to Step 3: Register Targets">​</a></h3><p>Since you registered your targets earlier, all you have to do is click <strong>Next: Review</strong>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-review">Step 4: Review<a href="#step-4-review" class="hash-link" aria-label="Direct link to Step 4: Review" title="Direct link to Step 4: Review">​</a></h3><p>Look over the load balancer details and click <strong>Create</strong> when you&#x27;re satisfied.</p><p>After AWS creates the NLB, click <strong>Close</strong>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-add-listener-to-nlb-for-tcp-port-80">4. Add listener to NLB for TCP port 80<a href="#4-add-listener-to-nlb-for-tcp-port-80" class="hash-link" aria-label="Direct link to 4. Add listener to NLB for TCP port 80" title="Direct link to 4. Add listener to NLB for TCP port 80">​</a></h2><ol><li><p>Select your newly created NLB and select the <strong>Listeners</strong> tab.</p></li><li><p>Click <strong>Add listener</strong>.</p></li><li><p>Use <code>TCP</code>:<code>80</code> as <strong>Protocol</strong> : <strong>Port</strong></p></li><li><p>Click <strong>Add action</strong> and choose <strong>Forward to...</strong></p></li><li><p>From the <strong>Forward to</strong> drop-down, choose <code>rancher-tcp-80</code>.</p></li><li><p>Click <strong>Save</strong> in the top right of the screen.</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="health-check-paths-for-nginx-ingress-and-traefik-ingresses">Health Check Paths for NGINX Ingress and Traefik Ingresses<a href="#health-check-paths-for-nginx-ingress-and-traefik-ingresses" class="hash-link" aria-label="Direct link to Health Check Paths for NGINX Ingress and Traefik Ingresses" title="Direct link to Health Check Paths for NGINX Ingress and Traefik Ingresses">​</a></h2><p>K3s and RKE Kubernetes clusters handle health checks differently because they use different Ingresses by default.</p><p>For RKE Kubernetes clusters, NGINX Ingress is used by default, whereas for K3s Kubernetes clusters, Traefik is the default Ingress.</p><ul><li><strong>Traefik:</strong> The health check path is <code>/ping</code>. By default <code>/ping</code> is always matched (regardless of Host), and a response from <a href="https://docs.traefik.io/operations/ping/" target="_blank" rel="noopener noreferrer">Traefik itself</a> is always served.</li><li><strong>NGINX Ingress:</strong> The default backend of the NGINX Ingress controller has a <code>/healthz</code> endpoint. By default <code>/healthz</code> is always matched (regardless of Host), and a response from <a href="https://github.com/kubernetes/ingress-nginx/blob/0cbe783f43a9313c9c26136e888324b1ee91a72f/charts/ingress-nginx/values.yaml#L212" target="_blank" rel="noopener noreferrer"><code>ingress-nginx</code> itself</a> is always served.</li></ul><p>To simulate an accurate health check, it is a best practice to use the Host header (Rancher hostname) combined with <code>/ping</code> or <code>/healthz</code> (for K3s or for RKE clusters, respectively) wherever possible, to get a response from the Rancher Pods, not the Ingress.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/rancher/rancher-docs/edit/main/versioned_docs/version-2.5/how-to-guides/new-user-guides/infrastructure-setup/amazon-elb-load-balancer.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-06-30T22:03:43.000Z">Jun 30, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/v2.5/how-to-guides/new-user-guides/infrastructure-setup/nginx-load-balancer"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Setting up an NGINX Load Balancer</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/v2.5/how-to-guides/new-user-guides/kubernetes-clusters-in-rancher-setup"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Setting up Kubernetes Clusters in Rancher</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#setting-up-the-load-balancer" class="table-of-contents__link toc-highlight">Setting up the Load Balancer</a></li><li><a href="#requirements" class="table-of-contents__link toc-highlight">Requirements</a></li><li><a href="#1-create-target-groups" class="table-of-contents__link toc-highlight">1. Create Target Groups</a><ul><li><a href="#target-group-tcp-port-443" class="table-of-contents__link toc-highlight">Target Group (TCP port 443)</a></li><li><a href="#target-group-tcp-port-80" class="table-of-contents__link toc-highlight">Target Group (TCP port 80)</a></li></ul></li><li><a href="#2-register-targets" class="table-of-contents__link toc-highlight">2. Register Targets</a></li><li><a href="#3-create-your-nlb" class="table-of-contents__link toc-highlight">3. Create Your NLB</a><ul><li><a href="#step-1-configure-load-balancer" class="table-of-contents__link toc-highlight">Step 1: Configure Load Balancer</a></li><li><a href="#step-2-configure-routing" class="table-of-contents__link toc-highlight">Step 2: Configure Routing</a></li><li><a href="#step-3-register-targets" class="table-of-contents__link toc-highlight">Step 3: Register Targets</a></li><li><a href="#step-4-review" class="table-of-contents__link toc-highlight">Step 4: Review</a></li></ul></li><li><a href="#4-add-listener-to-nlb-for-tcp-port-80" class="table-of-contents__link toc-highlight">4. Add listener to NLB for TCP port 80</a></li><li><a href="#health-check-paths-for-nginx-ingress-and-traefik-ingresses" class="table-of-contents__link toc-highlight">Health Check Paths for NGINX Ingress and Traefik Ingresses</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 SUSE Rancher. All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a880013c.js"></script>
<script src="/assets/js/main.da998aa1.js"></script>
</body>
</html>